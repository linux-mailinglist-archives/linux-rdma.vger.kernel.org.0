Return-Path: <linux-rdma-owner@vger.kernel.org>
X-Original-To: lists+linux-rdma@lfdr.de
Delivered-To: lists+linux-rdma@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id 498D54CC501
	for <lists+linux-rdma@lfdr.de>; Thu,  3 Mar 2022 19:21:41 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S229727AbiCCSWZ (ORCPT <rfc822;lists+linux-rdma@lfdr.de>);
        Thu, 3 Mar 2022 13:22:25 -0500
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:52480 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S229809AbiCCSWY (ORCPT
        <rfc822;linux-rdma@vger.kernel.org>); Thu, 3 Mar 2022 13:22:24 -0500
Received: from mx0b-001b2d01.pphosted.com (mx0b-001b2d01.pphosted.com [148.163.158.5])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id 2A2A21A39EB
        for <linux-rdma@vger.kernel.org>; Thu,  3 Mar 2022 10:21:36 -0800 (PST)
Received: from pps.filterd (m0098417.ppops.net [127.0.0.1])
        by mx0a-001b2d01.pphosted.com (8.16.1.2/8.16.1.2) with SMTP id 223IBKGJ022183;
        Thu, 3 Mar 2022 18:21:24 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=ibm.com; h=from : to : cc : subject
 : date : message-id : content-type : content-transfer-encoding :
 mime-version; s=pp1; bh=s20POb/1HIeB/gJyJ6cda9jzwLLAyDbdHgjCaAIQ5To=;
 b=CUrFAVwa4MulIGDwPJkxs0MmczYsmV+JP8SxHJkmrA7XowpHHeSKPQ+JT6+I+fk988zB
 mxh9u151ycugNorHp2iI0WNgqv2giURYbSzr8ezunCNioBPuQNEcGChL84ORSYPmVQIj
 vsGTq9E8CdsgYhWGufR5DeSlCiJBccF4JgEny7rUEUI9eQKELTMfykKhG40Cg+P6yNLv
 zDp5wbiyYPKxFKgl3lka0pBsILNeA7ms/UyqahjyMWFL82f38TViQsZg4FIM/um7yg9A
 Jj7NB9DNnTgEHDCcCXdn8amw/Is3rv7CQ59bX8XC1YQDWW+WcjgQS3aq66/goxEjekQO 2w== 
Received: from pps.reinject (localhost [127.0.0.1])
        by mx0a-001b2d01.pphosted.com with ESMTP id 3ek0nm39bf-1
        (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
        Thu, 03 Mar 2022 18:21:23 +0000
Received: from m0098417.ppops.net (m0098417.ppops.net [127.0.0.1])
        by pps.reinject (8.16.0.43/8.16.0.43) with SMTP id 223I6U9i021262;
        Thu, 3 Mar 2022 18:21:22 GMT
Received: from nam11-dm6-obe.outbound.protection.outlook.com (mail-dm6nam11lp2170.outbound.protection.outlook.com [104.47.57.170])
        by mx0a-001b2d01.pphosted.com with ESMTP id 3ek0nm39b1-1
        (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
        Thu, 03 Mar 2022 18:21:22 +0000
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=nAidC73Q2K0Tv25+KeJ2bA3bKkN/ixD8nBlkkdAsAFvpsnefIP0EYscRxcOFSQZA6A/f4EU3zX0HzFf/+B0OI1mDXWpDAVBQ7q6jxsCb+q84reUmBON4jw+Qkw1K3C+aGu9MS3A7oFMaru6+5rLK/RCAv94IgxVaA1x7R66g2E1BBHNSqPIydXT2K/S5Ca5VQ4qqROFeG/WLIhHTS6D9FhJLJPQp88immz0AlyD0oYUjBGCpyOqGbiSKRJX0dWdi7STC+ChxsHb57P+nZAlOJAJb+n1G94iINV0v4a1Gwy8SWYw/Wks6TOKh6rjY5hzmOrRgmDVpq0/GVR3b2CSByA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=s20POb/1HIeB/gJyJ6cda9jzwLLAyDbdHgjCaAIQ5To=;
 b=gc2B0ELSH+v9RDKJpHbvnKFuRmCpUJG/HWX6ot2hVJtmlL8925Dvzx1NoNXedqxOIei0d2AX09E0/B3cdITKhhzf6loH5bRRWiskxelBEXpSZoFenN678PBRKDkS1qpmjMCjKJZ8euW/kLoWXd+3PmP5NtlNFAcz9LOjY+t725uS2S4KR9lDmTbIsNJsuGlXR9QvO1dh3Ef9bFz9LeuVGRAAqCGICuGFj4fifyo2GgqAhDoj/p1HddGiwKIiZr4WSjEN979JqHRyFOnuMGoy78Wekm3+aeCwXl/h2L5eDaFCqI0S2LpT2ikPXoDOpZxYHJiT4VkRdzc6NlSLfG99HA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=zurich.ibm.com; dmarc=pass action=none
 header.from=zurich.ibm.com; dkim=pass header.d=zurich.ibm.com; arc=none
Received: from BYAPR15MB2631.namprd15.prod.outlook.com (2603:10b6:a03:150::19)
 by PH0PR15MB5142.namprd15.prod.outlook.com (2603:10b6:510:12b::9) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.5017.26; Thu, 3 Mar
 2022 18:21:20 +0000
Received: from BYAPR15MB2631.namprd15.prod.outlook.com
 ([fe80::5597:ed30:6ae4:dbcf]) by BYAPR15MB2631.namprd15.prod.outlook.com
 ([fe80::5597:ed30:6ae4:dbcf%3]) with mapi id 15.20.5017.027; Thu, 3 Mar 2022
 18:21:20 +0000
From:   Bernard Metzler <BMT@zurich.ibm.com>
To:     Cheng Xu <chengyou.xc@alibaba-inc.com>,
        "jgg@ziepe.ca" <jgg@ziepe.ca>,
        "dledford@redhat.com" <dledford@redhat.com>
CC:     "leon@kernel.org" <leon@kernel.org>,
        "linux-rdma@vger.kernel.org" <linux-rdma@vger.kernel.org>,
        "KaiShen@linux.alibaba.com" <KaiShen@linux.alibaba.com>,
        "chengyou@linux.alibaba.com" <chengyou@linux.alibaba.com>,
        "tonylu@linux.alibaba.com" <tonylu@linux.alibaba.com>
Subject: RE: [PATCH for-next v3 09/12] RDMA/erdma: Add connection management
 (CM) support
Thread-Topic: [PATCH for-next v3 09/12] RDMA/erdma: Add connection management
 (CM) support
Thread-Index: AdgvK3kXUCIY9rLyTTW4BS9v+Q0QRw==
Date:   Thu, 3 Mar 2022 18:21:20 +0000
Message-ID: <BYAPR15MB26319912BAFA6ACB1539A8FC99049@BYAPR15MB2631.namprd15.prod.outlook.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: d72aa144-d36c-47a5-9a15-08d9fd429da8
x-ms-traffictypediagnostic: PH0PR15MB5142:EE_
x-microsoft-antispam-prvs: <PH0PR15MB5142044AFB5B4A5E853552A699049@PH0PR15MB5142.namprd15.prod.outlook.com>
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: bdL7tFipP2IqdHL2ufJc7FZo3sABLJXZ54qr4q/vOjO6C2IFXxEgdStf+tcX/hFk8Kr33FdjI/nu+qwVOL71ek6VhoZytf41SwXNuoyfgHI45j3trP1xVWUExDkpLUNxBF1vuiNzfJhgFohJUFyMcnfJKd4JqQ4pr2hbJeJAVLn9VJ2kSZy+q6bq0li/ggcj0gcIdhuD02XlDLBQh6zsvM+5il8mmeJ7v2bWKljhylckTFOjzOE5MTi3mD+w3vgPyr+v2f/fYcODDQXqmGi367LJ9Wqx6wL9ZvsNMJ2wsl6h05Dx59iwHmaTQ7Vraju/iZ9teK/Ox6CjhuvNEktpnY9F1+SZsg8hAx3l7khpjwhF6v95hsF2fg79/tiOcbf1qrnN2WY3/rKJ2/SXbleTuu9Bi/kAUVxTMNzN9BOWg00jN8ZHsnzQf32RcxIxyDixJPZkl+otmYYdp8O4ye29ivYc1xxbMy0ak+/HcQIWpDsV+kEX+dp95ljmzMxM16pEQIHUZPX69nhmctb1DcVwPNEAtZQwIdPNdpUqAletm9np/rTULqKwy/E+Qq919umF0z5NKrwiogG1vieCAGlPaPai8zXUCqUDGE7DcXO03W5domZIB/9HjzHq4WmOpHK0QQeueYTE35FLo3HYptCDpGguh0+V2XM2gC0Hh3SS+lOtqDTzrD7eZmRe/mVyh61qmFOw7cP6yC1BsEfhs67Zyw==
x-forefront-antispam-report: CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:BYAPR15MB2631.namprd15.prod.outlook.com;PTR:;CAT:NONE;SFS:(13230001)(366004)(53546011)(52536014)(4326008)(66476007)(76116006)(55016003)(30864003)(8936002)(83380400001)(66556008)(66446008)(64756008)(66946007)(316002)(2906002)(38100700002)(186003)(54906003)(110136005)(86362001)(38070700005)(9686003)(6506007)(7696005)(33656002)(8676002)(122000001)(5660300002)(71200400001)(508600001)(559001)(579004);DIR:OUT;SFP:1101;
x-ms-exchange-antispam-messagedata-chunkcount: 1
x-ms-exchange-antispam-messagedata-0: =?utf-8?B?S1ZlNTQzVlNuUksvamlOMmFUZFB6cDhIN2N4OUtValBkYS9ZMEhobnNrbTI0?=
 =?utf-8?B?ODZUZVNaSjR1eTVhUzk5N3BUdFNmL1BKTTBvM3IvMlpHeUMrS2U1S0wzQm4r?=
 =?utf-8?B?MTA2dHc4YzFhNDRXcDJaeVBWYlcwMDFWdGVKVmRzUEx0Nnp6eWlVSExCNVBL?=
 =?utf-8?B?RFpIaXZJU0hBUHpUOXpRRHYyT2lOTzloODlYQWkxUUQ3aGo3RVdqOFRJdXlv?=
 =?utf-8?B?ZGpRcmx6RGhIV3pHT1JsbFFsc2s2bktrWXdXZzdPNkFNZ0FFRjhZU1JaQ1hM?=
 =?utf-8?B?RWVlVHB2aDEyUnJSaDRxQWc1UE9jYkt5dUE0NDJaOXo1U1N0VllVQzlqTi9F?=
 =?utf-8?B?b3FGa3k3N2x1WjVsZ29rTEoxZ3Rnc3JXWi80TlJXRnZZdXFsUnhIT0FSU3R0?=
 =?utf-8?B?Wm0wTFJsaCthbjRxMHZPdjFQdlVDUURicHpsS1R3VUZZa3BIMTFpdnRHdGJK?=
 =?utf-8?B?eVh1a1oyb0FkZmFxQWNsdEwzYjlSajNLZjA1MDlSTW5kK1FlbzgyNEllU0lI?=
 =?utf-8?B?bVc5Q3BQSjVUWnVNQWVvTU51OUJFSmhCTWtWS0ZaTUpqdDE0UFE1a21CY2Mz?=
 =?utf-8?B?MkZxTXdxMmxFOGhIOVVnVTJnSlZjTFJ5KytnT3QzUWxsUlQxamJkaFZqMVZU?=
 =?utf-8?B?VVdXR0hBaUFROXoxVW5jck41MnE5L2JTd2VoaHV3Y1djSFhaT1d2dHpvbDFh?=
 =?utf-8?B?MGNiRGlJVEhQNGdlS2pqMXY3SjBuNnJqckRoT0NYK1hMVlJNNWVRTGtRb3pY?=
 =?utf-8?B?MVZjWnMrTmNudFh2akFiSFBRNUZFNmFuemdiU0NGVXpBeWkyOUpMb3JPY3NS?=
 =?utf-8?B?anJXUTRNMXNoN3lMWW9EeURUMFJYWXh0NzRtYTEwNjFaTGFqUHpJVlc4N1Q2?=
 =?utf-8?B?TFR6ZXJia2FJVTdYWXVXbFQ4aHBHZkZ1U0prcDI0Z0UxRzJwd3RpdDBudGRK?=
 =?utf-8?B?NStKVHVNeUpMKy9Yd1hmL1p4ZVdSSTlYVXpNcmZHM25EZkRLeisrNjVTVld5?=
 =?utf-8?B?TG16ZDZoTC8vZjB4aUpjeWRxRXRDNkM5eWQ2dkdHdmdYSVFZRitZU1AwTUJK?=
 =?utf-8?B?YTZTNmhrUWtNdkQyaldVdnI4eUdHbVErS3l0R1gwMm5kNGtob3FuTnVqeXRZ?=
 =?utf-8?B?NXErQWdOOHZnQkRiNnBtZndzN3ZJTjN6cDZXbVVBQkpwc2V4THBaSTlaS1V6?=
 =?utf-8?B?bkhzQUtkTWdqaTJzaUlXQ3hHR3dwKzd1Vm5sZWl3bmtVTjFUUDdVcUFEK3FP?=
 =?utf-8?B?WDZvWVdFaHZ3bStNOWNZcW1OMzQrTHpkSVYrWkYwYmc5UUdNdzJ4MUR4M0c3?=
 =?utf-8?B?bXNDZktuby9sUU5xYVJZbHRPVFdEWjdaVk9ycWx3c0NPQjY3dVlwbG90b1Zt?=
 =?utf-8?B?cng2WTlHeWJqenFsRStzc01wb1ptVkYzbmtmS2tWK2xSWm1SZG9sZnl6ZXFk?=
 =?utf-8?B?STY2WnJzTGtTc2ZCWjU3KzB3bTlDSEEybnMwYlFEMWFodU5OUVh4NzZhVjd1?=
 =?utf-8?B?Q1hQVzhDTU96Mjl6RWZEKzJTVUZLWmV3dGhJcmNYT0RFT05VQWFYNVcrT3Rj?=
 =?utf-8?B?ZHY5TVErdzFyQjg2dCtjR1NQQm9EZ2hXdWxEL1g2bDVyOEF5c3krc3Z6QTNi?=
 =?utf-8?B?R1VzQ3RMdVFHYWlBZnVMa29wTlpQUVEwOUZ4VW9tZHZrZjIvSU5tdmd0TW9W?=
 =?utf-8?B?WUtzc1BpMGdqV0w4bE9lblhXa1pKcGZianpMUUtFSktqOU5LZEJzbjF2K1di?=
 =?utf-8?B?RzRtcGlEWE5Ib2lDazFVR3JhOHdycjJEamczRTdCbFpEVVRSdGJZSWNlcUhE?=
 =?utf-8?B?ZmRJbm5LUitJK3ZnMUp2WTJQY2kvMnIzWUFVMXl6RHdOSGQ1aEpldnk2QjZn?=
 =?utf-8?B?N3p6RkNVSlNpL3JjSHRpcUc0K3hBLzF6RVZYc2psblhnQ0ZDeGlVbHhGVGtL?=
 =?utf-8?B?UWRNREN5R2ZDNXJVYXppVE5Tb296ZkhHSXhJWTh2Tkl4cjZPZVFpNGdObzBa?=
 =?utf-8?B?a0RDdDNDU3NraDc2WFlFKzRTa3VVdi9qWVFGZlBtcGRudDlzUWlWZlZheUZP?=
 =?utf-8?B?NlROckpJeCtWaEtERERZV0lkM2lkamluN0pJRmJKclRWK3pTSU9WZ3dxU3ow?=
 =?utf-8?B?SUlLbmZycHQ2aU9xQVB1VlhRYU8xR2phekJteENYMUtSRzNyYmlINnp5S3BY?=
 =?utf-8?Q?UXnZaKP1NGBLcBjkowDgOhktKAhTXN/2/Q5zKGv23Xqc?=
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: Zurich.ibm.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: BYAPR15MB2631.namprd15.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: d72aa144-d36c-47a5-9a15-08d9fd429da8
X-MS-Exchange-CrossTenant-originalarrivaltime: 03 Mar 2022 18:21:20.2970
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: fcf67057-50c9-4ad4-98f3-ffca64add9e9
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: uqztNUQnWB0zqG12c1LrVV4NynHYkIBz0G8WzO+/l3w/ZMSs31/OBZIulQoeqcpMeUQwixFXiJ5bXZ9W2Jtkjw==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: PH0PR15MB5142
X-Proofpoint-ORIG-GUID: pCgBUwL2DpHaCw5iUzMZL80sfTXI-IEM
X-Proofpoint-GUID: hxBIJnq7xN9yJ_Rug7Z-ndxTPBTWTI4y
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.205,Aquarius:18.0.816,Hydra:6.0.425,FMLib:17.11.64.514
 definitions=2022-03-03_07,2022-02-26_01,2022-02-23_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0 lowpriorityscore=0
 phishscore=0 adultscore=0 suspectscore=0 priorityscore=1501 mlxscore=0
 spamscore=0 bulkscore=0 mlxlogscore=999 clxscore=1011 malwarescore=0
 impostorscore=0 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.12.0-2201110000 definitions=main-2203030082
X-Spam-Status: No, score=-2.0 required=5.0 tests=BAYES_00,DKIM_SIGNED,
        DKIM_VALID,DKIM_VALID_EF,RCVD_IN_MSPIKE_H5,RCVD_IN_MSPIKE_WL,
        SPF_HELO_NONE,SPF_PASS,T_SCC_BODY_TEXT_LINE autolearn=ham
        autolearn_force=no version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <linux-rdma.vger.kernel.org>
X-Mailing-List: linux-rdma@vger.kernel.org

PiAtLS0tLU9yaWdpbmFsIE1lc3NhZ2UtLS0tLQ0KPiBGcm9tOiBDaGVuZyBYdSA8Y2hlbmd5b3Uu
eGNAYWxpYmFiYS1pbmMuY29tPg0KPiBTZW50OiBUaHVyc2RheSwgMTcgRmVicnVhcnkgMjAyMiAw
NDowMQ0KPiBUbzogamdnQHppZXBlLmNhOyBkbGVkZm9yZEByZWRoYXQuY29tDQo+IENjOiBsZW9u
QGtlcm5lbC5vcmc7IGxpbnV4LXJkbWFAdmdlci5rZXJuZWwub3JnOw0KPiBLYWlTaGVuQGxpbnV4
LmFsaWJhYmEuY29tOyBjaGVuZ3lvdUBsaW51eC5hbGliYWJhLmNvbTsNCj4gdG9ueWx1QGxpbnV4
LmFsaWJhYmEuY29tDQo+IFN1YmplY3Q6IFtFWFRFUk5BTF0gW1BBVENIIGZvci1uZXh0IHYzIDA5
LzEyXSBSRE1BL2VyZG1hOiBBZGQgY29ubmVjdGlvbg0KPiBtYW5hZ2VtZW50IChDTSkgc3VwcG9y
dA0KPiANCj4gRnJvbTogQ2hlbmcgWHUgPGNoZW5neW91QGxpbnV4LmFsaWJhYmEuY29tPg0KPiAN
Cj4gRVJETUEncyB0cmFuc3BvcnQgcHJvY290b2wgaXMgaVdhcnAsIHNvIHRoZSBkcml2ZXIgbXVz
dCBzdXBwb3J0IENNDQo+IGludGVyZmFjZS4gSW4gQ00gcGFydCwgd2UgdXNlIHRoZSBzYW1lIHdh
eSBhcyBTb2Z0aVdhcnA6IHVzaW5nIGtlcm5lbA0KPiBzb2NrZXQgdG8gc2V0dXAgdGhlIGNvbm5l
Y3Rpb24sIHRoZW4gcGVyZm9ybWluZyBNUEEgbmVnb3RpYXRpb24gaW4ga2VybmVsLg0KPiBTbywg
dGhpcyBwYXJ0IG9mIGNvZGUgbWFpbmx5IGNvbWVzIGZyb20gU29mdGlXYXJwLCBiYXNlIG9uIGl0
LCB3ZSBhZGQgc29tZQ0KPiBtb3JlIGZlYXR1cmVzLCBzdWNoIGFzIG5vbi1ibG9ja2luZyBpd19j
b25uZWN0IGltcGxlbWVudGF0aW9uLg0KPiANCj4gU2lnbmVkLW9mZi1ieTogQ2hlbmcgWHUgPGNo
ZW5neW91QGxpbnV4LmFsaWJhYmEuY29tPg0KPiAtLS0NCj4gIGRyaXZlcnMvaW5maW5pYmFuZC9o
dy9lcmRtYS9lcmRtYV9jbS5jIHwgMTQ0MCArKysrKysrKysrKysrKysrKysrKysrKysNCj4gIGRy
aXZlcnMvaW5maW5pYmFuZC9ody9lcmRtYS9lcmRtYV9jbS5oIHwgIDE2NyArKysNCj4gIDIgZmls
ZXMgY2hhbmdlZCwgMTYwNyBpbnNlcnRpb25zKCspDQo+ICBjcmVhdGUgbW9kZSAxMDA2NDQgZHJp
dmVycy9pbmZpbmliYW5kL2h3L2VyZG1hL2VyZG1hX2NtLmMNCj4gIGNyZWF0ZSBtb2RlIDEwMDY0
NCBkcml2ZXJzL2luZmluaWJhbmQvaHcvZXJkbWEvZXJkbWFfY20uaA0KPiANCj4gZGlmZiAtLWdp
dCBhL2RyaXZlcnMvaW5maW5pYmFuZC9ody9lcmRtYS9lcmRtYV9jbS5jDQo+IGIvZHJpdmVycy9p
bmZpbmliYW5kL2h3L2VyZG1hL2VyZG1hX2NtLmMNCj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQNCj4g
aW5kZXggMDAwMDAwMDAwMDAwLi4yYzYwNzU3ODc4YzANCj4gLS0tIC9kZXYvbnVsbA0KPiArKysg
Yi9kcml2ZXJzL2luZmluaWJhbmQvaHcvZXJkbWEvZXJkbWFfY20uYw0KPiBAQCAtMCwwICsxLDE0
NDAgQEANCj4gKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wIG9yIEJTRC0zLUNs
YXVzZQ0KPiArDQo+ICsvKiBBdXRob3JzOiBDaGVuZyBYdSA8Y2hlbmd5b3VAbGludXguYWxpYmFi
YS5jb20+ICovDQo+ICsvKiAgICAgICAgICBLYWkgU2hlbiA8a2Fpc2hlbkBsaW51eC5hbGliYWJh
LmNvbT4gKi8NCj4gKy8qIENvcHlyaWdodCAoYykgMjAyMC0yMDIyLCBBbGliYWJhIEdyb3VwLiAq
Lw0KPiArDQo+ICsvKiBBdXRob3JzOiBCZXJuYXJkIE1ldHpsZXIgPGJtdEB6dXJpY2guaWJtLmNv
bT4gKi8NCj4gKy8qICAgICAgICAgIEZyZWR5IE5lZXNlciAqLw0KPiArLyogICAgICAgICAgR3Jl
ZyBKb3ljZSA8Z3JlZ0BvcGVuZ3JpZGNvbXB1dGluZy5jb20+ICovDQo+ICsvKiBDb3B5cmlnaHQg
KGMpIDIwMDgtMjAxOSwgSUJNIENvcnBvcmF0aW9uICovDQo+ICsvKiBDb3B5cmlnaHQgKGMpIDIw
MTcsIE9wZW4gR3JpZCBDb21wdXRpbmcsIEluYy4gKi8NCj4gKw0KPiArI2luY2x1ZGUgPGxpbnV4
L2Vycm5vLmg+DQo+ICsjaW5jbHVkZSA8bGludXgvaW5ldGRldmljZS5oPg0KPiArI2luY2x1ZGUg
PGxpbnV4L25ldC5oPg0KPiArI2luY2x1ZGUgPGxpbnV4L2luZXRkZXZpY2UuaD4NCj4gKyNpbmNs
dWRlIDxuZXQvYWRkcmNvbmYuaD4NCj4gKyNpbmNsdWRlIDxsaW51eC90Y3AuaD4NCj4gKyNpbmNs
dWRlIDxsaW51eC90eXBlcy5oPg0KPiArI2luY2x1ZGUgPGxpbnV4L3dvcmtxdWV1ZS5oPg0KPiAr
I2luY2x1ZGUgPG5ldC9zb2NrLmg+DQo+ICsNCj4gKyNpbmNsdWRlIDxyZG1hL2l3X2NtLmg+DQo+
ICsjaW5jbHVkZSA8cmRtYS9pYl9zbWkuaD4NCj4gKyNpbmNsdWRlIDxyZG1hL2liX3VzZXJfdmVy
YnMuaD4NCj4gKyNpbmNsdWRlIDxyZG1hL2liX3ZlcmJzLmg+DQo+ICsNCj4gKyNpbmNsdWRlICJl
cmRtYS5oIg0KPiArI2luY2x1ZGUgImVyZG1hX2NtLmgiDQo+ICsjaW5jbHVkZSAiZXJkbWFfdmVy
YnMuaCINCj4gKw0KPiArc3RhdGljIHN0cnVjdCB3b3JrcXVldWVfc3RydWN0ICplcmRtYV9jbV93
cTsNCj4gKw0KPiArc3RhdGljIHZvaWQgZXJkbWFfY21fbGxwX3N0YXRlX2NoYW5nZShzdHJ1Y3Qg
c29jayAqc2spOw0KPiArc3RhdGljIHZvaWQgZXJkbWFfY21fbGxwX2RhdGFfcmVhZHkoc3RydWN0
IHNvY2sgKnNrKTsNCj4gK3N0YXRpYyB2b2lkIGVyZG1hX2NtX2xscF9lcnJvcl9yZXBvcnQoc3Ry
dWN0IHNvY2sgKnNrKTsNCj4gKw0KPiArc3RhdGljIHZvaWQgZXJkbWFfc2tfYXNzaWduX2NtX3Vw
Y2FsbHMoc3RydWN0IHNvY2sgKnNrKQ0KPiArew0KPiArCXdyaXRlX2xvY2tfYmgoJnNrLT5za19j
YWxsYmFja19sb2NrKTsNCj4gKwlzay0+c2tfc3RhdGVfY2hhbmdlID0gZXJkbWFfY21fbGxwX3N0
YXRlX2NoYW5nZTsNCj4gKwlzay0+c2tfZGF0YV9yZWFkeSA9IGVyZG1hX2NtX2xscF9kYXRhX3Jl
YWR5Ow0KPiArCXNrLT5za19lcnJvcl9yZXBvcnQgPSBlcmRtYV9jbV9sbHBfZXJyb3JfcmVwb3J0
Ow0KPiArCXdyaXRlX3VubG9ja19iaCgmc2stPnNrX2NhbGxiYWNrX2xvY2spOw0KPiArfQ0KPiAr
DQo+ICtzdGF0aWMgdm9pZCBlcmRtYV9za19zYXZlX3VwY2FsbHMoc3RydWN0IHNvY2sgKnNrKQ0K
PiArew0KPiArCXN0cnVjdCBlcmRtYV9jZXAgKmNlcCA9IHNrX3RvX2NlcChzayk7DQo+ICsNCj4g
Kwl3cml0ZV9sb2NrX2JoKCZzay0+c2tfY2FsbGJhY2tfbG9jayk7DQo+ICsJY2VwLT5za19zdGF0
ZV9jaGFuZ2UgPSBzay0+c2tfc3RhdGVfY2hhbmdlOw0KPiArCWNlcC0+c2tfZGF0YV9yZWFkeSA9
IHNrLT5za19kYXRhX3JlYWR5Ow0KPiArCWNlcC0+c2tfZXJyb3JfcmVwb3J0ID0gc2stPnNrX2Vy
cm9yX3JlcG9ydDsNCj4gKwl3cml0ZV91bmxvY2tfYmgoJnNrLT5za19jYWxsYmFja19sb2NrKTsN
Cj4gK30NCj4gKw0KPiArc3RhdGljIHZvaWQgZXJkbWFfc2tfcmVzdG9yZV91cGNhbGxzKHN0cnVj
dCBzb2NrICpzaywgc3RydWN0IGVyZG1hX2NlcA0KPiAqY2VwKQ0KPiArew0KPiArCXNrLT5za19z
dGF0ZV9jaGFuZ2UgPSBjZXAtPnNrX3N0YXRlX2NoYW5nZTsNCj4gKwlzay0+c2tfZGF0YV9yZWFk
eSA9IGNlcC0+c2tfZGF0YV9yZWFkeTsNCj4gKwlzay0+c2tfZXJyb3JfcmVwb3J0ID0gY2VwLT5z
a19lcnJvcl9yZXBvcnQ7DQo+ICsJc2stPnNrX3VzZXJfZGF0YSA9IE5VTEw7DQo+ICt9DQo+ICsN
Cj4gK3N0YXRpYyB2b2lkIGVyZG1hX3NvY2tldF9kaXNhc3NvYyhzdHJ1Y3Qgc29ja2V0ICpzKQ0K
PiArew0KPiArCXN0cnVjdCBzb2NrICpzayA9IHMtPnNrOw0KPiArCXN0cnVjdCBlcmRtYV9jZXAg
KmNlcDsNCj4gKw0KPiArCWlmIChzaykgew0KPiArCQl3cml0ZV9sb2NrX2JoKCZzay0+c2tfY2Fs
bGJhY2tfbG9jayk7DQo+ICsJCWNlcCA9IHNrX3RvX2NlcChzayk7DQo+ICsJCWlmIChjZXApIHsN
Cj4gKwkJCWVyZG1hX3NrX3Jlc3RvcmVfdXBjYWxscyhzaywgY2VwKTsNCj4gKwkJCWVyZG1hX2Nl
cF9wdXQoY2VwKTsNCj4gKwkJfSBlbHNlDQo+ICsJCQlXQVJOX09OX09OQ0UoMSk7DQo+ICsJCXdy
aXRlX3VubG9ja19iaCgmc2stPnNrX2NhbGxiYWNrX2xvY2spOw0KPiArCX0gZWxzZSB7DQo+ICsJ
CVdBUk5fT05fT05DRSgxKTsNCj4gKwl9DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyB2b2lkIGVyZG1h
X2NlcF9zb2NrZXRfYXNzb2Moc3RydWN0IGVyZG1hX2NlcCAqY2VwLCBzdHJ1Y3Qgc29ja2V0DQo+
ICpzKQ0KPiArew0KPiArCWNlcC0+c29jayA9IHM7DQo+ICsJZXJkbWFfY2VwX2dldChjZXApOw0K
PiArCXMtPnNrLT5za191c2VyX2RhdGEgPSBjZXA7DQo+ICsNCj4gKwllcmRtYV9za19zYXZlX3Vw
Y2FsbHMocy0+c2spOw0KPiArCWVyZG1hX3NrX2Fzc2lnbl9jbV91cGNhbGxzKHMtPnNrKTsNCj4g
K30NCj4gKw0KPiArc3RhdGljIHZvaWQgZXJkbWFfZGlzYXNzb2NfbGlzdGVuX2NlcChzdHJ1Y3Qg
ZXJkbWFfY2VwICpjZXApDQo+ICt7DQo+ICsJaWYgKGNlcC0+bGlzdGVuX2NlcCkgew0KPiArCQll
cmRtYV9jZXBfcHV0KGNlcC0+bGlzdGVuX2NlcCk7DQo+ICsJCWNlcC0+bGlzdGVuX2NlcCA9IE5V
TEw7DQo+ICsJfQ0KPiArfQ0KPiArDQo+ICtzdGF0aWMgc3RydWN0IGVyZG1hX2NlcCAqZXJkbWFf
Y2VwX2FsbG9jKHN0cnVjdCBlcmRtYV9kZXYgKmRldikNCj4gK3sNCj4gKwlzdHJ1Y3QgZXJkbWFf
Y2VwICpjZXAgPSBremFsbG9jKHNpemVvZigqY2VwKSwgR0ZQX0tFUk5FTCk7DQo+ICsJdW5zaWdu
ZWQgbG9uZyBmbGFnczsNCj4gKw0KPiArCWlmICghY2VwKQ0KPiArCQlyZXR1cm4gTlVMTDsNCj4g
Kw0KPiArCUlOSVRfTElTVF9IRUFEKCZjZXAtPmxpc3RlbnEpOw0KPiArCUlOSVRfTElTVF9IRUFE
KCZjZXAtPmRldnEpOw0KPiArCUlOSVRfTElTVF9IRUFEKCZjZXAtPndvcmtfZnJlZWxpc3QpOw0K
PiArDQo+ICsJa3JlZl9pbml0KCZjZXAtPnJlZik7DQo+ICsJY2VwLT5zdGF0ZSA9IEVSRE1BX0VQ
U1RBVEVfSURMRTsNCj4gKwlpbml0X3dhaXRxdWV1ZV9oZWFkKCZjZXAtPndhaXRxKTsNCj4gKwlz
cGluX2xvY2tfaW5pdCgmY2VwLT5sb2NrKTsNCj4gKwljZXAtPmRldiA9IGRldjsNCj4gKw0KPiAr
CXNwaW5fbG9ja19pcnFzYXZlKCZkZXYtPmxvY2ssIGZsYWdzKTsNCj4gKwlsaXN0X2FkZF90YWls
KCZjZXAtPmRldnEsICZkZXYtPmNlcF9saXN0KTsNCj4gKwlzcGluX3VubG9ja19pcnFyZXN0b3Jl
KCZkZXYtPmxvY2ssIGZsYWdzKTsNCj4gKw0KPiArCXJldHVybiBjZXA7DQo+ICt9DQo+ICsNCj4g
K3N0YXRpYyB2b2lkIGVyZG1hX2NtX2ZyZWVfd29yayhzdHJ1Y3QgZXJkbWFfY2VwICpjZXApDQo+
ICt7DQo+ICsJc3RydWN0IGxpc3RfaGVhZCAqdywgKnRtcDsNCj4gKwlzdHJ1Y3QgZXJkbWFfY21f
d29yayAqd29yazsNCj4gKw0KPiArCWxpc3RfZm9yX2VhY2hfc2FmZSh3LCB0bXAsICZjZXAtPndv
cmtfZnJlZWxpc3QpIHsNCj4gKwkJd29yayA9IGxpc3RfZW50cnkodywgc3RydWN0IGVyZG1hX2Nt
X3dvcmssIGxpc3QpOw0KPiArCQlsaXN0X2RlbCgmd29yay0+bGlzdCk7DQo+ICsJCWtmcmVlKHdv
cmspOw0KPiArCX0NCj4gK30NCj4gKw0KPiArc3RhdGljIHZvaWQgZXJkbWFfY2FuY2VsX21wYXRp
bWVyKHN0cnVjdCBlcmRtYV9jZXAgKmNlcCkNCj4gK3sNCj4gKwlzcGluX2xvY2tfYmgoJmNlcC0+
bG9jayk7DQo+ICsJaWYgKGNlcC0+bXBhX3RpbWVyKSB7DQo+ICsJCWlmIChjYW5jZWxfZGVsYXll
ZF93b3JrKCZjZXAtPm1wYV90aW1lci0+d29yaykpIHsNCj4gKwkJCWVyZG1hX2NlcF9wdXQoY2Vw
KTsNCj4gKwkJCWtmcmVlKGNlcC0+bXBhX3RpbWVyKTsNCj4gKwkJfQ0KPiArCQljZXAtPm1wYV90
aW1lciA9IE5VTEw7DQo+ICsJfQ0KPiArCXNwaW5fdW5sb2NrX2JoKCZjZXAtPmxvY2spOw0KPiAr
fQ0KPiArDQo+ICtzdGF0aWMgdm9pZCBlcmRtYV9wdXRfd29yayhzdHJ1Y3QgZXJkbWFfY21fd29y
ayAqd29yaykNCj4gK3sNCj4gKwlJTklUX0xJU1RfSEVBRCgmd29yay0+bGlzdCk7DQo+ICsJc3Bp
bl9sb2NrX2JoKCZ3b3JrLT5jZXAtPmxvY2spOw0KPiArCWxpc3RfYWRkKCZ3b3JrLT5saXN0LCAm
d29yay0+Y2VwLT53b3JrX2ZyZWVsaXN0KTsNCj4gKwlzcGluX3VubG9ja19iaCgmd29yay0+Y2Vw
LT5sb2NrKTsNCj4gK30NCj4gKw0KPiArc3RhdGljIHZvaWQgZXJkbWFfY2VwX3NldF9pbnVzZShz
dHJ1Y3QgZXJkbWFfY2VwICpjZXApDQo+ICt7DQo+ICsJdW5zaWduZWQgbG9uZyBmbGFnczsNCj4g
K3JldHJ5Og0KPiArCXNwaW5fbG9ja19pcnFzYXZlKCZjZXAtPmxvY2ssIGZsYWdzKTsNCj4gKw0K
PiArCWlmIChjZXAtPmluX3VzZSkgew0KPiArCQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZjZXAt
PmxvY2ssIGZsYWdzKTsNCj4gKwkJd2FpdF9ldmVudF9pbnRlcnJ1cHRpYmxlKGNlcC0+d2FpdHEs
ICFjZXAtPmluX3VzZSk7DQo+ICsJCWlmIChzaWduYWxfcGVuZGluZyhjdXJyZW50KSkNCj4gKwkJ
CWZsdXNoX3NpZ25hbHMoY3VycmVudCk7DQo+ICsJCWdvdG8gcmV0cnk7DQo+ICsJfSBlbHNlIHsN
Cj4gKwkJY2VwLT5pbl91c2UgPSAxOw0KPiArCQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZjZXAt
PmxvY2ssIGZsYWdzKTsNCj4gKwl9DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyB2b2lkIGVyZG1hX2Nl
cF9zZXRfZnJlZShzdHJ1Y3QgZXJkbWFfY2VwICpjZXApDQo+ICt7DQo+ICsJdW5zaWduZWQgbG9u
ZyBmbGFnczsNCj4gKw0KPiArCXNwaW5fbG9ja19pcnFzYXZlKCZjZXAtPmxvY2ssIGZsYWdzKTsN
Cj4gKwljZXAtPmluX3VzZSA9IDA7DQo+ICsJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmY2VwLT5s
b2NrLCBmbGFncyk7DQo+ICsNCj4gKwl3YWtlX3VwKCZjZXAtPndhaXRxKTsNCj4gK30NCj4gKw0K
PiArc3RhdGljIHZvaWQgX19lcmRtYV9jZXBfZGVhbGxvYyhzdHJ1Y3Qga3JlZiAqcmVmKQ0KPiAr
ew0KPiArCXN0cnVjdCBlcmRtYV9jZXAgKmNlcCA9IGNvbnRhaW5lcl9vZihyZWYsIHN0cnVjdCBl
cmRtYV9jZXAsIHJlZik7DQo+ICsJc3RydWN0IGVyZG1hX2RldiAqZGV2ID0gY2VwLT5kZXY7DQo+
ICsJdW5zaWduZWQgbG9uZyBmbGFnczsNCj4gKw0KPiArCVdBUk5fT04oY2VwLT5saXN0ZW5fY2Vw
KTsNCj4gKw0KPiArCWtmcmVlKGNlcC0+cHJpdmF0ZV9kYXRhKTsNCj4gKwlrZnJlZShjZXAtPm1w
YS5wZGF0YSk7DQo+ICsJc3Bpbl9sb2NrX2JoKCZjZXAtPmxvY2spOw0KPiArCWlmICghbGlzdF9l
bXB0eSgmY2VwLT53b3JrX2ZyZWVsaXN0KSkNCj4gKwkJZXJkbWFfY21fZnJlZV93b3JrKGNlcCk7
DQo+ICsJc3Bpbl91bmxvY2tfYmgoJmNlcC0+bG9jayk7DQo+ICsNCj4gKwlzcGluX2xvY2tfaXJx
c2F2ZSgmZGV2LT5sb2NrLCBmbGFncyk7DQo+ICsJbGlzdF9kZWwoJmNlcC0+ZGV2cSk7DQo+ICsJ
c3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZGV2LT5sb2NrLCBmbGFncyk7DQo+ICsJa2ZyZWUoY2Vw
KTsNCj4gK30NCj4gKw0KPiArc3RhdGljIHN0cnVjdCBlcmRtYV9jbV93b3JrICplcmRtYV9nZXRf
d29yayhzdHJ1Y3QgZXJkbWFfY2VwICpjZXApDQo+ICt7DQo+ICsJc3RydWN0IGVyZG1hX2NtX3dv
cmsgKndvcmsgPSBOVUxMOw0KPiArDQo+ICsJc3Bpbl9sb2NrX2JoKCZjZXAtPmxvY2spOw0KPiAr
CWlmICghbGlzdF9lbXB0eSgmY2VwLT53b3JrX2ZyZWVsaXN0KSkgew0KPiArCQl3b3JrID0gbGlz
dF9lbnRyeShjZXAtPndvcmtfZnJlZWxpc3QubmV4dCwNCj4gKwkJCQkgIHN0cnVjdCBlcmRtYV9j
bV93b3JrLCBsaXN0KTsNCj4gKwkJbGlzdF9kZWxfaW5pdCgmd29yay0+bGlzdCk7DQo+ICsJfQ0K
PiArDQo+ICsJc3Bpbl91bmxvY2tfYmgoJmNlcC0+bG9jayk7DQo+ICsJcmV0dXJuIHdvcms7DQo+
ICt9DQo+ICsNCj4gK3N0YXRpYyBpbnQgZXJkbWFfY21fYWxsb2Nfd29yayhzdHJ1Y3QgZXJkbWFf
Y2VwICpjZXAsIGludCBudW0pDQo+ICt7DQo+ICsJc3RydWN0IGVyZG1hX2NtX3dvcmsgKndvcms7
DQo+ICsNCj4gKwl3aGlsZSAobnVtLS0pIHsNCj4gKwkJd29yayA9IGttYWxsb2Moc2l6ZW9mKCp3
b3JrKSwgR0ZQX0tFUk5FTCk7DQo+ICsJCWlmICghd29yaykgew0KPiArCQkJaWYgKCEobGlzdF9l
bXB0eSgmY2VwLT53b3JrX2ZyZWVsaXN0KSkpDQo+ICsJCQkJZXJkbWFfY21fZnJlZV93b3JrKGNl
cCk7DQo+ICsJCQlyZXR1cm4gLUVOT01FTTsNCj4gKwkJfQ0KPiArCQl3b3JrLT5jZXAgPSBjZXA7
DQo+ICsJCUlOSVRfTElTVF9IRUFEKCZ3b3JrLT5saXN0KTsNCj4gKwkJbGlzdF9hZGQoJndvcmst
Pmxpc3QsICZjZXAtPndvcmtfZnJlZWxpc3QpOw0KPiArCX0NCj4gKw0KPiArCXJldHVybiAwOw0K
PiArfQ0KPiArDQo+ICtzdGF0aWMgaW50IGVyZG1hX2NtX3VwY2FsbChzdHJ1Y3QgZXJkbWFfY2Vw
ICpjZXAsIGVudW0gaXdfY21fZXZlbnRfdHlwZQ0KPiByZWFzb24sDQo+ICsJCQkgICBpbnQgc3Rh
dHVzKQ0KPiArew0KPiArCXN0cnVjdCBpd19jbV9ldmVudCBldmVudDsNCj4gKwlzdHJ1Y3QgaXdf
Y21faWQgKmNtX2lkOw0KPiArDQo+ICsJbWVtc2V0KCZldmVudCwgMCwgc2l6ZW9mKGV2ZW50KSk7
DQo+ICsJZXZlbnQuc3RhdHVzID0gc3RhdHVzOw0KPiArCWV2ZW50LmV2ZW50ID0gcmVhc29uOw0K
PiArDQo+ICsJaWYgKHJlYXNvbiA9PSBJV19DTV9FVkVOVF9DT05ORUNUX1JFUVVFU1QpIHsNCj4g
KwkJZXZlbnQucHJvdmlkZXJfZGF0YSA9IGNlcDsNCj4gKwkJY21faWQgPSBjZXAtPmxpc3Rlbl9j
ZXAtPmNtX2lkOw0KPiArDQo+ICsJCWV2ZW50LmlyZCA9IGNlcC0+ZGV2LT5hdHRycy5tYXhfaXJk
Ow0KPiArCQlldmVudC5vcmQgPSBjZXAtPmRldi0+YXR0cnMubWF4X29yZDsNCj4gKwl9IGVsc2Ug
ew0KPiArCQljbV9pZCA9IGNlcC0+Y21faWQ7DQo+ICsJfQ0KPiArDQo+ICsJaWYgKHJlYXNvbiA9
PSBJV19DTV9FVkVOVF9DT05ORUNUX1JFUVVFU1QgfHwNCj4gKwkgICAgcmVhc29uID09IElXX0NN
X0VWRU5UX0NPTk5FQ1RfUkVQTFkpIHsNCj4gKwkJdTE2IHBkX2xlbiA9IGJlMTZfdG9fY3B1KGNl
cC0+bXBhLmhkci5wYXJhbXMucGRfbGVuKTsNCj4gKw0KPiArCQlpZiAocGRfbGVuKSB7DQo+ICsJ
CQlldmVudC5wcml2YXRlX2RhdGFfbGVuID0gcGRfbGVuOw0KPiArCQkJZXZlbnQucHJpdmF0ZV9k
YXRhID0gY2VwLT5tcGEucGRhdGE7DQo+ICsJCQlpZiAoY2VwLT5tcGEucGRhdGEgPT0gTlVMTCkN
Cj4gKwkJCQlldmVudC5wcml2YXRlX2RhdGFfbGVuID0gMDsNCj4gKwkJfQ0KPiArDQo+ICsJCWdl
dG5hbWVfbG9jYWwoY2VwLT5zb2NrLCAmZXZlbnQubG9jYWxfYWRkcik7DQo+ICsJCWdldG5hbWVf
cGVlcihjZXAtPnNvY2ssICZldmVudC5yZW1vdGVfYWRkcik7DQo+ICsJfQ0KPiArDQo+ICsJcmV0
dXJuIGNtX2lkLT5ldmVudF9oYW5kbGVyKGNtX2lkLCAmZXZlbnQpOw0KPiArfQ0KPiArDQo+ICt2
b2lkIGVyZG1hX3FwX2NtX2Ryb3Aoc3RydWN0IGVyZG1hX3FwICpxcCkNCj4gK3sNCj4gKwlzdHJ1
Y3QgZXJkbWFfY2VwICpjZXAgPSBxcC0+Y2VwOw0KPiArDQo+ICsJaWYgKCFxcC0+Y2VwKQ0KPiAr
CQlyZXR1cm47DQo+ICsNCj4gKwllcmRtYV9jZXBfc2V0X2ludXNlKGNlcCk7DQo+ICsNCj4gKwkv
KiBhbHJlYWR5IGNsb3NlZC4gKi8NCj4gKwlpZiAoY2VwLT5zdGF0ZSA9PSBFUkRNQV9FUFNUQVRF
X0NMT1NFRCkNCj4gKwkJZ290byBvdXQ7DQo+ICsNCj4gKwlpZiAoY2VwLT5jbV9pZCkgew0KPiAr
CQlzd2l0Y2ggKGNlcC0+c3RhdGUpIHsNCj4gKwkJY2FzZSBFUkRNQV9FUFNUQVRFX0FXQUlUX01Q
QVJFUDoNCj4gKwkJCWVyZG1hX2NtX3VwY2FsbChjZXAsIElXX0NNX0VWRU5UX0NPTk5FQ1RfUkVQ
TFksDQo+ICsJCQkJCS1FSU5WQUwpOw0KPiArCQkJYnJlYWs7DQo+ICsNCj4gKwkJY2FzZSBFUkRN
QV9FUFNUQVRFX1JETUFfTU9ERToNCj4gKwkJCWVyZG1hX2NtX3VwY2FsbChjZXAsIElXX0NNX0VW
RU5UX0NMT1NFLCAwKTsNCj4gKwkJCWJyZWFrOw0KPiArDQo+ICsJCWNhc2UgRVJETUFfRVBTVEFU
RV9JRExFOg0KPiArCQljYXNlIEVSRE1BX0VQU1RBVEVfTElTVEVOSU5HOg0KPiArCQljYXNlIEVS
RE1BX0VQU1RBVEVfQ09OTkVDVElORzoNCj4gKwkJY2FzZSBFUkRNQV9FUFNUQVRFX0FXQUlUX01Q
QVJFUToNCj4gKwkJY2FzZSBFUkRNQV9FUFNUQVRFX1JFQ1ZEX01QQVJFUToNCj4gKwkJY2FzZSBF
UkRNQV9FUFNUQVRFX0NMT1NFRDoNCj4gKwkJZGVmYXVsdDoNCj4gKwkJCWJyZWFrOw0KPiArCQl9
DQo+ICsJCWNlcC0+Y21faWQtPnJlbV9yZWYoY2VwLT5jbV9pZCk7DQo+ICsJCWNlcC0+Y21faWQg
PSBOVUxMOw0KPiArCQllcmRtYV9jZXBfcHV0KGNlcCk7DQo+ICsJfQ0KPiArCWNlcC0+c3RhdGUg
PSBFUkRNQV9FUFNUQVRFX0NMT1NFRDsNCj4gKw0KPiArCWlmIChjZXAtPnNvY2spIHsNCj4gKwkJ
ZXJkbWFfc29ja2V0X2Rpc2Fzc29jKGNlcC0+c29jayk7DQo+ICsJCXNvY2tfcmVsZWFzZShjZXAt
PnNvY2spOw0KPiArCQljZXAtPnNvY2sgPSBOVUxMOw0KPiArCX0NCj4gKw0KPiArCWlmIChjZXAt
PnFwKSB7DQo+ICsJCWNlcC0+cXAgPSBOVUxMOw0KPiArCQllcmRtYV9xcF9wdXQocXApOw0KPiAr
CX0NCj4gK291dDoNCj4gKwllcmRtYV9jZXBfc2V0X2ZyZWUoY2VwKTsNCj4gK30NCj4gKw0KPiAr
dm9pZCBlcmRtYV9jZXBfcHV0KHN0cnVjdCBlcmRtYV9jZXAgKmNlcCkNCj4gK3sNCj4gKwlXQVJO
X09OKGtyZWZfcmVhZCgmY2VwLT5yZWYpIDwgMSk7DQo+ICsJa3JlZl9wdXQoJmNlcC0+cmVmLCBf
X2VyZG1hX2NlcF9kZWFsbG9jKTsNCj4gK30NCj4gKw0KPiArdm9pZCBlcmRtYV9jZXBfZ2V0KHN0
cnVjdCBlcmRtYV9jZXAgKmNlcCkNCj4gK3sNCj4gKwlrcmVmX2dldCgmY2VwLT5yZWYpOw0KPiAr
fQ0KPiArDQo+ICtzdGF0aWMgaW50IGVyZG1hX3NlbmRfbXBhcmVxcmVwKHN0cnVjdCBlcmRtYV9j
ZXAgKmNlcCwgY29uc3Qgdm9pZCAqcGRhdGEsDQo+ICsJCQkJdTggcGRfbGVuKQ0KPiArew0KPiAr
CXN0cnVjdCBzb2NrZXQgKnMgPSBjZXAtPnNvY2s7DQo+ICsJc3RydWN0IG1wYV9yciAqcnIgPSAm
Y2VwLT5tcGEuaGRyOw0KPiArCXN0cnVjdCBrdmVjIGlvdlszXTsNCj4gKwlzdHJ1Y3QgbXNnaGRy
IG1zZzsNCj4gKwlpbnQgaW92ZWNfbnVtID0gMDsNCj4gKwlpbnQgcmV0Ow0KPiArCWludCBtcGFf
bGVuOw0KPiArDQo+ICsJbWVtc2V0KCZtc2csIDAsIHNpemVvZihtc2cpKTsNCj4gKw0KPiArCXJy
LT5wYXJhbXMucGRfbGVuID0gY3B1X3RvX2JlMTYocGRfbGVuKTsNCj4gKw0KPiArCWlvdltpb3Zl
Y19udW1dLmlvdl9iYXNlID0gcnI7DQo+ICsJaW92W2lvdmVjX251bV0uaW92X2xlbiA9IHNpemVv
ZigqcnIpOw0KPiArCWlvdmVjX251bSsrOw0KPiArCW1wYV9sZW4gPSBzaXplb2YoKnJyKTsNCj4g
Kw0KPiArCWlvdltpb3ZlY19udW1dLmlvdl9iYXNlID0gJmNlcC0+bXBhLmV4dF9kYXRhOw0KPiAr
CWlvdltpb3ZlY19udW1dLmlvdl9sZW4gPSBzaXplb2YoY2VwLT5tcGEuZXh0X2RhdGEpOw0KPiAr
CWlvdmVjX251bSsrOw0KPiArCW1wYV9sZW4gKz0gc2l6ZW9mKGNlcC0+bXBhLmV4dF9kYXRhKTsN
Cj4gKw0KPiArCWlmIChwZF9sZW4pIHsNCj4gKwkJaW92W2lvdmVjX251bV0uaW92X2Jhc2UgPSAo
Y2hhciAqKXBkYXRhOw0KPiArCQlpb3ZbaW92ZWNfbnVtXS5pb3ZfbGVuID0gcGRfbGVuOw0KPiAr
CQltcGFfbGVuICs9IHBkX2xlbjsNCj4gKwkJaW92ZWNfbnVtKys7DQo+ICsJfQ0KPiArDQo+ICsJ
cmV0ID0ga2VybmVsX3NlbmRtc2cocywgJm1zZywgaW92LCBpb3ZlY19udW0gKyAxLCBtcGFfbGVu
KTsNCg0KDQpCZWZvcmUga2VybmVsX3NlbmRtc2coKSwgaW92ZWNfbnVtIGFscmVhZHkgcmVmbGVj
dHMgdGhlDQpyaWdodCBudW1iZXIgb2YgaW92IGVsZW1lbnRzLCBzbyBkb24ndCBhZGQgMSBoZXJl
Lg0KDQpEaWQgeW91IGV2ZXIgdGVzdCB3aXRoIHByaXZhdGUgZGF0YT8/IGlvdmVjX251bSArIDEg
d291bGQgYmUNCmF0IDQsIHdoaWNoIHBvaW50cyBiZWhpbmQgaW92W10uIE1heWJlIHRoZSBjb3Jy
ZWN0IG1wYV9sZW4NCnBhcmFtZXRlciBzYXZlZCB5b3UuDQoNCj4gKw0KPiArCXJldHVybiByZXQg
PCAwID8gcmV0IDogMDsNCj4gK30NCj4gKw0KPiArc3RhdGljIGlubGluZSBpbnQga3NvY2tfcmVj
dihzdHJ1Y3Qgc29ja2V0ICpzb2NrLCBjaGFyICpidWYsIHNpemVfdCBzaXplLA0KPiArCQkJICAg
ICBpbnQgZmxhZ3MpDQo+ICt7DQo+ICsJc3RydWN0IGt2ZWMgaW92ID0geyBidWYsIHNpemUgfTsN
Cj4gKwlzdHJ1Y3QgbXNnaGRyIG1zZyA9IHsgLm1zZ19uYW1lID0gTlVMTCwgLm1zZ19mbGFncyA9
IGZsYWdzIH07DQo+ICsNCj4gKwlyZXR1cm4ga2VybmVsX3JlY3Ztc2coc29jaywgJm1zZywgJmlv
diwgMSwgc2l6ZSwgZmxhZ3MpOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgaW50IF9fcmVjdl9tcGFf
aGRyKHN0cnVjdCBlcmRtYV9jZXAgKmNlcCwgaW50IGhkcl9yY3ZkLCBjaGFyICpoZHIsDQo+ICsJ
CQkgIGludCBoZHJfc2l6ZSwgaW50ICpyY3ZkX291dCkNCj4gK3sNCj4gKwlzdHJ1Y3Qgc29ja2V0
ICpzID0gY2VwLT5zb2NrOw0KPiArCWludCByY3ZkOw0KPiArDQo+ICsJKnJjdmRfb3V0ID0gMDsN
Cj4gKwlpZiAoaGRyX3JjdmQgPCBoZHJfc2l6ZSkgew0KPiArCQlyY3ZkID0ga3NvY2tfcmVjdihz
LCBoZHIgKyBoZHJfcmN2ZCwgaGRyX3NpemUgLSBoZHJfcmN2ZCwNCj4gKwkJCQkgIE1TR19ET05U
V0FJVCk7DQo+ICsJCWlmIChyY3ZkID09IC1FQUdBSU4pDQo+ICsJCQlyZXR1cm4gLUVBR0FJTjsN
Cj4gKw0KPiArCQlpZiAocmN2ZCA8PSAwKQ0KPiArCQkJcmV0dXJuIC1FQ09OTkFCT1JURUQ7DQo+
ICsNCj4gKwkJaGRyX3JjdmQgKz0gcmN2ZDsNCj4gKwkJKnJjdmRfb3V0ID0gcmN2ZDsNCj4gKw0K
PiArCQlpZiAoaGRyX3JjdmQgPCBoZHJfc2l6ZSkNCj4gKwkJCXJldHVybiAtRUFHQUlOOw0KPiAr
CX0NCj4gKw0KPiArCXJldHVybiAwOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgdm9pZCBfX21wYV9y
cl9zZXRfcmV2aXNpb24odTE2ICpiaXRzLCB1OCByZXYpDQo+ICt7DQo+ICsJKmJpdHMgPSAoKmJp
dHMgJiB+TVBBX1JSX01BU0tfUkVWSVNJT04pIHwNCj4gKwkJKGNwdV90b19iZTE2KHJldikgJiBN
UEFfUlJfTUFTS19SRVZJU0lPTik7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyB1OCBfX21wYV9ycl9y
ZXZpc2lvbih1MTYgbXBhX3JyX2JpdHMpDQo+ICt7DQo+ICsJdTE2IHJldiA9IG1wYV9ycl9iaXRz
ICYgTVBBX1JSX01BU0tfUkVWSVNJT047DQo+ICsNCj4gKwlyZXR1cm4gKHU4KWJlMTZfdG9fY3B1
KHJldik7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyB2b2lkIF9fbXBhX2V4dF9zZXRfY2ModTMyICpi
aXRzLCB1MTYgY2MpDQo+ICt7DQo+ICsJKmJpdHMgfD0gRklFTERfUFJFUChNUEFfRVhUX0RFU0lS
RURfQ0NfTUFTSywgY2MpOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgdTggX19tcGFfZXh0X2NjKF9f
YmUzMiBtcGFfZXh0X2JpdHMpDQo+ICt7DQo+ICsJcmV0dXJuICh1OClGSUVMRF9HRVQoTVBBX0VY
VF9ERVNJUkVEX0NDX01BU0ssDQo+ICsJCQkgICAgIF9fYmUzMl90b19jcHUobXBhX2V4dF9iaXRz
KSk7DQo+ICt9DQo+ICsNCj4gKy8qDQo+ICsgKiBSZWNlaXZlIE1QQSBSZXF1ZXN0L1JlcGx5IGhl
YWRlci4NCj4gKyAqDQo+ICsgKiBSZXR1cm5zIDAgaWYgY29tcGxldGUgTVBBIFJlcXVlc3QvUmVw
bHkgaGFlZGVyIGluY2x1ZGluZw0KPiArICogZXZlbnR1YWwgcHJpdmF0ZSBkYXRhIHdhcyByZWNl
aXZlZC4gUmV0dXJucyAtRUFHQUlOIGlmDQo+ICsgKiBoZWFkZXIgd2FzIHBhcnRpYWxseSByZWNl
aXZlZCBvciBuZWdhdGl2ZSBlcnJvciBjb2RlIG90aGVyd2lzZS4NCj4gKyAqDQo+ICsgKiBDb250
ZXh0OiBNYXkgYmUgY2FsbGVkIGluIHByb2Nlc3MgY29udGV4dCBvbmx5DQo+ICsgKi8NCj4gK3N0
YXRpYyBpbnQgZXJkbWFfcmVjdl9tcGFfcnIoc3RydWN0IGVyZG1hX2NlcCAqY2VwKQ0KPiArew0K
PiArCXN0cnVjdCBtcGFfcnIgKmhkciA9ICZjZXAtPm1wYS5oZHI7DQo+ICsJc3RydWN0IHNvY2tl
dCAqcyA9IGNlcC0+c29jazsNCj4gKwl1MTYgcGRfbGVuOw0KPiArCWludCByY3ZkLCB0b19yY3Ys
IHJldCwgcGRfcmN2ZDsNCj4gKw0KPiArCWlmIChjZXAtPm1wYS5ieXRlc19yY3ZkIDwgc2l6ZW9m
KHN0cnVjdCBtcGFfcnIpKSB7DQo+ICsJCXJldCA9IF9fcmVjdl9tcGFfaGRyKGNlcCwgY2VwLT5t
cGEuYnl0ZXNfcmN2ZCwNCj4gKwkJCQkgICAgIChjaGFyICopJmNlcC0+bXBhLmhkciwNCj4gKwkJ
CQkgICAgIHNpemVvZihzdHJ1Y3QgbXBhX3JyKSwgJnJjdmQpOw0KPiArCQljZXAtPm1wYS5ieXRl
c19yY3ZkICs9IHJjdmQ7DQo+ICsJCWlmIChyZXQpDQo+ICsJCQlyZXR1cm4gcmV0Ow0KPiArCX0N
Cj4gKw0KPiArCWlmIChiZTE2X3RvX2NwdShoZHItPnBhcmFtcy5wZF9sZW4pID4gTVBBX01BWF9Q
UklWREFUQSB8fA0KPiArCSAgICBfX21wYV9ycl9yZXZpc2lvbihoZHItPnBhcmFtcy5iaXRzKSAh
PSBNUEFfUkVWSVNJT05fRVhUXzEpDQo+ICsJCXJldHVybiAtRVBST1RPOw0KPiArDQo+ICsJaWYg
KGNlcC0+bXBhLmJ5dGVzX3JjdmQgLSBzaXplb2Yoc3RydWN0IG1wYV9ycikgPA0KPiArCSAgICBz
aXplb2Yoc3RydWN0IGVyZG1hX21wYV9leHQpKSB7DQo+ICsJCXJldCA9IF9fcmVjdl9tcGFfaGRy
KA0KPiArCQkJY2VwLCBjZXAtPm1wYS5ieXRlc19yY3ZkIC0gc2l6ZW9mKHN0cnVjdCBtcGFfcnIp
LA0KPiArCQkJKGNoYXIgKikmY2VwLT5tcGEuZXh0X2RhdGEsDQo+ICsJCQlzaXplb2Yoc3RydWN0
IGVyZG1hX21wYV9leHQpLCAmcmN2ZCk7DQo+ICsJCWNlcC0+bXBhLmJ5dGVzX3JjdmQgKz0gcmN2
ZDsNCj4gKwkJaWYgKHJldCkNCj4gKwkJCXJldHVybiByZXQ7DQo+ICsJfQ0KPiArDQo+ICsJcGRf
bGVuID0gYmUxNl90b19jcHUoaGRyLT5wYXJhbXMucGRfbGVuKTsNCj4gKwlwZF9yY3ZkID0gY2Vw
LT5tcGEuYnl0ZXNfcmN2ZCAtIHNpemVvZihzdHJ1Y3QgbXBhX3JyKSAtDQo+ICsJCSAgc2l6ZW9m
KHN0cnVjdCBlcmRtYV9tcGFfZXh0KTsNCj4gKwl0b19yY3YgPSBwZF9sZW4gLSBwZF9yY3ZkOw0K
PiArDQo+ICsJaWYgKCF0b19yY3YpIHsNCj4gKwkJLyoNCj4gKwkJICogV2UgaGF2ZSByZWNlaXZl
ZCB0aGUgd2hvbGUgTVBBIFJlcXVlc3QvUmVwbHkgbWVzc2FnZS4NCj4gKwkJICogQ0hlY2sgYWdh
aW5zdCBwZWVyIHByb3RvY29sIHZpb2xhdGlvbi4NCg0KQ0hlY2sgLT4gQ2hlY2sNCg0KPiArCQkg
Ki8NCj4gKwkJdTMyIHdvcmQ7DQo+ICsNCj4gKwkJcmV0ID0gX19yZWN2X21wYV9oZHIoY2VwLCAw
LCAoY2hhciAqKSZ3b3JkLCBzaXplb2Yod29yZCksDQo+ICsJCQkJICAgICAmcmN2ZCk7DQo+ICsJ
CWlmIChyZXQgPT0gLUVBR0FJTiAmJiByY3ZkID09IDApDQo+ICsJCQlyZXR1cm4gMDsNCj4gKw0K
PiArCQlpZiAocmV0KQ0KPiArCQkJcmV0dXJuIHJldDsNCj4gKw0KPiArCQlyZXR1cm4gLUVQUk9U
TzsNCj4gKwl9DQoNCndpdGhvdXQgYSBmZXcgY29tbWVudHMsIHRoaXMgZnVuY3Rpb24gaXMgaGFy
ZCB0byB1bmRlcnN0YW5kLg0KTWF5YmUgYWRkIGEgc3RhdGVtZW50IGhlcmUgdGhhdCBhdCB0aGlz
IHBvaW50IHByaXZhdGUgZGF0YSBhcmUNCnNpZ25hbGVkIGFuZCBhcmUgbm93IGJlaW5nIHJlY2Vp
dmVkLCBvciBjb250aW51ZWQgdG8gYmUgcmVjZWl2ZWQ/DQoNCj4gKw0KPiArCWlmICghY2VwLT5t
cGEucGRhdGEpIHsNCj4gKwkJY2VwLT5tcGEucGRhdGEgPSBrbWFsbG9jKHBkX2xlbiArIDQsIEdG
UF9LRVJORUwpOw0KPiArCQlpZiAoIWNlcC0+bXBhLnBkYXRhKQ0KPiArCQkJcmV0dXJuIC1FTk9N
RU07DQo+ICsJfQ0KPiArDQo+ICsJcmN2ZCA9IGtzb2NrX3JlY3YocywgY2VwLT5tcGEucGRhdGEg
KyBwZF9yY3ZkLCB0b19yY3YgKyA0LA0KPiArCQkJICBNU0dfRE9OVFdBSVQpOw0KPiArCWlmIChy
Y3ZkIDwgMCkNCj4gKwkJcmV0dXJuIHJjdmQ7DQo+ICsNCj4gKwlpZiAocmN2ZCA+IHRvX3JjdikN
Cj4gKwkJcmV0dXJuIC1FUFJPVE87DQo+ICsNCj4gKwljZXAtPm1wYS5ieXRlc19yY3ZkICs9IHJj
dmQ7DQo+ICsNCj4gKwlpZiAodG9fcmN2ID09IHJjdmQpDQo+ICsJCXJldHVybiAwOw0KPiArDQo+
ICsJcmV0dXJuIC1FQUdBSU47DQo+ICt9DQo+ICsNCj4gKy8qDQo+ICsgKiBlcmRtYV9wcm9jX21w
YXJlcSgpDQo+ICsgKg0KPiArICogUmVhZCBNUEEgUmVxdWVzdCBmcm9tIHNvY2tldCBhbmQgc2ln
bmFsIG5ldyBjb25uZWN0aW9uIHRvIElXQ00NCj4gKyAqIGlmIHN1Y2Nlc3MuIENhbGxlciBtdXN0
IGhvbGQgbG9jayBvbiBjb3JyZXNwb25kaW5nIGxpc3RlbmluZyBDRVAuDQo+ICsgKi8NCj4gK3N0
YXRpYyBpbnQgZXJkbWFfcHJvY19tcGFyZXEoc3RydWN0IGVyZG1hX2NlcCAqY2VwKQ0KPiArew0K
PiArCXN0cnVjdCBtcGFfcnIgKnJlcTsNCj4gKwlpbnQgcmV0Ow0KPiArDQo+ICsJcmV0ID0gZXJk
bWFfcmVjdl9tcGFfcnIoY2VwKTsNCj4gKwlpZiAocmV0KQ0KPiArCQlyZXR1cm4gcmV0Ow0KPiAr
DQo+ICsJcmVxID0gJmNlcC0+bXBhLmhkcjsNCj4gKw0KPiArCWlmIChfX21wYV9ycl9yZXZpc2lv
bihyZXEtPnBhcmFtcy5iaXRzKSAhPSBNUEFfUkVWSVNJT05fRVhUXzEpDQoNClRoaXMgaGFzIGFs
cmVhZHkgYmVlbiBjaGVja2VkIGluIGVyZG1hX3JlY3ZfbXBhX3JyKCkNCg0KDQo+ICsJCXJldHVy
biAtRVBST1RPOw0KPiArDQo+ICsJaWYgKG1lbWNtcChyZXEtPmtleSwgTVBBX0tFWV9SRVEsIE1Q
QV9LRVlfU0laRSkpDQo+ICsJCXJldHVybiAtRVBST1RPOw0KPiArDQo+ICsJbWVtY3B5KHJlcS0+
a2V5LCBNUEFfS0VZX1JFUCwgMTYpOw0KPiArDQo+ICsJLyogQ3VycmVudGx5IGRvZXMgbm90IHN1
cHBvcnQgbWFya2VyIGFuZCBjcmMuICovDQo+ICsJaWYgKHJlcS0+cGFyYW1zLmJpdHMgJiBNUEFf
UlJfRkxBR19NQVJLRVJTIHx8DQo+ICsJICAgIHJlcS0+cGFyYW1zLmJpdHMgJiBNUEFfUlJfRkxB
R19DUkMpDQo+ICsJCWdvdG8gcmVqZWN0X2Nvbm47DQo+ICsNCj4gKwljZXAtPnN0YXRlID0gRVJE
TUFfRVBTVEFURV9SRUNWRF9NUEFSRVE7DQo+ICsNCj4gKwkvKiBLZWVwIHJlZmVyZW5jZSB1bnRp
bCBJV0NNIGFjY2VwdHMvcmVqZWN0cyAqLw0KPiArCWVyZG1hX2NlcF9nZXQoY2VwKTsNCj4gKwly
ZXQgPSBlcmRtYV9jbV91cGNhbGwoY2VwLCBJV19DTV9FVkVOVF9DT05ORUNUX1JFUVVFU1QsIDAp
Ow0KPiArCWlmIChyZXQpDQo+ICsJCWVyZG1hX2NlcF9wdXQoY2VwKTsNCj4gKw0KPiArCXJldHVy
biByZXQ7DQo+ICsNCj4gK3JlamVjdF9jb25uOg0KPiArCXJlcS0+cGFyYW1zLmJpdHMgJj0gfk1Q
QV9SUl9GTEFHX01BUktFUlM7DQo+ICsJcmVxLT5wYXJhbXMuYml0cyB8PSBNUEFfUlJfRkxBR19S
RUpFQ1Q7DQo+ICsJcmVxLT5wYXJhbXMuYml0cyAmPSB+TVBBX1JSX0ZMQUdfQ1JDOw0KPiArDQo+
ICsJa2ZyZWUoY2VwLT5tcGEucGRhdGEpOw0KPiArCWNlcC0+bXBhLnBkYXRhID0gTlVMTDsNCj4g
KwllcmRtYV9zZW5kX21wYXJlcXJlcChjZXAsIE5VTEwsIDApOw0KPiArDQo+ICsJcmV0dXJuIC1F
T1BOT1RTVVBQOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgaW50IGVyZG1hX3Byb2NfbXBhcmVwbHko
c3RydWN0IGVyZG1hX2NlcCAqY2VwKQ0KPiArew0KPiArCXN0cnVjdCBlcmRtYV9xcF9hdHRycyBx
cF9hdHRyczsNCj4gKwlzdHJ1Y3QgZXJkbWFfcXAgKnFwID0gY2VwLT5xcDsNCj4gKwlzdHJ1Y3Qg
bXBhX3JyICpyZXA7DQo+ICsJaW50IHJldDsNCj4gKw0KPiArCXJldCA9IGVyZG1hX3JlY3ZfbXBh
X3JyKGNlcCk7DQo+ICsJaWYgKHJldCAhPSAtRUFHQUlOKQ0KPiArCQllcmRtYV9jYW5jZWxfbXBh
dGltZXIoY2VwKTsNCj4gKwlpZiAocmV0KQ0KPiArCQlnb3RvIG91dF9lcnI7DQo+ICsNCj4gKwly
ZXAgPSAmY2VwLT5tcGEuaGRyOw0KPiArDQo+ICsJaWYgKF9fbXBhX3JyX3JldmlzaW9uKHJlcC0+
cGFyYW1zLmJpdHMpICE9IE1QQV9SRVZJU0lPTl9FWFRfMSkgew0KDQpUaGlzIGhhcyBhbHJlYWR5
IGJlZW4gY2hlY2tlZCBpbiBlcmRtYV9yZWN2X21wYV9ycigpDQoNCj4gKwkJcmV0ID0gLUVQUk9U
TzsNCj4gKwkJZ290byBvdXRfZXJyOw0KPiArCX0NCj4gKwlpZiAobWVtY21wKHJlcC0+a2V5LCBN
UEFfS0VZX1JFUCwgTVBBX0tFWV9TSVpFKSkgew0KPiArCQlyZXQgPSAtRVBST1RPOw0KPiArCQln
b3RvIG91dF9lcnI7DQo+ICsJfQ0KPiArCWlmIChyZXAtPnBhcmFtcy5iaXRzICYgTVBBX1JSX0ZM
QUdfUkVKRUNUKSB7DQo+ICsJCWVyZG1hX2NtX3VwY2FsbChjZXAsIElXX0NNX0VWRU5UX0NPTk5F
Q1RfUkVQTFksIC1FQ09OTlJFU0VUKTsNCj4gKwkJcmV0dXJuIC1FQ09OTlJFU0VUOw0KPiArCX0N
Cj4gKw0KPiArCS8qIEN1cnJlbnRseSBkb2VzIG5vdCBzdXBwb3J0IG1hcmtlciBhbmQgY3JjLiAq
Lw0KPiArCWlmICgocmVwLT5wYXJhbXMuYml0cyAmIE1QQV9SUl9GTEFHX01BUktFUlMpIHx8DQo+
ICsJICAgIChyZXAtPnBhcmFtcy5iaXRzICYgTVBBX1JSX0ZMQUdfQ1JDKSkgew0KPiArCQllcmRt
YV9jbV91cGNhbGwoY2VwLCBJV19DTV9FVkVOVF9DT05ORUNUX1JFUExZLCAtDQo+IEVDT05OUkVG
VVNFRCk7DQo+ICsJCXJldHVybiAtRUlOVkFMOw0KPiArCX0NCj4gKw0KPiArCW1lbXNldCgmcXBf
YXR0cnMsIDAsIHNpemVvZihxcF9hdHRycykpOw0KPiArCXFwX2F0dHJzLmlycV9zaXplID0gY2Vw
LT5pcmQ7DQo+ICsJcXBfYXR0cnMub3JxX3NpemUgPSBjZXAtPm9yZDsNCj4gKwlxcF9hdHRycy5z
dGF0ZSA9IEVSRE1BX1FQX1NUQVRFX1JUUzsNCj4gKw0KPiArCWRvd25fd3JpdGUoJnFwLT5zdGF0
ZV9sb2NrKTsNCj4gKwlpZiAocXAtPmF0dHJzLnN0YXRlID4gRVJETUFfUVBfU1RBVEVfUlRSKSB7
DQo+ICsJCXJldCA9IC1FSU5WQUw7DQo+ICsJCXVwX3dyaXRlKCZxcC0+c3RhdGVfbG9jayk7DQo+
ICsJCWdvdG8gb3V0X2VycjsNCj4gKwl9DQo+ICsNCj4gKwlxcC0+cXBfdHlwZSA9IEVSRE1BX1FQ
X0FDVElWRTsNCj4gKwlpZiAoX19tcGFfZXh0X2NjKGNlcC0+bXBhLmV4dF9kYXRhLmJpdHMpICE9
IHFwLT5jY19tZXRob2QpDQo+ICsJCXFwLT5jY19tZXRob2QgPSBDT01QUk9NSVNFX0NDOw0KPiAr
DQo+ICsJcmV0ID0gZXJkbWFfbW9kaWZ5X3FwX2ludGVybmFsKHFwLCAmcXBfYXR0cnMsDQo+ICsJ
CQkJICAgICAgIEVSRE1BX1FQX0FUVFJfU1RBVEUgfA0KPiArCQkJCSAgICAgICBFUkRNQV9RUF9B
VFRSX0xMUF9IQU5ETEUgfA0KPiArCQkJCSAgICAgICBFUkRNQV9RUF9BVFRSX01QQSk7DQo+ICsN
Cj4gKwl1cF93cml0ZSgmcXAtPnN0YXRlX2xvY2spOw0KPiArDQo+ICsJaWYgKCFyZXQpIHsNCj4g
KwkJcmV0ID0gZXJkbWFfY21fdXBjYWxsKGNlcCwgSVdfQ01fRVZFTlRfQ09OTkVDVF9SRVBMWSwg
MCk7DQo+ICsJCWlmICghcmV0KQ0KPiArCQkJY2VwLT5zdGF0ZSA9IEVSRE1BX0VQU1RBVEVfUkRN
QV9NT0RFOw0KPiArDQo+ICsJCXJldHVybiAwOw0KPiArCX0NCj4gKw0KPiArb3V0X2VycjoNCj4g
KwllcmRtYV9jbV91cGNhbGwoY2VwLCBJV19DTV9FVkVOVF9DT05ORUNUX1JFUExZLCAtRUlOVkFM
KTsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+ICtzdGF0aWMgdm9pZCBlcmRtYV9hY2Nl
cHRfbmV3Y29ubihzdHJ1Y3QgZXJkbWFfY2VwICpjZXApDQo+ICt7DQo+ICsJc3RydWN0IHNvY2tl
dCAqcyA9IGNlcC0+c29jazsNCj4gKwlzdHJ1Y3Qgc29ja2V0ICpuZXdfcyA9IE5VTEw7DQo+ICsJ
c3RydWN0IGVyZG1hX2NlcCAqbmV3X2NlcCA9IE5VTEw7DQo+ICsJaW50IHJldCA9IDA7DQo+ICsN
Cj4gKwlpZiAoY2VwLT5zdGF0ZSAhPSBFUkRNQV9FUFNUQVRFX0xJU1RFTklORykNCj4gKwkJZ290
byBlcnJvcjsNCj4gKw0KPiArCW5ld19jZXAgPSBlcmRtYV9jZXBfYWxsb2MoY2VwLT5kZXYpOw0K
PiArCWlmICghbmV3X2NlcCkNCj4gKwkJZ290byBlcnJvcjsNCj4gKw0KPiArCS8qDQo+ICsJICog
NDogQWxsb2NhdGUgYSBzdWZmaWNpZW50IG51bWJlciBvZiB3b3JrIGVsZW1lbnRzDQo+ICsJICog
dG8gYWxsb3cgY29uY3VycmVudCBoYW5kbGluZyBvZiBsb2NhbCArIHBlZXIgY2xvc2UNCj4gKwkg
KiBldmVudHMsIE1QQSBoZWFkZXIgcHJvY2Vzc2luZyArIE1QQSB0aW1lb3V0Lg0KPiArCSAqLw0K
PiArCWlmIChlcmRtYV9jbV9hbGxvY193b3JrKG5ld19jZXAsIDQpICE9IDApDQo+ICsJCWdvdG8g
ZXJyb3I7DQo+ICsNCj4gKwkvKg0KPiArCSAqIENvcHkgc2F2ZWQgc29ja2V0IGNhbGxiYWNrcyBm
cm9tIGxpc3RlbmluZyBDRVANCj4gKwkgKiBhbmQgYXNzaWduIG5ldyBzb2NrZXQgd2l0aCBuZXcg
Q0VQDQo+ICsJICovDQo+ICsJbmV3X2NlcC0+c2tfc3RhdGVfY2hhbmdlID0gY2VwLT5za19zdGF0
ZV9jaGFuZ2U7DQo+ICsJbmV3X2NlcC0+c2tfZGF0YV9yZWFkeSA9IGNlcC0+c2tfZGF0YV9yZWFk
eTsNCj4gKwluZXdfY2VwLT5za19lcnJvcl9yZXBvcnQgPSBjZXAtPnNrX2Vycm9yX3JlcG9ydDsN
Cj4gKw0KPiArCXJldCA9IGtlcm5lbF9hY2NlcHQocywgJm5ld19zLCBPX05PTkJMT0NLKTsNCj4g
KwlpZiAocmV0ICE9IDApDQo+ICsJCWdvdG8gZXJyb3I7DQo+ICsNCj4gKwluZXdfY2VwLT5zb2Nr
ID0gbmV3X3M7DQo+ICsJZXJkbWFfY2VwX2dldChuZXdfY2VwKTsNCj4gKwluZXdfcy0+c2stPnNr
X3VzZXJfZGF0YSA9IG5ld19jZXA7DQo+ICsNCj4gKwl0Y3Bfc29ja19zZXRfbm9kZWxheShuZXdf
cy0+c2spOw0KPiArCW5ld19jZXAtPnN0YXRlID0gRVJETUFfRVBTVEFURV9BV0FJVF9NUEFSRVE7
DQo+ICsNCj4gKwlyZXQgPSBlcmRtYV9jbV9xdWV1ZV93b3JrKG5ld19jZXAsIEVSRE1BX0NNX1dP
UktfTVBBVElNRU9VVCk7DQo+ICsJaWYgKHJldCkNCj4gKwkJZ290byBlcnJvcjsNCj4gKw0KPiAr
CW5ld19jZXAtPmxpc3Rlbl9jZXAgPSBjZXA7DQo+ICsJZXJkbWFfY2VwX2dldChjZXApOw0KPiAr
DQo+ICsJaWYgKGF0b21pY19yZWFkKCZuZXdfcy0+c2stPnNrX3JtZW1fYWxsb2MpKSB7DQo+ICsJ
CS8qIE1QQSBSRVEgYWxyZWFkeSBxdWV1ZWQgKi8NCj4gKwkJZXJkbWFfY2VwX3NldF9pbnVzZShu
ZXdfY2VwKTsNCj4gKwkJcmV0ID0gZXJkbWFfcHJvY19tcGFyZXEobmV3X2NlcCk7DQo+ICsJCWVy
ZG1hX2NlcF9zZXRfZnJlZShuZXdfY2VwKTsNCj4gKw0KPiArCQlpZiAocmV0ICE9IC1FQUdBSU4p
IHsNCj4gKwkJCWVyZG1hX2NlcF9wdXQoY2VwKTsNCj4gKwkJCW5ld19jZXAtPmxpc3Rlbl9jZXAg
PSBOVUxMOw0KPiArCQkJaWYgKHJldCkNCj4gKwkJCQlnb3RvIGVycm9yOw0KPiArCQl9DQo+ICsJ
fQ0KPiArCXJldHVybjsNCj4gKw0KPiArZXJyb3I6DQo+ICsJaWYgKG5ld19jZXApIHsNCj4gKwkJ
bmV3X2NlcC0+c3RhdGUgPSBFUkRNQV9FUFNUQVRFX0NMT1NFRDsNCj4gKwkJZXJkbWFfY2FuY2Vs
X21wYXRpbWVyKG5ld19jZXApOw0KPiArDQo+ICsJCWVyZG1hX2NlcF9wdXQobmV3X2NlcCk7DQo+
ICsJCW5ld19jZXAtPnNvY2sgPSBOVUxMOw0KPiArCX0NCj4gKw0KPiArCWlmIChuZXdfcykgew0K
PiArCQllcmRtYV9zb2NrZXRfZGlzYXNzb2MobmV3X3MpOw0KPiArCQlzb2NrX3JlbGVhc2UobmV3
X3MpOw0KPiArCX0NCj4gK30NCj4gKw0KPiArc3RhdGljIGludCBlcmRtYV9uZXdjb25uX2Nvbm5l
Y3RlZChzdHJ1Y3QgZXJkbWFfY2VwICpjZXApDQo+ICt7DQo+ICsJaW50IHJldCA9IDA7DQo+ICsN
Cj4gKwljZXAtPm1wYS5oZHIucGFyYW1zLmJpdHMgPSAwOw0KPiArCV9fbXBhX3JyX3NldF9yZXZp
c2lvbigmY2VwLT5tcGEuaGRyLnBhcmFtcy5iaXRzLA0KPiBNUEFfUkVWSVNJT05fRVhUXzEpOw0K
PiArDQo+ICsJbWVtY3B5KGNlcC0+bXBhLmhkci5rZXksIE1QQV9LRVlfUkVRLCBNUEFfS0VZX1NJ
WkUpOw0KPiArCWNlcC0+bXBhLmV4dF9kYXRhLmNvb2tpZSA9IFFQX0lEKGNlcC0+cXApOw0KPiAr
CV9fbXBhX2V4dF9zZXRfY2MoJmNlcC0+bXBhLmV4dF9kYXRhLmJpdHMsIGNlcC0+cXAtPmNjX21l
dGhvZCk7DQo+ICsNCj4gKwlyZXQgPSBlcmRtYV9zZW5kX21wYXJlcXJlcChjZXAsIGNlcC0+cHJp
dmF0ZV9kYXRhLCBjZXAtPnBkX2xlbik7DQo+ICsJY2VwLT5zdGF0ZSA9IEVSRE1BX0VQU1RBVEVf
QVdBSVRfTVBBUkVQOw0KPiArCWNlcC0+bXBhLmhkci5wYXJhbXMucGRfbGVuID0gMDsNCj4gKw0K
PiArCWlmIChyZXQgPj0gMCkNCj4gKwkJcmV0ID0gZXJkbWFfY21fcXVldWVfd29yayhjZXAsIEVS
RE1BX0NNX1dPUktfTVBBVElNRU9VVCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiAr
DQo+ICtzdGF0aWMgdm9pZCBlcmRtYV9jbV93b3JrX2hhbmRsZXIoc3RydWN0IHdvcmtfc3RydWN0
ICp3KQ0KPiArew0KPiArCXN0cnVjdCBlcmRtYV9jbV93b3JrICp3b3JrOw0KPiArCXN0cnVjdCBl
cmRtYV9jZXAgKmNlcDsNCj4gKwlpbnQgcmVsZWFzZV9jZXAgPSAwLCByZXQgPSAwOw0KPiArDQo+
ICsJd29yayA9IGNvbnRhaW5lcl9vZih3LCBzdHJ1Y3QgZXJkbWFfY21fd29yaywgd29yay53b3Jr
KTsNCj4gKwljZXAgPSB3b3JrLT5jZXA7DQo+ICsNCj4gKwllcmRtYV9jZXBfc2V0X2ludXNlKGNl
cCk7DQo+ICsNCj4gKwlzd2l0Y2ggKHdvcmstPnR5cGUpIHsNCj4gKwljYXNlIEVSRE1BX0NNX1dP
UktfQ09OTkVDVEVEOg0KPiArCQllcmRtYV9jYW5jZWxfbXBhdGltZXIoY2VwKTsNCj4gKwkJaWYg
KGNlcC0+c3RhdGUgPT0gRVJETUFfRVBTVEFURV9DT05ORUNUSU5HKSB7DQo+ICsJCQlyZXQgPSBl
cmRtYV9uZXdjb25uX2Nvbm5lY3RlZChjZXApOw0KPiArCQkJaWYgKHJldCkgew0KPiArCQkJCWVy
ZG1hX2NtX3VwY2FsbChjZXAsIElXX0NNX0VWRU5UX0NPTk5FQ1RfUkVQTFksDQo+ICsJCQkJCQkt
RUlPKTsNCj4gKwkJCQlyZWxlYXNlX2NlcCA9IDE7DQo+ICsJCQl9DQo+ICsJCX0NCj4gKwkJYnJl
YWs7DQo+ICsJY2FzZSBFUkRNQV9DTV9XT1JLX0NPTk5FQ1RUSU1FT1VUOg0KPiArCQlpZiAoY2Vw
LT5zdGF0ZSA9PSBFUkRNQV9FUFNUQVRFX0NPTk5FQ1RJTkcpIHsNCj4gKwkJCWNlcC0+bXBhX3Rp
bWVyID0gTlVMTDsNCj4gKwkJCWVyZG1hX2NtX3VwY2FsbChjZXAsIElXX0NNX0VWRU5UX0NPTk5F
Q1RfUkVQTFksDQo+ICsJCQkJCS1FVElNRURPVVQpOw0KPiArCQkJcmVsZWFzZV9jZXAgPSAxOw0K
PiArCQl9DQo+ICsJCWJyZWFrOw0KPiArCWNhc2UgRVJETUFfQ01fV09SS19BQ0NFUFQ6DQo+ICsJ
CWVyZG1hX2FjY2VwdF9uZXdjb25uKGNlcCk7DQo+ICsJCWJyZWFrOw0KPiArCWNhc2UgRVJETUFf
Q01fV09SS19SRUFEX01QQUhEUjoNCj4gKwkJaWYgKGNlcC0+c3RhdGUgPT0gRVJETUFfRVBTVEFU
RV9BV0FJVF9NUEFSRVEpIHsNCj4gKwkJCWlmIChjZXAtPmxpc3Rlbl9jZXApIHsNCj4gKwkJCQll
cmRtYV9jZXBfc2V0X2ludXNlKGNlcC0+bGlzdGVuX2NlcCk7DQo+ICsNCj4gKwkJCQlpZiAoY2Vw
LT5saXN0ZW5fY2VwLT5zdGF0ZSA9PQ0KPiArCQkJCSAgICBFUkRNQV9FUFNUQVRFX0xJU1RFTklO
RykNCj4gKwkJCQkJcmV0ID0gZXJkbWFfcHJvY19tcGFyZXEoY2VwKTsNCj4gKwkJCQllbHNlDQo+
ICsJCQkJCXJldCA9IC1FRkFVTFQ7DQo+ICsNCj4gKwkJCQllcmRtYV9jZXBfc2V0X2ZyZWUoY2Vw
LT5saXN0ZW5fY2VwKTsNCj4gKw0KPiArCQkJCWlmIChyZXQgIT0gLUVBR0FJTikgew0KPiArCQkJ
CQllcmRtYV9jZXBfcHV0KGNlcC0+bGlzdGVuX2NlcCk7DQo+ICsJCQkJCWNlcC0+bGlzdGVuX2Nl
cCA9IE5VTEw7DQo+ICsJCQkJCWlmIChyZXQpDQo+ICsJCQkJCQllcmRtYV9jZXBfcHV0KGNlcCk7
DQo+ICsJCQkJfQ0KPiArCQkJfQ0KPiArCQl9IGVsc2UgaWYgKGNlcC0+c3RhdGUgPT0gRVJETUFf
RVBTVEFURV9BV0FJVF9NUEFSRVApIHsNCj4gKwkJCXJldCA9IGVyZG1hX3Byb2NfbXBhcmVwbHko
Y2VwKTsNCj4gKwkJfQ0KPiArDQo+ICsJCWlmIChyZXQgJiYgcmV0ICE9IC1FQUdBSU4pDQo+ICsJ
CQlyZWxlYXNlX2NlcCA9IDE7DQo+ICsJCWJyZWFrOw0KPiArCWNhc2UgRVJETUFfQ01fV09SS19D
TE9TRV9MTFA6DQo+ICsJCWlmIChjZXAtPmNtX2lkKQ0KPiArCQkJZXJkbWFfY21fdXBjYWxsKGNl
cCwgSVdfQ01fRVZFTlRfQ0xPU0UsIDApOw0KPiArCQlyZWxlYXNlX2NlcCA9IDE7DQo+ICsJCWJy
ZWFrOw0KPiArCWNhc2UgRVJETUFfQ01fV09SS19QRUVSX0NMT1NFOg0KPiArCQlpZiAoY2VwLT5j
bV9pZCkgew0KPiArCQkJaWYgKGNlcC0+c3RhdGUgPT0gRVJETUFfRVBTVEFURV9DT05ORUNUSU5H
IHx8DQo+ICsJCQkgICAgY2VwLT5zdGF0ZSA9PSBFUkRNQV9FUFNUQVRFX0FXQUlUX01QQVJFUCkg
ew0KPiArCQkJCS8qDQo+ICsJCQkJICogTVBBIHJlcGx5IG5vdCByZWNlaXZlZCwgYnV0IGNvbm5l
Y3Rpb24gZHJvcA0KPiArCQkJCSAqLw0KPiArCQkJCWVyZG1hX2NtX3VwY2FsbChjZXAsIElXX0NN
X0VWRU5UX0NPTk5FQ1RfUkVQTFksDQo+ICsJCQkJCQktRUNPTk5SRVNFVCk7DQo+ICsJCQl9IGVs
c2UgaWYgKGNlcC0+c3RhdGUgPT0gRVJETUFfRVBTVEFURV9SRE1BX01PREUpIHsNCj4gKwkJCQkv
Kg0KPiArCQkJCSAqIE5PVEU6IElXX0NNX0VWRU5UX0RJU0NPTk5FQ1QgaXMgZ2l2ZW4ganVzdA0K
PiArCQkJCSAqICAgICAgIHRvIHRyYW5zaXRpb24gSVdDTSBpbnRvIENMT1NJTkcuDQo+ICsJCQkJ
ICovDQo+ICsJCQkJZXJkbWFfY21fdXBjYWxsKGNlcCwgSVdfQ01fRVZFTlRfRElTQ09OTkVDVCwg
MCk7DQo+ICsJCQkJZXJkbWFfY21fdXBjYWxsKGNlcCwgSVdfQ01fRVZFTlRfQ0xPU0UsIDApOw0K
PiArCQkJfQ0KPiArCQl9IGVsc2UgaWYgKGNlcC0+c3RhdGUgPT0gRVJETUFfRVBTVEFURV9BV0FJ
VF9NUEFSRVEpIHsNCj4gKwkJCS8qIFNvY2tldCBjbG9zZSBiZWZvcmUgTVBBIHJlcXVlc3QgcmVj
ZWl2ZWQuICovDQo+ICsJCQllcmRtYV9kaXNhc3NvY19saXN0ZW5fY2VwKGNlcCk7DQo+ICsJCQll
cmRtYV9jZXBfcHV0KGNlcCk7DQo+ICsJCX0NCj4gKwkJcmVsZWFzZV9jZXAgPSAxOw0KPiArCQli
cmVhazsNCj4gKwljYXNlIEVSRE1BX0NNX1dPUktfTVBBVElNRU9VVDoNCj4gKwkJY2VwLT5tcGFf
dGltZXIgPSBOVUxMOw0KPiArCQlpZiAoY2VwLT5zdGF0ZSA9PSBFUkRNQV9FUFNUQVRFX0FXQUlU
X01QQVJFUCkgew0KPiArCQkJLyoNCj4gKwkJCSAqIE1QQSByZXF1ZXN0IHRpbWVkIG91dDoNCj4g
KwkJCSAqIEhpZGUgYW55IHBhcnRpYWxseSByZWNlaXZlZCBwcml2YXRlIGRhdGEgYW5kIHNpZ25h
bA0KPiArCQkJICogdGltZW91dA0KPiArCQkJICovDQo+ICsJCQljZXAtPm1wYS5oZHIucGFyYW1z
LnBkX2xlbiA9IDA7DQo+ICsNCj4gKwkJCWlmIChjZXAtPmNtX2lkKQ0KPiArCQkJCWVyZG1hX2Nt
X3VwY2FsbChjZXAsIElXX0NNX0VWRU5UX0NPTk5FQ1RfUkVQTFksDQo+ICsJCQkJCQktRVRJTUVE
T1VUKTsNCj4gKwkJCXJlbGVhc2VfY2VwID0gMTsNCj4gKwkJfSBlbHNlIGlmIChjZXAtPnN0YXRl
ID09IEVSRE1BX0VQU1RBVEVfQVdBSVRfTVBBUkVRKSB7DQo+ICsJCQkvKiBObyBNUEEgcmVxdWVz
dCByZWNlaXZlZCBhZnRlciBwZWVyIFRDUCBzdHJlYW0gc2V0dXAuDQoNCg0KZXhjZWVkcyA4MCBj
aGFycyBwZXIgbGluZQ0KDQo+ICovDQo+ICsJCQllcmRtYV9kaXNhc3NvY19saXN0ZW5fY2VwKGNl
cCk7DQo+ICsNCj4gKwkJCWVyZG1hX2NlcF9wdXQoY2VwKTsNCj4gKwkJCXJlbGVhc2VfY2VwID0g
MTsNCj4gKwkJfQ0KPiArCQlicmVhazsNCj4gKwlkZWZhdWx0Og0KPiArCQlXQVJOKDEsICJVbmRl
ZmluZWQgQ00gd29yayB0eXBlOiAlZFxuIiwgd29yay0+dHlwZSk7DQo+ICsJfQ0KPiArDQo+ICsJ
aWYgKHJlbGVhc2VfY2VwKSB7DQo+ICsJCWVyZG1hX2NhbmNlbF9tcGF0aW1lcihjZXApOw0KPiAr
CQljZXAtPnN0YXRlID0gRVJETUFfRVBTVEFURV9DTE9TRUQ7DQo+ICsJCWlmIChjZXAtPnFwKSB7
DQo+ICsJCQlzdHJ1Y3QgZXJkbWFfcXAgKnFwID0gY2VwLT5xcDsNCj4gKwkJCS8qDQo+ICsJCQkg
KiBTZXJpYWxpemUgYSBwb3RlbnRpYWwgcmFjZSB3aXRoIGFwcGxpY2F0aW9uDQo+ICsJCQkgKiBj
bG9zaW5nIHRoZSBRUCBhbmQgY2FsbGluZyBlcmRtYV9xcF9jbV9kcm9wKCkNCj4gKwkJCSAqLw0K
PiArCQkJZXJkbWFfcXBfZ2V0KHFwKTsNCj4gKwkJCWVyZG1hX2NlcF9zZXRfZnJlZShjZXApOw0K
PiArDQo+ICsJCQllcmRtYV9xcF9sbHBfY2xvc2UocXApOw0KPiArCQkJZXJkbWFfcXBfcHV0KHFw
KTsNCj4gKw0KPiArCQkJZXJkbWFfY2VwX3NldF9pbnVzZShjZXApOw0KPiArCQkJY2VwLT5xcCA9
IE5VTEw7DQo+ICsJCQllcmRtYV9xcF9wdXQocXApOw0KPiArCQl9DQo+ICsJCWlmIChjZXAtPnNv
Y2spIHsNCj4gKwkJCWVyZG1hX3NvY2tldF9kaXNhc3NvYyhjZXAtPnNvY2spOw0KPiArCQkJc29j
a19yZWxlYXNlKGNlcC0+c29jayk7DQo+ICsJCQljZXAtPnNvY2sgPSBOVUxMOw0KPiArCQl9DQo+
ICsNCj4gKwkJaWYgKGNlcC0+Y21faWQpIHsNCj4gKwkJCWNlcC0+Y21faWQtPnJlbV9yZWYoY2Vw
LT5jbV9pZCk7DQo+ICsJCQljZXAtPmNtX2lkID0gTlVMTDsNCj4gKwkJCWlmIChjZXAtPnN0YXRl
ICE9IEVSRE1BX0VQU1RBVEVfTElTVEVOSU5HKQ0KPiArCQkJCWVyZG1hX2NlcF9wdXQoY2VwKTsN
Cj4gKwkJfQ0KPiArCX0NCj4gKwllcmRtYV9jZXBfc2V0X2ZyZWUoY2VwKTsNCj4gKwllcmRtYV9w
dXRfd29yayh3b3JrKTsNCj4gKwllcmRtYV9jZXBfcHV0KGNlcCk7DQo+ICt9DQo+ICsNCj4gK2lu
dCBlcmRtYV9jbV9xdWV1ZV93b3JrKHN0cnVjdCBlcmRtYV9jZXAgKmNlcCwgZW51bSBlcmRtYV93
b3JrX3R5cGUgdHlwZSkNCj4gK3sNCj4gKwlzdHJ1Y3QgZXJkbWFfY21fd29yayAqd29yayA9IGVy
ZG1hX2dldF93b3JrKGNlcCk7DQo+ICsJdW5zaWduZWQgbG9uZyBkZWxheSA9IDA7DQo+ICsNCj4g
KwlpZiAoIXdvcmspDQo+ICsJCXJldHVybiAtRU5PTUVNOw0KPiArDQo+ICsJd29yay0+dHlwZSA9
IHR5cGU7DQo+ICsJd29yay0+Y2VwID0gY2VwOw0KPiArDQo+ICsJZXJkbWFfY2VwX2dldChjZXAp
Ow0KPiArDQo+ICsJSU5JVF9ERUxBWUVEX1dPUksoJndvcmstPndvcmssIGVyZG1hX2NtX3dvcmtf
aGFuZGxlcik7DQo+ICsNCj4gKwlpZiAodHlwZSA9PSBFUkRNQV9DTV9XT1JLX01QQVRJTUVPVVQp
IHsNCj4gKwkJY2VwLT5tcGFfdGltZXIgPSB3b3JrOw0KPiArDQo+ICsJCWlmIChjZXAtPnN0YXRl
ID09IEVSRE1BX0VQU1RBVEVfQVdBSVRfTVBBUkVQKQ0KPiArCQkJZGVsYXkgPSBNUEFSRVBfVElN
RU9VVDsNCj4gKwkJZWxzZQ0KPiArCQkJZGVsYXkgPSBNUEFSRVFfVElNRU9VVDsNCj4gKwl9IGVs
c2UgaWYgKHR5cGUgPT0gRVJETUFfQ01fV09SS19DT05ORUNUVElNRU9VVCkgew0KPiArCQljZXAt
Pm1wYV90aW1lciA9IHdvcms7DQo+ICsNCj4gKwkJZGVsYXkgPSBDT05ORUNUX1RJTUVPVVQ7DQo+
ICsJfQ0KPiArDQo+ICsJcXVldWVfZGVsYXllZF93b3JrKGVyZG1hX2NtX3dxLCAmd29yay0+d29y
aywgZGVsYXkpOw0KPiArDQo+ICsJcmV0dXJuIDA7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyB2b2lk
IGVyZG1hX2NtX2xscF9kYXRhX3JlYWR5KHN0cnVjdCBzb2NrICpzaykNCj4gK3sNCj4gKwlzdHJ1
Y3QgZXJkbWFfY2VwICpjZXA7DQo+ICsNCj4gKwlyZWFkX2xvY2soJnNrLT5za19jYWxsYmFja19s
b2NrKTsNCj4gKw0KPiArCWNlcCA9IHNrX3RvX2NlcChzayk7DQo+ICsJaWYgKCFjZXApDQo+ICsJ
CWdvdG8gb3V0Ow0KPiArDQo+ICsJc3dpdGNoIChjZXAtPnN0YXRlKSB7DQo+ICsJY2FzZSBFUkRN
QV9FUFNUQVRFX1JETUFfTU9ERToNCj4gKwljYXNlIEVSRE1BX0VQU1RBVEVfTElTVEVOSU5HOg0K
PiArCQlicmVhazsNCj4gKwljYXNlIEVSRE1BX0VQU1RBVEVfQVdBSVRfTVBBUkVROg0KPiArCWNh
c2UgRVJETUFfRVBTVEFURV9BV0FJVF9NUEFSRVA6DQo+ICsJCWVyZG1hX2NtX3F1ZXVlX3dvcmso
Y2VwLCBFUkRNQV9DTV9XT1JLX1JFQURfTVBBSERSKTsNCj4gKwkJYnJlYWs7DQo+ICsJZGVmYXVs
dDoNCj4gKwkJYnJlYWs7DQo+ICsJfQ0KPiArb3V0Og0KPiArCXJlYWRfdW5sb2NrKCZzay0+c2tf
Y2FsbGJhY2tfbG9jayk7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyB2b2lkIGVyZG1hX2NtX2xscF9l
cnJvcl9yZXBvcnQoc3RydWN0IHNvY2sgKnNrKQ0KPiArew0KPiArCXN0cnVjdCBlcmRtYV9jZXAg
KmNlcCA9IHNrX3RvX2NlcChzayk7DQo+ICsNCj4gKwlpZiAoY2VwKQ0KPiArCQljZXAtPnNrX2Vy
cm9yX3JlcG9ydChzayk7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyB2b2lkIGVyZG1hX2NtX2xscF9z
dGF0ZV9jaGFuZ2Uoc3RydWN0IHNvY2sgKnNrKQ0KPiArew0KPiArCXN0cnVjdCBlcmRtYV9jZXAg
KmNlcDsNCj4gKwl2b2lkICgqb3JpZ19zdGF0ZV9jaGFuZ2UpKHN0cnVjdCBzb2NrICpzayk7DQo+
ICsNCj4gKwlyZWFkX2xvY2soJnNrLT5za19jYWxsYmFja19sb2NrKTsNCj4gKw0KPiArCWNlcCA9
IHNrX3RvX2NlcChzayk7DQo+ICsJaWYgKCFjZXApIHsNCj4gKwkJcmVhZF91bmxvY2soJnNrLT5z
a19jYWxsYmFja19sb2NrKTsNCj4gKwkJcmV0dXJuOw0KPiArCX0NCj4gKwlvcmlnX3N0YXRlX2No
YW5nZSA9IGNlcC0+c2tfc3RhdGVfY2hhbmdlOw0KPiArDQo+ICsJc3dpdGNoIChzay0+c2tfc3Rh
dGUpIHsNCj4gKwljYXNlIFRDUF9FU1RBQkxJU0hFRDoNCj4gKwkJaWYgKGNlcC0+c3RhdGUgPT0g
RVJETUFfRVBTVEFURV9DT05ORUNUSU5HKQ0KPiArCQkJZXJkbWFfY21fcXVldWVfd29yayhjZXAs
IEVSRE1BX0NNX1dPUktfQ09OTkVDVEVEKTsNCj4gKwkJZWxzZQ0KPiArCQkJZXJkbWFfY21fcXVl
dWVfd29yayhjZXAsIEVSRE1BX0NNX1dPUktfQUNDRVBUKTsNCj4gKwkJYnJlYWs7DQo+ICsJY2Fz
ZSBUQ1BfQ0xPU0U6DQo+ICsJY2FzZSBUQ1BfQ0xPU0VfV0FJVDoNCj4gKwkJaWYgKGNlcC0+c3Rh
dGUgIT0gRVJETUFfRVBTVEFURV9MSVNURU5JTkcpDQo+ICsJCQllcmRtYV9jbV9xdWV1ZV93b3Jr
KGNlcCwgRVJETUFfQ01fV09SS19QRUVSX0NMT1NFKTsNCj4gKwkJYnJlYWs7DQo+ICsJZGVmYXVs
dDoNCj4gKwkJYnJlYWs7DQo+ICsJfQ0KPiArCXJlYWRfdW5sb2NrKCZzay0+c2tfY2FsbGJhY2tf
bG9jayk7DQo+ICsJb3JpZ19zdGF0ZV9jaGFuZ2Uoc2spOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMg
aW50IGtlcm5lbF9iaW5kY29ubmVjdChzdHJ1Y3Qgc29ja2V0ICpzLCBzdHJ1Y3Qgc29ja2FkZHIg
KmxhZGRyLA0KPiArCQkJICAgICAgaW50IGxhZGRybGVuLCBzdHJ1Y3Qgc29ja2FkZHIgKnJhZGRy
LA0KPiArCQkJICAgICAgaW50IHJhZGRybGVuLCBpbnQgZmxhZ3MpDQo+ICt7DQo+ICsJaW50IHJl
dDsNCj4gKw0KPiArCXNvY2tfc2V0X3JldXNlYWRkcihzLT5zayk7DQo+ICsJcmV0ID0gcy0+b3Bz
LT5iaW5kKHMsIGxhZGRyLCBsYWRkcmxlbik7DQo+ICsJaWYgKHJldCkNCj4gKwkJcmV0dXJuIHJl
dDsNCj4gKwlyZXQgPSBzLT5vcHMtPmNvbm5lY3QocywgcmFkZHIsIHJhZGRybGVuLCBmbGFncyk7
DQo+ICsJcmV0dXJuIHJldCA8IDAgPyByZXQgOiAwOw0KPiArfQ0KPiArDQo+ICtpbnQgZXJkbWFf
Y29ubmVjdChzdHJ1Y3QgaXdfY21faWQgKmlkLCBzdHJ1Y3QgaXdfY21fY29ubl9wYXJhbSAqcGFy
YW1zKQ0KPiArew0KPiArCXN0cnVjdCBlcmRtYV9kZXYgKmRldiA9IHRvX2VkZXYoaWQtPmRldmlj
ZSk7DQo+ICsJc3RydWN0IGVyZG1hX3FwICpxcDsNCj4gKwlzdHJ1Y3QgZXJkbWFfY2VwICpjZXAg
PSBOVUxMOw0KPiArCXN0cnVjdCBzb2NrZXQgKnMgPSBOVUxMOw0KPiArCXN0cnVjdCBzb2NrYWRk
ciAqbGFkZHIgPSAoc3RydWN0IHNvY2thZGRyICopJmlkLT5tX2xvY2FsX2FkZHI7DQo+ICsJc3Ry
dWN0IHNvY2thZGRyICpyYWRkciA9IChzdHJ1Y3Qgc29ja2FkZHIgKikmaWQtPm1fcmVtb3RlX2Fk
ZHI7DQo+ICsJdTE2IHBkX2xlbiA9IHBhcmFtcy0+cHJpdmF0ZV9kYXRhX2xlbjsNCj4gKwlpbnQg
cmV0Ow0KPiArDQo+ICsJaWYgKHBkX2xlbiA+IE1QQV9NQVhfUFJJVkRBVEEpDQo+ICsJCXJldHVy
biAtRUlOVkFMOw0KPiArDQo+ICsJaWYgKHBhcmFtcy0+aXJkID4gZGV2LT5hdHRycy5tYXhfaXJk
IHx8DQo+ICsJICAgIHBhcmFtcy0+b3JkID4gZGV2LT5hdHRycy5tYXhfb3JkKQ0KPiArCQlyZXR1
cm4gLUVJTlZBTDsNCj4gKw0KPiArCWlmIChsYWRkci0+c2FfZmFtaWx5ICE9IEFGX0lORVQgfHwg
cmFkZHItPnNhX2ZhbWlseSAhPSBBRl9JTkVUKQ0KPiArCQlyZXR1cm4gLUVBRk5PU1VQUE9SVDsN
Cj4gKw0KPiArCXFwID0gZmluZF9xcF9ieV9xcG4oZGV2LCBwYXJhbXMtPnFwbik7DQo+ICsJaWYg
KCFxcCkNCj4gKwkJcmV0dXJuIC1FTk9FTlQ7DQo+ICsJZXJkbWFfcXBfZ2V0KHFwKTsNCj4gKw0K
PiArCXJldCA9IHNvY2tfY3JlYXRlKEFGX0lORVQsIFNPQ0tfU1RSRUFNLCBJUFBST1RPX1RDUCwg
JnMpOw0KPiArCWlmIChyZXQgPCAwKQ0KPiArCQlnb3RvIGVycm9yX3B1dF9xcDsNCj4gKw0KPiAr
CWNlcCA9IGVyZG1hX2NlcF9hbGxvYyhkZXYpOw0KPiArCWlmICghY2VwKSB7DQo+ICsJCXJldCA9
IC1FTk9NRU07DQo+ICsJCWdvdG8gZXJyb3JfcmVsZWFzZV9zb2NrOw0KPiArCX0NCj4gKw0KPiAr
CWVyZG1hX2NlcF9zZXRfaW51c2UoY2VwKTsNCj4gKw0KPiArCS8qIEFzc29jaWF0ZSBRUCB3aXRo
IENFUCAqLw0KPiArCWVyZG1hX2NlcF9nZXQoY2VwKTsNCj4gKwlxcC0+Y2VwID0gY2VwOw0KPiAr
CWNlcC0+cXAgPSBxcDsNCj4gKw0KPiArCS8qIEFzc29jaWF0ZSBjbV9pZCB3aXRoIENFUCAqLw0K
PiArCWlkLT5hZGRfcmVmKGlkKTsNCj4gKwljZXAtPmNtX2lkID0gaWQ7DQo+ICsNCj4gKwkvKg0K
PiArCSAqIDY6IEFsbG9jYXRlIGEgc3VmZmljaWVudCBudW1iZXIgb2Ygd29yayBlbGVtZW50cw0K
PiArCSAqIHRvIGFsbG93IGNvbmN1cnJlbnQgaGFuZGxpbmcgb2YgbG9jYWwgKyBwZWVyIGNsb3Nl
DQo+ICsJICogZXZlbnRzLCBNUEEgaGVhZGVyIHByb2Nlc3NpbmcgKyBNUEEgdGltZW91dCwgY29u
bmVjdGVkIGV2ZW50DQo+ICsJICogYW5kIGNvbm5lY3QgdGltZW91dC4NCj4gKwkgKi8NCj4gKwly
ZXQgPSBlcmRtYV9jbV9hbGxvY193b3JrKGNlcCwgNik7DQo+ICsJaWYgKHJldCAhPSAwKSB7DQo+
ICsJCXJldCA9IC1FTk9NRU07DQo+ICsJCWdvdG8gZXJyb3JfcmVsZWFzZV9jZXA7DQo+ICsJfQ0K
PiArDQo+ICsJY2VwLT5pcmQgPSBwYXJhbXMtPmlyZDsNCj4gKwljZXAtPm9yZCA9IHBhcmFtcy0+
b3JkOw0KPiArCWNlcC0+c3RhdGUgPSBFUkRNQV9FUFNUQVRFX0NPTk5FQ1RJTkc7DQo+ICsNCj4g
KwllcmRtYV9jZXBfc29ja2V0X2Fzc29jKGNlcCwgcyk7DQo+ICsNCj4gKwlpZiAocGRfbGVuKSB7
DQo+ICsJCWNlcC0+cGRfbGVuID0gcGRfbGVuOw0KPiArCQljZXAtPnByaXZhdGVfZGF0YSA9IGtt
YWxsb2MocGRfbGVuLCBHRlBfS0VSTkVMKTsNCj4gKwkJaWYgKCFjZXAtPnByaXZhdGVfZGF0YSkg
ew0KPiArCQkJcmV0ID0gLUVOT01FTTsNCj4gKwkJCWdvdG8gZXJyb3JfZGlzYXNzb2M7DQo+ICsJ
CX0NCj4gKw0KPiArCQltZW1jcHkoY2VwLT5wcml2YXRlX2RhdGEsIHBhcmFtcy0+cHJpdmF0ZV9k
YXRhLA0KPiArCQkgICAgICAgcGFyYW1zLT5wcml2YXRlX2RhdGFfbGVuKTsNCj4gKwl9DQo+ICsN
Cj4gKwlyZXQgPSBrZXJuZWxfYmluZGNvbm5lY3QocywgbGFkZHIsIHNpemVvZigqbGFkZHIpLCBy
YWRkciwNCj4gKwkJCQkgc2l6ZW9mKCpyYWRkciksIE9fTk9OQkxPQ0spOw0KPiArCWlmIChyZXQg
IT0gLUVJTlBST0dSRVNTICYmIHJldCAhPSAwKSB7DQo+ICsJCWdvdG8gZXJyb3JfZGlzYXNzb2M7
DQo+ICsJfSBlbHNlIGlmIChyZXQgPT0gMCkgew0KPiArCQlyZXQgPSBlcmRtYV9jbV9xdWV1ZV93
b3JrKGNlcCwgRVJETUFfQ01fV09SS19DT05ORUNURUQpOw0KPiArCQlpZiAocmV0KQ0KPiArCQkJ
Z290byBlcnJvcl9kaXNhc3NvYzsNCj4gKwl9IGVsc2Ugew0KPiArCQlyZXQgPSBlcmRtYV9jbV9x
dWV1ZV93b3JrKGNlcCwgRVJETUFfQ01fV09SS19DT05ORUNUVElNRU9VVCk7DQo+ICsJCWlmIChy
ZXQpDQo+ICsJCQlnb3RvIGVycm9yX2Rpc2Fzc29jOw0KPiArCX0NCj4gKw0KPiArCWVyZG1hX2Nl
cF9zZXRfZnJlZShjZXApOw0KPiArCXJldHVybiAwOw0KPiArDQo+ICtlcnJvcl9kaXNhc3NvYzoN
Cj4gKwlrZnJlZShjZXAtPnByaXZhdGVfZGF0YSk7DQo+ICsJY2VwLT5wcml2YXRlX2RhdGEgPSBO
VUxMOw0KPiArCWNlcC0+cGRfbGVuID0gMDsNCj4gKw0KPiArCWVyZG1hX3NvY2tldF9kaXNhc3Nv
YyhzKTsNCj4gKw0KPiArZXJyb3JfcmVsZWFzZV9jZXA6DQo+ICsJLyogZGlzYXNzb2Mgd2l0aCBj
bV9pZCAqLw0KPiArCWNlcC0+Y21faWQgPSBOVUxMOw0KPiArCWlkLT5yZW1fcmVmKGlkKTsNCj4g
Kw0KPiArCS8qIGRpc2Fzc29jIHdpdGggcXAgKi8NCj4gKwlxcC0+Y2VwID0gTlVMTDsNCj4gKwll
cmRtYV9jZXBfcHV0KGNlcCk7DQo+ICsJY2VwLT5xcCA9IE5VTEw7DQo+ICsNCj4gKwljZXAtPnN0
YXRlID0gRVJETUFfRVBTVEFURV9DTE9TRUQ7DQo+ICsNCj4gKwllcmRtYV9jZXBfc2V0X2ZyZWUo
Y2VwKTsNCj4gKw0KPiArCS8qIHJlbGVhc2UgdGhlIGNlcC4gKi8NCj4gKwllcmRtYV9jZXBfcHV0
KGNlcCk7DQo+ICsNCj4gK2Vycm9yX3JlbGVhc2Vfc29jazoNCj4gKwlpZiAocykNCj4gKwkJc29j
a19yZWxlYXNlKHMpOw0KPiArZXJyb3JfcHV0X3FwOg0KPiArCWVyZG1hX3FwX3B1dChxcCk7DQo+
ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+ICtpbnQgZXJkbWFfYWNjZXB0KHN0cnVj
dCBpd19jbV9pZCAqaWQsIHN0cnVjdCBpd19jbV9jb25uX3BhcmFtICpwYXJhbXMpDQo+ICt7DQo+
ICsJc3RydWN0IGVyZG1hX2RldiAqZGV2ID0gdG9fZWRldihpZC0+ZGV2aWNlKTsNCj4gKwlzdHJ1
Y3QgZXJkbWFfY2VwICpjZXAgPSAoc3RydWN0IGVyZG1hX2NlcCAqKWlkLT5wcm92aWRlcl9kYXRh
Ow0KPiArCXN0cnVjdCBlcmRtYV9xcCAqcXA7DQo+ICsJc3RydWN0IGVyZG1hX3FwX2F0dHJzIHFw
X2F0dHJzOw0KPiArCWludCByZXQ7DQo+ICsNCj4gKwllcmRtYV9jZXBfc2V0X2ludXNlKGNlcCk7
DQo+ICsJZXJkbWFfY2VwX3B1dChjZXApOw0KPiArDQo+ICsJLyogRnJlZSBsaW5nZXJpbmcgaW5i
b3VuZCBwcml2YXRlIGRhdGEgKi8NCj4gKwlpZiAoY2VwLT5tcGEuaGRyLnBhcmFtcy5wZF9sZW4p
IHsNCj4gKwkJY2VwLT5tcGEuaGRyLnBhcmFtcy5wZF9sZW4gPSAwOw0KPiArCQlrZnJlZShjZXAt
Pm1wYS5wZGF0YSk7DQo+ICsJCWNlcC0+bXBhLnBkYXRhID0gTlVMTDsNCj4gKwl9DQo+ICsJZXJk
bWFfY2FuY2VsX21wYXRpbWVyKGNlcCk7DQo+ICsNCj4gKwlpZiAoY2VwLT5zdGF0ZSAhPSBFUkRN
QV9FUFNUQVRFX1JFQ1ZEX01QQVJFUSkgew0KPiArCQllcmRtYV9jZXBfc2V0X2ZyZWUoY2VwKTsN
Cj4gKwkJZXJkbWFfY2VwX3B1dChjZXApOw0KPiArDQo+ICsJCXJldHVybiAtRUNPTk5SRVNFVDsN
Cj4gKwl9DQo+ICsNCj4gKwlxcCA9IGZpbmRfcXBfYnlfcXBuKGRldiwgcGFyYW1zLT5xcG4pOw0K
PiArCWlmICghcXApDQo+ICsJCXJldHVybiAtRU5PRU5UOw0KPiArCWVyZG1hX3FwX2dldChxcCk7
DQo+ICsNCj4gKwlkb3duX3dyaXRlKCZxcC0+c3RhdGVfbG9jayk7DQo+ICsJaWYgKHFwLT5hdHRy
cy5zdGF0ZSA+IEVSRE1BX1FQX1NUQVRFX1JUUikgew0KPiArCQlyZXQgPSAtRUlOVkFMOw0KPiAr
CQl1cF93cml0ZSgmcXAtPnN0YXRlX2xvY2spOw0KPiArCQlnb3RvIGVycm9yOw0KPiArCX0NCj4g
Kw0KPiArCWlmIChwYXJhbXMtPm9yZCA+IGRldi0+YXR0cnMubWF4X29yZCB8fA0KPiArCSAgICBw
YXJhbXMtPmlyZCA+IGRldi0+YXR0cnMubWF4X29yZCkgew0KPiArCQlyZXQgPSAtRUlOVkFMOw0K
PiArCQl1cF93cml0ZSgmcXAtPnN0YXRlX2xvY2spOw0KPiArCQlnb3RvIGVycm9yOw0KPiArCX0N
Cj4gKw0KPiArCWlmIChwYXJhbXMtPnByaXZhdGVfZGF0YV9sZW4gPiBNUEFfTUFYX1BSSVZEQVRB
KSB7DQo+ICsJCXJldCA9IC1FSU5WQUw7DQo+ICsJCXVwX3dyaXRlKCZxcC0+c3RhdGVfbG9jayk7
DQo+ICsJCWdvdG8gZXJyb3I7DQo+ICsJfQ0KPiArDQo+ICsJY2VwLT5pcmQgPSBwYXJhbXMtPmly
ZDsNCj4gKwljZXAtPm9yZCA9IHBhcmFtcy0+b3JkOw0KPiArDQo+ICsJY2VwLT5jbV9pZCA9IGlk
Ow0KPiArCWlkLT5hZGRfcmVmKGlkKTsNCj4gKw0KPiArCW1lbXNldCgmcXBfYXR0cnMsIDAsIHNp
emVvZihxcF9hdHRycykpOw0KPiArCXFwX2F0dHJzLm9ycV9zaXplID0gcGFyYW1zLT5vcmQ7DQo+
ICsJcXBfYXR0cnMuaXJxX3NpemUgPSBwYXJhbXMtPmlyZDsNCj4gKw0KPiArCXFwX2F0dHJzLnN0
YXRlID0gRVJETUFfUVBfU1RBVEVfUlRTOw0KPiArDQo+ICsJLyogQXNzb2NpYXRlIFFQIHdpdGgg
Q0VQICovDQo+ICsJZXJkbWFfY2VwX2dldChjZXApOw0KPiArCXFwLT5jZXAgPSBjZXA7DQo+ICsJ
Y2VwLT5xcCA9IHFwOw0KPiArDQo+ICsJY2VwLT5zdGF0ZSA9IEVSRE1BX0VQU1RBVEVfUkRNQV9N
T0RFOw0KPiArDQo+ICsJcXAtPnFwX3R5cGUgPSBFUkRNQV9RUF9QQVNTSVZFOw0KPiArCXFwLT5w
cml2YXRlX2RhdGFfbGVuID0gcGFyYW1zLT5wcml2YXRlX2RhdGFfbGVuOw0KPiArDQo+ICsJaWYg
KHFwLT5jY19tZXRob2QgIT0gX19tcGFfZXh0X2NjKGNlcC0+bXBhLmV4dF9kYXRhLmJpdHMpKQ0K
PiArCQlxcC0+Y2NfbWV0aG9kID0gQ09NUFJPTUlTRV9DQzsNCj4gKw0KPiArCS8qIG1vdmUgdG8g
cnRzICovDQo+ICsJcmV0ID0gZXJkbWFfbW9kaWZ5X3FwX2ludGVybmFsKHFwLCAmcXBfYXR0cnMs
DQo+ICsJCQkJICAgICAgIEVSRE1BX1FQX0FUVFJfU1RBVEUgfA0KPiArCQkJCSAgICAgICBFUkRN
QV9RUF9BVFRSX09SRCB8DQo+ICsJCQkJICAgICAgIEVSRE1BX1FQX0FUVFJfTExQX0hBTkRMRSB8
DQo+ICsJCQkJICAgICAgIEVSRE1BX1FQX0FUVFJfSVJEIHwNCj4gKwkJCQkgICAgICAgRVJETUFf
UVBfQVRUUl9NUEEpOw0KPiArCXVwX3dyaXRlKCZxcC0+c3RhdGVfbG9jayk7DQo+ICsNCj4gKwlp
ZiAocmV0KQ0KPiArCQlnb3RvIGVycm9yOw0KPiArDQo+ICsJY2VwLT5tcGEuZXh0X2RhdGEuYml0
cyA9IDA7DQo+ICsJX19tcGFfZXh0X3NldF9jYygmY2VwLT5tcGEuZXh0X2RhdGEuYml0cywgcXAt
PmNjX21ldGhvZCk7DQo+ICsJY2VwLT5tcGEuZXh0X2RhdGEuY29va2llID0gUVBfSUQocXApOw0K
PiArDQo+ICsJcmV0ID0gZXJkbWFfc2VuZF9tcGFyZXFyZXAoY2VwLCBwYXJhbXMtPnByaXZhdGVf
ZGF0YSwNCj4gKwkJCQkgICBwYXJhbXMtPnByaXZhdGVfZGF0YV9sZW4pOw0KPiArCWlmICghcmV0
KSB7DQo+ICsJCXJldCA9IGVyZG1hX2NtX3VwY2FsbChjZXAsIElXX0NNX0VWRU5UX0VTVEFCTElT
SEVELCAwKTsNCj4gKwkJaWYgKHJldCkNCj4gKwkJCWdvdG8gZXJyb3I7DQo+ICsNCj4gKwkJZXJk
bWFfY2VwX3NldF9mcmVlKGNlcCk7DQo+ICsNCj4gKwkJcmV0dXJuIDA7DQo+ICsJfQ0KPiArDQo+
ICtlcnJvcjoNCj4gKwllcmRtYV9zb2NrZXRfZGlzYXNzb2MoY2VwLT5zb2NrKTsNCj4gKwlzb2Nr
X3JlbGVhc2UoY2VwLT5zb2NrKTsNCj4gKwljZXAtPnNvY2sgPSBOVUxMOw0KPiArDQo+ICsJY2Vw
LT5zdGF0ZSA9IEVSRE1BX0VQU1RBVEVfQ0xPU0VEOw0KPiArDQo+ICsJaWYgKGNlcC0+Y21faWQp
IHsNCj4gKwkJY2VwLT5jbV9pZC0+cmVtX3JlZihpZCk7DQo+ICsJCWNlcC0+Y21faWQgPSBOVUxM
Ow0KPiArCX0NCj4gKwlpZiAocXAtPmNlcCkgew0KPiArCQllcmRtYV9jZXBfcHV0KGNlcCk7DQo+
ICsJCXFwLT5jZXAgPSBOVUxMOw0KPiArCX0NCj4gKw0KPiArCWNlcC0+cXAgPSBOVUxMOw0KPiAr
CWVyZG1hX3FwX3B1dChxcCk7DQo+ICsNCj4gKwllcmRtYV9jZXBfc2V0X2ZyZWUoY2VwKTsNCj4g
KwllcmRtYV9jZXBfcHV0KGNlcCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+
ICtpbnQgZXJkbWFfcmVqZWN0KHN0cnVjdCBpd19jbV9pZCAqaWQsIGNvbnN0IHZvaWQgKnBkYXRh
LCB1OCBwbGVuKQ0KPiArew0KPiArCXN0cnVjdCBlcmRtYV9jZXAgKmNlcCA9IChzdHJ1Y3QgZXJk
bWFfY2VwICopaWQtPnByb3ZpZGVyX2RhdGE7DQo+ICsNCj4gKwllcmRtYV9jZXBfc2V0X2ludXNl
KGNlcCk7DQo+ICsJZXJkbWFfY2VwX3B1dChjZXApOw0KPiArDQo+ICsJZXJkbWFfY2FuY2VsX21w
YXRpbWVyKGNlcCk7DQo+ICsNCj4gKwlpZiAoY2VwLT5zdGF0ZSAhPSBFUkRNQV9FUFNUQVRFX1JF
Q1ZEX01QQVJFUSkgew0KPiArCQllcmRtYV9jZXBfc2V0X2ZyZWUoY2VwKTsNCj4gKwkJZXJkbWFf
Y2VwX3B1dChjZXApOw0KPiArDQo+ICsJCXJldHVybiAtRUNPTk5SRVNFVDsNCj4gKwl9DQo+ICsN
Cj4gKwlpZiAoX19tcGFfcnJfcmV2aXNpb24oY2VwLT5tcGEuaGRyLnBhcmFtcy5iaXRzKSA9PQ0K
PiBNUEFfUkVWSVNJT05fRVhUXzEpIHsNCj4gKwkJY2VwLT5tcGEuaGRyLnBhcmFtcy5iaXRzIHw9
IE1QQV9SUl9GTEFHX1JFSkVDVDsgLyogcmVqZWN0ICovDQo+ICsJCWVyZG1hX3NlbmRfbXBhcmVx
cmVwKGNlcCwgcGRhdGEsIHBsZW4pOw0KPiArCX0NCj4gKw0KPiArCWVyZG1hX3NvY2tldF9kaXNh
c3NvYyhjZXAtPnNvY2spOw0KPiArCXNvY2tfcmVsZWFzZShjZXAtPnNvY2spOw0KPiArCWNlcC0+
c29jayA9IE5VTEw7DQo+ICsNCj4gKwljZXAtPnN0YXRlID0gRVJETUFfRVBTVEFURV9DTE9TRUQ7
DQo+ICsNCj4gKwllcmRtYV9jZXBfc2V0X2ZyZWUoY2VwKTsNCj4gKwllcmRtYV9jZXBfcHV0KGNl
cCk7DQo+ICsNCj4gKwlyZXR1cm4gMDsNCj4gK30NCj4gKw0KPiAraW50IGVyZG1hX2NyZWF0ZV9s
aXN0ZW4oc3RydWN0IGl3X2NtX2lkICppZCwgaW50IGJhY2tsb2cpDQo+ICt7DQo+ICsJc3RydWN0
IHNvY2tldCAqczsNCj4gKwlzdHJ1Y3QgZXJkbWFfY2VwICpjZXAgPSBOVUxMOw0KPiArCWludCBy
ZXQgPSAwOw0KPiArCXN0cnVjdCBlcmRtYV9kZXYgKmRldiA9IHRvX2VkZXYoaWQtPmRldmljZSk7
DQo+ICsJaW50IGFkZHJfZmFtaWx5ID0gaWQtPmxvY2FsX2FkZHIuc3NfZmFtaWx5Ow0KPiArCXN0
cnVjdCBzb2NrYWRkcl9pbiAqbGFkZHIgPSAmdG9fc29ja2FkZHJfaW4oaWQtPmxvY2FsX2FkZHIp
Ow0KPiArDQo+ICsJaWYgKGFkZHJfZmFtaWx5ICE9IEFGX0lORVQpDQo+ICsJCXJldHVybiAtRUFG
Tk9TVVBQT1JUOw0KPiArDQo+ICsJcmV0ID0gc29ja19jcmVhdGUoYWRkcl9mYW1pbHksIFNPQ0tf
U1RSRUFNLCBJUFBST1RPX1RDUCwgJnMpOw0KPiArCWlmIChyZXQgPCAwKQ0KPiArCQlyZXR1cm4g
cmV0Ow0KPiArDQo+ICsJc29ja19zZXRfcmV1c2VhZGRyKHMtPnNrKTsNCj4gKw0KPiArCS8qIEZv
ciB3aWxkY2FyZCBhZGRyLCBsaW1pdCBiaW5kaW5nIHRvIGN1cnJlbnQgZGV2aWNlIG9ubHkgKi8N
Cj4gKwlpZiAoaXB2NF9pc196ZXJvbmV0KGxhZGRyLT5zaW5fYWRkci5zX2FkZHIpKQ0KPiArCQlz
LT5zay0+c2tfYm91bmRfZGV2X2lmID0gZGV2LT5uZXRkZXYtPmlmaW5kZXg7DQo+ICsNCj4gKwly
ZXQgPSBzLT5vcHMtPmJpbmQocywgKHN0cnVjdCBzb2NrYWRkciAqKWxhZGRyLA0KPiArCQkJICAg
c2l6ZW9mKHN0cnVjdCBzb2NrYWRkcl9pbikpOw0KPiArCWlmIChyZXQpDQo+ICsJCWdvdG8gZXJy
b3I7DQo+ICsNCj4gKwljZXAgPSBlcmRtYV9jZXBfYWxsb2MoZGV2KTsNCj4gKwlpZiAoIWNlcCkg
ew0KPiArCQlyZXQgPSAtRU5PTUVNOw0KPiArCQlnb3RvIGVycm9yOw0KPiArCX0NCj4gKwllcmRt
YV9jZXBfc29ja2V0X2Fzc29jKGNlcCwgcyk7DQo+ICsNCj4gKwlyZXQgPSBlcmRtYV9jbV9hbGxv
Y193b3JrKGNlcCwgYmFja2xvZyk7DQo+ICsJaWYgKHJldCkNCj4gKwkJZ290byBlcnJvcjsNCj4g
Kw0KPiArCXJldCA9IHMtPm9wcy0+bGlzdGVuKHMsIGJhY2tsb2cpOw0KPiArCWlmIChyZXQpDQo+
ICsJCWdvdG8gZXJyb3I7DQo+ICsNCj4gKwljZXAtPmNtX2lkID0gaWQ7DQo+ICsJaWQtPmFkZF9y
ZWYoaWQpOw0KPiArDQo+ICsJaWYgKCFpZC0+cHJvdmlkZXJfZGF0YSkgew0KPiArCQlpZC0+cHJv
dmlkZXJfZGF0YSA9DQo+ICsJCQlrbWFsbG9jKHNpemVvZihzdHJ1Y3QgbGlzdF9oZWFkKSwgR0ZQ
X0tFUk5FTCk7DQo+ICsJCWlmICghaWQtPnByb3ZpZGVyX2RhdGEpIHsNCj4gKwkJCXJldCA9IC1F
Tk9NRU07DQo+ICsJCQlnb3RvIGVycm9yOw0KPiArCQl9DQo+ICsJCUlOSVRfTElTVF9IRUFEKChz
dHJ1Y3QgbGlzdF9oZWFkICopaWQtPnByb3ZpZGVyX2RhdGEpOw0KPiArCX0NCj4gKw0KPiArCWxp
c3RfYWRkX3RhaWwoJmNlcC0+bGlzdGVucSwgKHN0cnVjdCBsaXN0X2hlYWQgKilpZC0+cHJvdmlk
ZXJfZGF0YSk7DQo+ICsJY2VwLT5zdGF0ZSA9IEVSRE1BX0VQU1RBVEVfTElTVEVOSU5HOw0KPiAr
DQo+ICsJcmV0dXJuIDA7DQo+ICsNCj4gK2Vycm9yOg0KPiArCWlmIChjZXApIHsNCj4gKwkJZXJk
bWFfY2VwX3NldF9pbnVzZShjZXApOw0KPiArDQo+ICsJCWlmIChjZXAtPmNtX2lkKSB7DQo+ICsJ
CQljZXAtPmNtX2lkLT5yZW1fcmVmKGNlcC0+Y21faWQpOw0KPiArCQkJY2VwLT5jbV9pZCA9IE5V
TEw7DQo+ICsJCX0NCj4gKwkJY2VwLT5zb2NrID0gTlVMTDsNCj4gKwkJZXJkbWFfc29ja2V0X2Rp
c2Fzc29jKHMpOw0KPiArCQljZXAtPnN0YXRlID0gRVJETUFfRVBTVEFURV9DTE9TRUQ7DQo+ICsN
Cj4gKwkJZXJkbWFfY2VwX3NldF9mcmVlKGNlcCk7DQo+ICsJCWVyZG1hX2NlcF9wdXQoY2VwKTsN
Cj4gKwl9DQo+ICsJc29ja19yZWxlYXNlKHMpOw0KPiArDQo+ICsJcmV0dXJuIHJldDsNCj4gK30N
Cj4gKw0KPiArc3RhdGljIHZvaWQgZXJkbWFfZHJvcF9saXN0ZW5lcnMoc3RydWN0IGl3X2NtX2lk
ICppZCkNCj4gK3sNCj4gKwlzdHJ1Y3QgbGlzdF9oZWFkICpwLCAqdG1wOw0KPiArCS8qDQo+ICsJ
ICogSW4gY2FzZSBvZiBhIHdpbGRjYXJkIHJkbWFfbGlzdGVuIG9uIGEgbXVsdGktaG9tZWQgZGV2
aWNlLA0KPiArCSAqIGEgbGlzdGVuZXIncyBJV0NNIGlkIGlzIGFzc29jaWF0ZWQgd2l0aCBtb3Jl
IHRoYW4gb25lIGxpc3RlbmluZw0KPiBDRVAuDQo+ICsJICovDQo+ICsJbGlzdF9mb3JfZWFjaF9z
YWZlKHAsIHRtcCwgKHN0cnVjdCBsaXN0X2hlYWQgKilpZC0+cHJvdmlkZXJfZGF0YSkgew0KPiAr
CQlzdHJ1Y3QgZXJkbWFfY2VwICpjZXAgPQ0KPiArCQkJbGlzdF9lbnRyeShwLCBzdHJ1Y3QgZXJk
bWFfY2VwLCBsaXN0ZW5xKTsNCj4gKw0KPiArCQlsaXN0X2RlbChwKTsNCj4gKw0KPiArCQllcmRt
YV9jZXBfc2V0X2ludXNlKGNlcCk7DQo+ICsNCj4gKwkJaWYgKGNlcC0+Y21faWQpIHsNCj4gKwkJ
CWNlcC0+Y21faWQtPnJlbV9yZWYoY2VwLT5jbV9pZCk7DQo+ICsJCQljZXAtPmNtX2lkID0gTlVM
TDsNCj4gKwkJfQ0KPiArCQlpZiAoY2VwLT5zb2NrKSB7DQo+ICsJCQllcmRtYV9zb2NrZXRfZGlz
YXNzb2MoY2VwLT5zb2NrKTsNCj4gKwkJCXNvY2tfcmVsZWFzZShjZXAtPnNvY2spOw0KPiArCQkJ
Y2VwLT5zb2NrID0gTlVMTDsNCj4gKwkJfQ0KPiArCQljZXAtPnN0YXRlID0gRVJETUFfRVBTVEFU
RV9DTE9TRUQ7DQo+ICsJCWVyZG1hX2NlcF9zZXRfZnJlZShjZXApOw0KPiArCQllcmRtYV9jZXBf
cHV0KGNlcCk7DQo+ICsJfQ0KPiArfQ0KPiArDQo+ICtpbnQgZXJkbWFfZGVzdHJveV9saXN0ZW4o
c3RydWN0IGl3X2NtX2lkICppZCkNCj4gK3sNCj4gKwlpZiAoIWlkLT5wcm92aWRlcl9kYXRhKQ0K
PiArCQlyZXR1cm4gMDsNCj4gKw0KPiArCWVyZG1hX2Ryb3BfbGlzdGVuZXJzKGlkKTsNCj4gKwlr
ZnJlZShpZC0+cHJvdmlkZXJfZGF0YSk7DQo+ICsJaWQtPnByb3ZpZGVyX2RhdGEgPSBOVUxMOw0K
PiArDQo+ICsJcmV0dXJuIDA7DQo+ICt9DQo+ICsNCj4gK2ludCBlcmRtYV9jbV9pbml0KHZvaWQp
DQo+ICt7DQo+ICsJZXJkbWFfY21fd3EgPSBjcmVhdGVfc2luZ2xldGhyZWFkX3dvcmtxdWV1ZSgi
ZXJkbWFfY21fd3EiKTsNCj4gKwlpZiAoIWVyZG1hX2NtX3dxKQ0KPiArCQlyZXR1cm4gLUVOT01F
TTsNCj4gKw0KPiArCXJldHVybiAwOw0KPiArfQ0KPiArDQo+ICt2b2lkIGVyZG1hX2NtX2V4aXQo
dm9pZCkNCj4gK3sNCj4gKwlpZiAoZXJkbWFfY21fd3EpDQo+ICsJCWRlc3Ryb3lfd29ya3F1ZXVl
KGVyZG1hX2NtX3dxKTsNCj4gK30NCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvaW5maW5pYmFuZC9o
dy9lcmRtYS9lcmRtYV9jbS5oDQo+IGIvZHJpdmVycy9pbmZpbmliYW5kL2h3L2VyZG1hL2VyZG1h
X2NtLmgNCj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQNCj4gaW5kZXggMDAwMDAwMDAwMDAwLi43Mjkx
NGE0YzAwYjENCj4gLS0tIC9kZXYvbnVsbA0KPiArKysgYi9kcml2ZXJzL2luZmluaWJhbmQvaHcv
ZXJkbWEvZXJkbWFfY20uaA0KPiBAQCAtMCwwICsxLDE2NyBAQA0KPiArLyogU1BEWC1MaWNlbnNl
LUlkZW50aWZpZXI6IEdQTC0yLjAgb3IgQlNELTMtQ2xhdXNlICovDQo+ICsNCj4gKy8qIEF1dGhv
cnM6IENoZW5nIFh1IDxjaGVuZ3lvdUBsaW51eC5hbGliYWJhLmNvbT4gKi8NCj4gKy8qICAgICAg
ICAgIEthaSBTaGVuIDxrYWlzaGVuQGxpbnV4LmFsaWJhYmEuY29tPiAqLw0KPiArLyogQ29weXJp
Z2h0IChjKSAyMDIwLTIwMjIsIEFsaWJhYmEgR3JvdXAuICovDQo+ICsNCj4gKy8qIEF1dGhvcnM6
IEJlcm5hcmQgTWV0emxlciA8Ym10QHp1cmljaC5pYm0uY29tPiAqLw0KPiArLyogICAgICAgICAg
R3JlZyBKb3ljZSA8Z3JlZ0BvcGVuZ3JpZGNvbXB1dGluZy5jb20+ICovDQo+ICsvKiBDb3B5cmln
aHQgKGMpIDIwMDgtMjAxOSwgSUJNIENvcnBvcmF0aW9uICovDQo+ICsvKiBDb3B5cmlnaHQgKGMp
IDIwMTcsIE9wZW4gR3JpZCBDb21wdXRpbmcsIEluYy4gKi8NCj4gKw0KPiArI2lmbmRlZiBfX0VS
RE1BX0NNX0hfXw0KPiArI2RlZmluZSBfX0VSRE1BX0NNX0hfXw0KPiArDQo+ICsjaW5jbHVkZSA8
bmV0L3NvY2suaD4NCj4gKyNpbmNsdWRlIDxsaW51eC90Y3AuaD4NCj4gKw0KPiArI2luY2x1ZGUg
PHJkbWEvaXdfY20uaD4NCj4gKw0KPiArLyogaVdhcnAgTVBBIHByb3RvY29sIGRlZnMgKi8NCj4g
KyNkZWZpbmUgTVBBX1JFVklTSU9OX0VYVF8xIDEyOQ0KPiArI2RlZmluZSBNUEFfTUFYX1BSSVZE
QVRBIFJETUFfTUFYX1BSSVZBVEVfREFUQQ0KPiArI2RlZmluZSBNUEFfS0VZX1JFUSAiTVBBIElE
IFJlcSBGcmFtZSINCj4gKyNkZWZpbmUgTVBBX0tFWV9SRVAgIk1QQSBJRCBSZXAgRnJhbWUiDQo+
ICsjZGVmaW5lIE1QQV9LRVlfU0laRSAxNg0KPiArI2RlZmluZSBNUEFfREVGQVVMVF9IRFJfTEVO
IDI4DQo+ICsNCj4gK3N0cnVjdCBtcGFfcnJfcGFyYW1zIHsNCj4gKwlfX2JlMTYgYml0czsNCj4g
KwlfX2JlMTYgcGRfbGVuOw0KPiArfTsNCj4gKw0KPiArLyoNCj4gKyAqIE1QQSByZXF1ZXN0L3Jl
c3BvbnNlIEhkciBiaXRzICYgZmllbGRzDQo+ICsgKi8NCj4gK2VudW0gew0KPiArCU1QQV9SUl9G
TEFHX01BUktFUlMgPSBfX2NwdV90b19iZTE2KDB4ODAwMCksDQo+ICsJTVBBX1JSX0ZMQUdfQ1JD
ID0gX19jcHVfdG9fYmUxNigweDQwMDApLA0KPiArCU1QQV9SUl9GTEFHX1JFSkVDVCA9IF9fY3B1
X3RvX2JlMTYoMHgyMDAwKSwNCj4gKwlNUEFfUlJfUkVTRVJWRUQgPSBfX2NwdV90b19iZTE2KDB4
MWYwMCksDQo+ICsJTVBBX1JSX01BU0tfUkVWSVNJT04gPSBfX2NwdV90b19iZTE2KDB4MDBmZikN
Cj4gK307DQo+ICsNCj4gKy8qDQo+ICsgKiBNUEEgcmVxdWVzdC9yZXBseSBoZWFkZXINCj4gKyAq
Lw0KPiArc3RydWN0IG1wYV9yciB7DQo+ICsJdTgga2V5WzE2XTsNCj4gKwlzdHJ1Y3QgbXBhX3Jy
X3BhcmFtcyBwYXJhbXM7DQo+ICt9Ow0KPiArDQo+ICtzdHJ1Y3QgZXJkbWFfbXBhX2V4dCB7DQo+
ICsJX19iZTMyIGNvb2tpZTsNCj4gKwlfX2JlMzIgYml0czsNCj4gK307DQo+ICsNCj4gKyNkZWZp
bmUgTVBBX0VYVF9ERVNJUkVEX0NDX01BU0sgR0VOTUFTSygzMSwgMjgpDQo+ICsjZGVmaW5lIE1Q
QV9FWFRfUlNWRF9NQVNLIEdFTk1BU0soMjcsIDApDQo+ICsNCj4gK3N0cnVjdCBlcmRtYV9tcGFf
aW5mbyB7DQo+ICsJc3RydWN0IG1wYV9yciBoZHI7IC8qIHBlZXIgbXBhIGhkciBpbiBob3N0IGJ5
dGUgb3JkZXIgKi8NCj4gKwlzdHJ1Y3QgZXJkbWFfbXBhX2V4dCBleHRfZGF0YTsNCj4gKwljaGFy
ICpwZGF0YTsNCj4gKwlpbnQgYnl0ZXNfcmN2ZDsNCj4gK307DQo+ICsNCj4gK3N0cnVjdCBlcmRt
YV9za191cGNhbGxzIHsNCj4gKwl2b2lkICgqc2tfc3RhdGVfY2hhbmdlKShzdHJ1Y3Qgc29jayAq
c2spOw0KPiArCXZvaWQgKCpza19kYXRhX3JlYWR5KShzdHJ1Y3Qgc29jayAqc2ssIGludCBieXRl
cyk7DQo+ICsJdm9pZCAoKnNrX2Vycm9yX3JlcG9ydCkoc3RydWN0IHNvY2sgKnNrKTsNCj4gK307
DQo+ICsNCj4gK3N0cnVjdCBlcmRtYV9kZXY7DQo+ICsNCj4gK2VudW0gZXJkbWFfY2VwX3N0YXRl
IHsNCj4gKwlFUkRNQV9FUFNUQVRFX0lETEUgPSAxLA0KPiArCUVSRE1BX0VQU1RBVEVfTElTVEVO
SU5HLA0KPiArCUVSRE1BX0VQU1RBVEVfQ09OTkVDVElORywNCj4gKwlFUkRNQV9FUFNUQVRFX0FX
QUlUX01QQVJFUSwNCj4gKwlFUkRNQV9FUFNUQVRFX1JFQ1ZEX01QQVJFUSwNCj4gKwlFUkRNQV9F
UFNUQVRFX0FXQUlUX01QQVJFUCwNCj4gKwlFUkRNQV9FUFNUQVRFX1JETUFfTU9ERSwNCj4gKwlF
UkRNQV9FUFNUQVRFX0NMT1NFRA0KPiArfTsNCj4gKw0KPiArc3RydWN0IGVyZG1hX2NlcCB7DQo+
ICsJc3RydWN0IGl3X2NtX2lkICpjbV9pZDsNCj4gKwlzdHJ1Y3QgZXJkbWFfZGV2ICpkZXY7DQo+
ICsJc3RydWN0IGxpc3RfaGVhZCBkZXZxOw0KPiArCXNwaW5sb2NrX3QgbG9jazsNCj4gKwlzdHJ1
Y3Qga3JlZiByZWY7DQo+ICsJaW50IGluX3VzZTsNCj4gKwl3YWl0X3F1ZXVlX2hlYWRfdCB3YWl0
cTsNCj4gKwllbnVtIGVyZG1hX2NlcF9zdGF0ZSBzdGF0ZTsNCj4gKw0KPiArCXN0cnVjdCBsaXN0
X2hlYWQgbGlzdGVucTsNCj4gKwlzdHJ1Y3QgZXJkbWFfY2VwICpsaXN0ZW5fY2VwOw0KPiArDQo+
ICsJc3RydWN0IGVyZG1hX3FwICpxcDsNCj4gKwlzdHJ1Y3Qgc29ja2V0ICpzb2NrOw0KPiArDQo+
ICsJc3RydWN0IGVyZG1hX2NtX3dvcmsgKm1wYV90aW1lcjsNCj4gKwlzdHJ1Y3QgbGlzdF9oZWFk
IHdvcmtfZnJlZWxpc3Q7DQo+ICsNCj4gKwlzdHJ1Y3QgZXJkbWFfbXBhX2luZm8gbXBhOw0KPiAr
CWludCBvcmQ7DQo+ICsJaW50IGlyZDsNCj4gKw0KPiArCWludCBwZF9sZW47DQo+ICsJLyogaG9s
ZCB1c2VyJ3MgcHJpdmF0ZSBkYXRhLiAqLw0KPiArCXZvaWQgKnByaXZhdGVfZGF0YTsNCj4gKw0K
PiArCS8qIFNhdmVkIHVwY2FsbHMgb2Ygc29ja2V0IGxscC5zb2NrICovDQo+ICsJdm9pZCAoKnNr
X3N0YXRlX2NoYW5nZSkoc3RydWN0IHNvY2sgKnNrKTsNCj4gKwl2b2lkICgqc2tfZGF0YV9yZWFk
eSkoc3RydWN0IHNvY2sgKnNrKTsNCj4gKwl2b2lkICgqc2tfZXJyb3JfcmVwb3J0KShzdHJ1Y3Qg
c29jayAqc2spOw0KPiArfTsNCj4gKw0KPiArI2RlZmluZSBNUEFSRVFfVElNRU9VVCAoSFogKiAy
MCkNCj4gKyNkZWZpbmUgTVBBUkVQX1RJTUVPVVQgKEhaICogMTApDQo+ICsjZGVmaW5lIENPTk5F
Q1RfVElNRU9VVCAoSFogKiAxMCkNCj4gKw0KPiArZW51bSBlcmRtYV93b3JrX3R5cGUgew0KPiAr
CUVSRE1BX0NNX1dPUktfQUNDRVBUID0gMSwNCj4gKwlFUkRNQV9DTV9XT1JLX1JFQURfTVBBSERS
LA0KPiArCUVSRE1BX0NNX1dPUktfQ0xPU0VfTExQLCAvKiBjbG9zZSBzb2NrZXQgKi8NCj4gKwlF
UkRNQV9DTV9XT1JLX1BFRVJfQ0xPU0UsIC8qIHNvY2tldCBpbmRpY2F0ZWQgcGVlciBjbG9zZSAq
Lw0KPiArCUVSRE1BX0NNX1dPUktfTVBBVElNRU9VVCwNCj4gKwlFUkRNQV9DTV9XT1JLX0NPTk5F
Q1RFRCwNCj4gKwlFUkRNQV9DTV9XT1JLX0NPTk5FQ1RUSU1FT1VUDQo+ICt9Ow0KPiArDQo+ICtz
dHJ1Y3QgZXJkbWFfY21fd29yayB7DQo+ICsJc3RydWN0IGRlbGF5ZWRfd29yayB3b3JrOw0KPiAr
CXN0cnVjdCBsaXN0X2hlYWQgbGlzdDsNCj4gKwllbnVtIGVyZG1hX3dvcmtfdHlwZSB0eXBlOw0K
PiArCXN0cnVjdCBlcmRtYV9jZXAgKmNlcDsNCj4gK307DQo+ICsNCj4gKyNkZWZpbmUgdG9fc29j
a2FkZHJfaW4oYSkgKCooc3RydWN0IHNvY2thZGRyX2luICopKCYoYSkpKQ0KPiArDQo+ICtzdGF0
aWMgaW5saW5lIGludCBnZXRuYW1lX3BlZXIoc3RydWN0IHNvY2tldCAqcywgc3RydWN0IHNvY2th
ZGRyX3N0b3JhZ2UNCj4gKmEpDQo+ICt7DQo+ICsJcmV0dXJuIHMtPm9wcy0+Z2V0bmFtZShzLCAo
c3RydWN0IHNvY2thZGRyICopYSwgMSk7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyBpbmxpbmUgaW50
IGdldG5hbWVfbG9jYWwoc3RydWN0IHNvY2tldCAqcywgc3RydWN0IHNvY2thZGRyX3N0b3JhZ2UN
Cj4gKmEpDQo+ICt7DQo+ICsJcmV0dXJuIHMtPm9wcy0+Z2V0bmFtZShzLCAoc3RydWN0IHNvY2th
ZGRyICopYSwgMCk7DQo+ICt9DQo+ICsNCj4gK2ludCBlcmRtYV9jb25uZWN0KHN0cnVjdCBpd19j
bV9pZCAqaWQsIHN0cnVjdCBpd19jbV9jb25uX3BhcmFtICpwYXJhbSk7DQo+ICtpbnQgZXJkbWFf
YWNjZXB0KHN0cnVjdCBpd19jbV9pZCAqaWQsIHN0cnVjdCBpd19jbV9jb25uX3BhcmFtICpwYXJh
bSk7DQo+ICtpbnQgZXJkbWFfcmVqZWN0KHN0cnVjdCBpd19jbV9pZCAqaWQsIGNvbnN0IHZvaWQg
KnBkYXRhLCB1OCBwbGVuKTsNCj4gK2ludCBlcmRtYV9jcmVhdGVfbGlzdGVuKHN0cnVjdCBpd19j
bV9pZCAqaWQsIGludCBiYWNrbG9nKTsNCj4gK2ludCBlcmRtYV9kZXN0cm95X2xpc3RlbihzdHJ1
Y3QgaXdfY21faWQgKmlkKTsNCj4gKw0KPiArdm9pZCBlcmRtYV9jZXBfZ2V0KHN0cnVjdCBlcmRt
YV9jZXAgKmNlcSk7DQo+ICt2b2lkIGVyZG1hX2NlcF9wdXQoc3RydWN0IGVyZG1hX2NlcCAqY2Vx
KTsNCj4gK2ludCBlcmRtYV9jbV9xdWV1ZV93b3JrKHN0cnVjdCBlcmRtYV9jZXAgKmNlcSwgZW51
bSBlcmRtYV93b3JrX3R5cGUNCj4gdHlwZSk7DQo+ICsNCj4gK2ludCBlcmRtYV9jbV9pbml0KHZv
aWQpOw0KPiArdm9pZCBlcmRtYV9jbV9leGl0KHZvaWQpOw0KPiArDQo+ICsjZGVmaW5lIHNrX3Rv
X2NlcChzaykgKChzdHJ1Y3QgZXJkbWFfY2VwICopKChzayktPnNrX3VzZXJfZGF0YSkpDQo+ICsN
Cj4gKyNlbmRpZg0KPiAtLQ0KPiAyLjI3LjANCg0K
