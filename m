Return-Path: <linux-rdma-owner@vger.kernel.org>
X-Original-To: lists+linux-rdma@lfdr.de
Delivered-To: lists+linux-rdma@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id AB7E8492801
	for <lists+linux-rdma@lfdr.de>; Tue, 18 Jan 2022 15:07:12 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S233917AbiAROHL (ORCPT <rfc822;lists+linux-rdma@lfdr.de>);
        Tue, 18 Jan 2022 09:07:11 -0500
Received: from mx0a-001b2d01.pphosted.com ([148.163.156.1]:19170 "EHLO
        mx0a-001b2d01.pphosted.com" rhost-flags-OK-OK-OK-OK)
        by vger.kernel.org with ESMTP id S233774AbiAROHL (ORCPT
        <rfc822;linux-rdma@vger.kernel.org>);
        Tue, 18 Jan 2022 09:07:11 -0500
Received: from pps.filterd (m0098396.ppops.net [127.0.0.1])
        by mx0a-001b2d01.pphosted.com (8.16.1.2/8.16.1.2) with SMTP id 20IE6mSg013395;
        Tue, 18 Jan 2022 14:07:05 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=ibm.com; h=from : to : cc : subject
 : date : message-id : content-type : content-transfer-encoding :
 mime-version; s=pp1; bh=gY6k4wIWdMJn0fmzXihGaCMrc6n4h42Q/RuCXqh3Jug=;
 b=rkGnhAcwHJpJO3h+TqbHpB24ZATd7GZ6/mGPA86mmzGm1oMv7ObISCiSgQpjqNOUbiq+
 PnzKj8RWaaJrID68WET8KBOyc5R7Fd3h/Hdih2oMjqMypzG8m6hukmu6QkBY71a5ZmMn
 SiyCfYfNf/Wl9Ch5rt1pF2LLOBSO6o7ACTxOpUvfBvCUi3FvuZbsfXUsfWAc/RVP7oi1
 tszJv3BNG6uOudfRQngQxhWMrB8ZqHVuNpWGcBXMZeUdV58zQi0uIhS0ZaOXpBckUOyA
 vbmGO6nzzP9VLhiCFyR+49kBc8KzxUZgzKjVpyb7dP7bObdAu+VfW2SUoa29RB78HhnP cQ== 
Received: from pps.reinject (localhost [127.0.0.1])
        by mx0a-001b2d01.pphosted.com with ESMTP id 3dnutjxh60-1
        (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
        Tue, 18 Jan 2022 14:07:04 +0000
Received: from m0098396.ppops.net (m0098396.ppops.net [127.0.0.1])
        by pps.reinject (8.16.0.43/8.16.0.43) with SMTP id 20IE738c015598;
        Tue, 18 Jan 2022 14:07:03 GMT
Received: from ppma04wdc.us.ibm.com (1a.90.2fa9.ip4.static.sl-reverse.com [169.47.144.26])
        by mx0a-001b2d01.pphosted.com with ESMTP id 3dnutjxh4x-1
        (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
        Tue, 18 Jan 2022 14:07:03 +0000
Received: from pps.filterd (ppma04wdc.us.ibm.com [127.0.0.1])
        by ppma04wdc.us.ibm.com (8.16.1.2/8.16.1.2) with SMTP id 20IDvftY016950;
        Tue, 18 Jan 2022 14:07:02 GMT
Received: from b03cxnp07028.gho.boulder.ibm.com (b03cxnp07028.gho.boulder.ibm.com [9.17.130.15])
        by ppma04wdc.us.ibm.com with ESMTP id 3dknwaj8kv-1
        (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
        Tue, 18 Jan 2022 14:07:02 +0000
Received: from b03ledav005.gho.boulder.ibm.com (b03ledav005.gho.boulder.ibm.com [9.17.130.236])
        by b03cxnp07028.gho.boulder.ibm.com (8.14.9/8.14.9/NCO v10.0) with ESMTP id 20IE71gD30277986
        (version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-GCM-SHA384 bits=256 verify=OK);
        Tue, 18 Jan 2022 14:07:01 GMT
Received: from b03ledav005.gho.boulder.ibm.com (unknown [127.0.0.1])
        by IMSVA (Postfix) with ESMTP id 0C7C5BE056;
        Tue, 18 Jan 2022 14:07:01 +0000 (GMT)
Received: from b03ledav005.gho.boulder.ibm.com (unknown [127.0.0.1])
        by IMSVA (Postfix) with ESMTP id A9773BE05D;
        Tue, 18 Jan 2022 14:07:00 +0000 (GMT)
Received: from mail.gmx.ibm.com (unknown [9.209.250.64])
        by b03ledav005.gho.boulder.ibm.com (Postfix) with ESMTPS;
        Tue, 18 Jan 2022 14:07:00 +0000 (GMT)
Received: from m03ex005.gmx.ibm.com (10.120.110.60) by m03ex003.gmx.ibm.com
 (10.94.54.126) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id 15.1.2375.17; Tue, 18 Jan
 2022 09:06:59 -0500
Received: from NAM10-BN7-obe.outbound.protection.outlook.com (9.221.46.12) by
 m03ex005.gmx.ibm.com (10.120.110.60) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id
 15.1.2375.17 via Frontend Transport; Tue, 18 Jan 2022 09:06:58 -0500
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=igsmBTloAkTN5fetNPL/i6/dkHyftXEiK5y5jye9kTTc4svQzLGkpKM0AowVwGgSlPWCkTXvqOd2ZC3RNOv8ohTmq9ItEHmocX0i3dKxAv5INNSGVV4h1N4Azclnb2qkAbxP9sp3yMTA0t5R5IonxPty7ax8crv8+qZ5ynitwUx1U9dFsAIhuBtPR+vM9yb8IpV6MH9ixMTFts3G1DNqfQjDJiZOAdqOSpcH92S27w+4FSCwI6mgYxs1xhGojj0y0T+ribiN3DeDCFiOWwTKuG1eXPafdGJJ5l8mOXUPFr4wfvNjoRZv/JG3pzYq7+dKgOyiurHLrAepvtno4ls5JA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=gY6k4wIWdMJn0fmzXihGaCMrc6n4h42Q/RuCXqh3Jug=;
 b=OXHH71o22EwFSGmwUu/9BgrH14/jz4UPPWYGr3zTzgKX+num9W54HRG13Nc9ck1SDxHmTuR0jCAuv/HjzYCr9dFrxoB7+8f6YDipY9yzPkSPGc+KY4SHDFByx2T9hG5ges8AZ0k6S4b5ThpeneLcWCvxVOc+f8O2m1nYDTJvgpUAM0ZZfehFyc7kbxsl32nybvNnX4qC3e/BQ4Zz0u4wByGnSRfr+ej0FPPACIpDvi2ApX4vD1rDThhsEYaM74CusdiH3dHoqz1ZpOlmHid9UFsKuAK2v0FHbqSpzTKKjGLJB3mlkLiRkYRq8cyX9XuVNTfKxhO/OTFRTcm7i8n0WQ==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=zurich.ibm.com; dmarc=pass action=none
 header.from=zurich.ibm.com; dkim=pass header.d=zurich.ibm.com; arc=none
Received: from BYAPR15MB2631.namprd15.prod.outlook.com (2603:10b6:a03:150::19)
 by DM5PR15MB1643.namprd15.prod.outlook.com (2603:10b6:3:11c::23) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.4888.10; Tue, 18 Jan
 2022 14:06:54 +0000
Received: from BYAPR15MB2631.namprd15.prod.outlook.com
 ([fe80::31b8:a1ab:2121:fba3]) by BYAPR15MB2631.namprd15.prod.outlook.com
 ([fe80::31b8:a1ab:2121:fba3%6]) with mapi id 15.20.4888.014; Tue, 18 Jan 2022
 14:06:54 +0000
From:   Bernard Metzler <BMT@zurich.ibm.com>
To:     Cheng Xu <chengyou@linux.alibaba.com>,
        "jgg@ziepe.ca" <jgg@ziepe.ca>,
        "dledford@redhat.com" <dledford@redhat.com>
CC:     "leon@kernel.org" <leon@kernel.org>,
        "linux-rdma@vger.kernel.org" <linux-rdma@vger.kernel.org>,
        "KaiShen@linux.alibaba.com" <KaiShen@linux.alibaba.com>,
        "tonylu@linux.alibaba.com" <tonylu@linux.alibaba.com>
Subject: RE: [PATCH rdma-next v2 07/11] RDMA/erdma: Add verbs implementation
Thread-Topic: [PATCH rdma-next v2 07/11] RDMA/erdma: Add verbs implementation
Thread-Index: AdgMdKS39MEHWNEIREqOhl7CaKaF7g==
Date:   Tue, 18 Jan 2022 14:06:54 +0000
Message-ID: <BYAPR15MB2631E68F8FB3AFF7113B4E5A99589@BYAPR15MB2631.namprd15.prod.outlook.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: e2616af9-6233-434a-bfd5-08d9da8bc862
x-ms-traffictypediagnostic: DM5PR15MB1643:EE_
x-microsoft-antispam-prvs: <DM5PR15MB1643A070199E3ECC24DF77EE99589@DM5PR15MB1643.namprd15.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:172;
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: dhtJo79i2S+HJIixZWQoUucJChP06s4/QvAyeXa/LUqho5x4xpOrQ8+vnPsbvHooqK6mVkzBLYBhzPezsvpYNziGEA5tHN9G7YCtSReWsDCcxhOLI6eT6x3zH9O1l2NKccLg21Ptw5PWnMvBWNoDnPnbL2oAVJUJ55/czmmo9aJryyxD8ucpmpyVkQQPs4a4qBvCk2HxMkeMRGXI4p124wnI6IhaJ1ErfP7XIAZCDMZynNsHAtgKWvEWLSUH/dkuviGlO7lovOCXoUnOgh+bE9tijHQHGA+SMNdyhx96Z3+EzAxQxZgX7u54k+27mYZrDURhEUO0T/XK8fgKBlqJiUK0lFkRZUYfVVfYgVQfiZUUS8sx19prI7ZpzF+yHbftxuujcczsmh2mxNXa5r/nlH9j3gppl4uSEZ+BUQe2cYTWW+ufuw7nXRfPT/by+YgFIFFuIw41ecfpTcJttb/64gsUs7bIQWIOyGTPcwlIbPKCzjFTOaKjdhx8citu3yUOGWMYp3igUdqyh0yBCNtQwOaiQbf/brK7rF0eYU+7lUI92MXQAT3azdYIxTkVEr3OG4oBpwv9ZygYew5HJzEH5qHPvyALpL3Kzvoq2b0X43CYaUAeMtAdrko5SIEJXUdRPy6BHT4mjRACxyUmfFbbJZUbK9SZ7fDs6s0fiTdR6r7HmR/sJrjXd6BvUQHV7NqjGais3qhktcw1aTkptNw5NA==
x-forefront-antispam-report: CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:BYAPR15MB2631.namprd15.prod.outlook.com;PTR:;CAT:NONE;SFS:(4636009)(366004)(2906002)(66476007)(66946007)(7696005)(71200400001)(316002)(9686003)(83380400001)(8676002)(76116006)(55016003)(186003)(4326008)(38100700002)(30864003)(508600001)(52536014)(64756008)(86362001)(38070700005)(122000001)(33656002)(54906003)(66446008)(6506007)(5660300002)(8936002)(66556008)(53546011)(110136005)(559001)(579004);DIR:OUT;SFP:1101;
x-ms-exchange-antispam-messagedata-chunkcount: 1
x-ms-exchange-antispam-messagedata-0: =?utf-8?B?eXVSWGxmSUlPOWV5di96SVkrLytzNXlVd3RnVjJjWVV4WDd5SlZ2Z0tnU1dE?=
 =?utf-8?B?dWRmY2ZtbE5IYndhZXE5SmhwSjZrdXRyUnF1QjFjYm9YdVMzbHpaWDQ0ekRw?=
 =?utf-8?B?Ym5mT0xYU1YzR1RRMXorR3hBZ1I2M2RyeFhVSWxVTkllMHVJVGM5QjRLbkE1?=
 =?utf-8?B?eE8vRElLeExtVDNORktHcnFVZUxNMTVBeWZpV1RoeVI3NG45S3pYT0Z2SWhl?=
 =?utf-8?B?YVNKVFNLaU9QR3lIc3hWOE8rZVVNUTNuOEZPRkwyWGt0VS9CQUJYVmMvRER5?=
 =?utf-8?B?Zys0bElPckZrOGFXVFl2TWNwU3AvNTR0YWxlMllhSDZJQnhhQXNtbFhSY3No?=
 =?utf-8?B?NXZ1UnhkVjlJdndwOFY2c3c5a2Z4aDROOGR3ME9QZHJPZWFwL2EzaURJYlhS?=
 =?utf-8?B?TUM2NUdVU1o0ZFI0WFhXYU9Ia2Z3L1lJSmxrQzdyOGc0VUdHdU15ZXR3OHpT?=
 =?utf-8?B?MSs2SEV4QUwwTWxNOVNhRWptR3NLYmQ5WkFXMzQ0NjFTTW81Mk5SUFRpbEt4?=
 =?utf-8?B?TUw1N1l0YVBiTldFWVB4dDJIeFRoblJCMlYrQU9WbVlTcjF5YmtuQWlENGVE?=
 =?utf-8?B?MGZvRVVzdGRnWmpnRGd6R1NpWFJtMGxhdWcwdGVQMHNidnNHY1J1REZXYUVU?=
 =?utf-8?B?SGJOWU9obVdWK3R0OXcyNGhZZmR2SmdCaHYySDhaRXZkNE9UU2dTNHZDV2Zs?=
 =?utf-8?B?dGd0emNJR082eVBRVVBubElqQmhGQmViOUc0UCsyZlhzNmhGd3pFb0s1emhU?=
 =?utf-8?B?c20vMW1KQmkyZXBKUzBSNi9JL0o5LzdjZUhjSHQzWkRBU2xQRHFieE9Hcklo?=
 =?utf-8?B?dWxxQmlWYlZsZ09JazBQTDVab1ptMDVyMEUyQlFUUlJ3TU0xOS94UmJJYTh5?=
 =?utf-8?B?MkozSzc4TzFpK0VncXBtdWdmYTh5cGJkUmtQMWNpN2FzSkZUL05KRjR3aERn?=
 =?utf-8?B?dEdiR0E3TVhRMm5SZElKNWNpTVFqQmoxelk0cnFWREk2cWtoNUN1UTVqZjQy?=
 =?utf-8?B?L2JCMWxOWngrTnd2Wm5BeUVQZ1daWW5mdFRPSkd0MWRMcGhkV2FPdktNcW96?=
 =?utf-8?B?T3VMNE1HNzBhTDRickJuNHhxdnNxUnMvbE1mVTRtY1BSVUYvMFdldVgvMVhu?=
 =?utf-8?B?WDlXUUdlWlZXYUVhNk9kZFV6L1kyQUJ5MnV4SllSdmNNYk5SbVlNU3BJSk8r?=
 =?utf-8?B?cGY1akxIUU9QNkdydll5bVdkQ1pGL1k5V21sUEJEYWJwWG84WjBnZU9YTFdh?=
 =?utf-8?B?R2Q3MlM3L01Ya0pRMVBwemM2SDhsWGdYNTdxcEdSTEhvWlI0cjl3aUtRc0RZ?=
 =?utf-8?B?VFZUWnZVWE54cS9WOUlYSnRCWEJlMElRVTlBVXhHOXJRTC9Bc0JqUVdmbDZ4?=
 =?utf-8?B?TUZJL3NnNS8vdE5UYkNtZlJZRjFCVWthWklSMGtGT3Y2cXIxbkVkYklNUHB5?=
 =?utf-8?B?aWZBdTdPWjdpREU3QXZJYTBIUGVDaWxlZHRBcVZvV2VENmYwNC9EZkhrSmov?=
 =?utf-8?B?U0NjWHZZdzNmTHRnLzFxWmVqREZBUzg1ZGtwZ3pwSjRoT1daTFJ5Nkd2SUV4?=
 =?utf-8?B?NUY2aFFmN2d2cUw1MTdyYXV6NFFOakRsdEhRQ2pZUGdHRnhRcHY4dmdSY25R?=
 =?utf-8?B?TlFHTklHaUhRQXA3QVZEVXhzOXFBdVRhckhQTEpFNW9pR1dpM0Fma21zWEdu?=
 =?utf-8?B?Njd4ZUhNNU5zZ09ENTZ6V3RSQWxkQjhseFJUWmhIY1V0NU9SdWxBeE5FZW9D?=
 =?utf-8?B?NXJLUWxTc3VWYTB1ckFMS3JBQlZyTXN4czAvSXhXcS80bWdIUDUzNHhrSkNl?=
 =?utf-8?B?eTdJL0VsaTFnY25zd3NkcHhsZDlVSXdWZWpzU1JmZS83aldRSW9mOWxuaDZI?=
 =?utf-8?B?VnAydjhFUGR2a1liVHJ0RDBnVWtuMEgreXBRQW5pYk9SOTM3MTM2Wjgwc09J?=
 =?utf-8?B?UXRkMGtZd1FGTTI0NGdBbEZQYit5NFFiMStCa29JWitRTXNVZkFXT0dlY0lh?=
 =?utf-8?B?bU85Z1A5L3ZzRHpQNWE5SnoyRG1oOUFYMGVYTGxkd2lYL29aU1ZaUmxEaXFO?=
 =?utf-8?B?dWJsY1RucHZGcVE3YWhlZlVVU2NJTjMvbDdUMGxhSXZoMUJzUDQ0MGw2VTZ1?=
 =?utf-8?B?RVpPZE1pVlBCdUJzeFpzYTVtblJhdzAyUjhDdGJ3QVZrdGF6WHVkakR0TFNj?=
 =?utf-8?B?TzhoUGRZcVBVWFdMREkwZWRYMlVqQ1pHaXIzOUtzVXJNd0FCU1k3dERQU0VT?=
 =?utf-8?Q?GGkf3UY686sNiV5bQLJHnA867RlJnT6iyLC0PpHA8M=3D?=
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: BYAPR15MB2631.namprd15.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: e2616af9-6233-434a-bfd5-08d9da8bc862
X-MS-Exchange-CrossTenant-originalarrivaltime: 18 Jan 2022 14:06:54.4985
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: fcf67057-50c9-4ad4-98f3-ffca64add9e9
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: Zciz/lkzUKPBzqbXCycSWeYzChQSDLiH/7bZv8gWZpGnYGSDPKgqodFnNKhnpFNQ71bUh3MEXKNyIANGbgA1EQ==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM5PR15MB1643
X-OriginatorOrg: Zurich.ibm.com
X-TM-AS-GCONF: 00
X-Proofpoint-GUID: dcojgUzY2A_DO1pOATFjfutFywpGYmJ2
X-Proofpoint-ORIG-GUID: wTXKnxp9cWh4weczTSDgRy_lzzOwsOJv
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.205,Aquarius:18.0.816,Hydra:6.0.425,FMLib:17.11.62.513
 definitions=2022-01-18_04,2022-01-18_01,2021-12-02_01
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0 impostorscore=0
 malwarescore=0 clxscore=1015 lowpriorityscore=0 bulkscore=0
 priorityscore=1501 mlxlogscore=999 spamscore=0 phishscore=0 adultscore=0
 mlxscore=0 suspectscore=0 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.12.0-2110150000 definitions=main-2201180087
Precedence: bulk
List-ID: <linux-rdma.vger.kernel.org>
X-Mailing-List: linux-rdma@vger.kernel.org

PiAtLS0tLU9yaWdpbmFsIE1lc3NhZ2UtLS0tLQ0KPiBGcm9tOiBDaGVuZyBYdSA8Y2hlbmd5b3VA
bGludXguYWxpYmFiYS5jb20+DQo+IFNlbnQ6IE1vbmRheSwgMTcgSmFudWFyeSAyMDIyIDA5OjQ4
DQo+IFRvOiBqZ2dAemllcGUuY2E7IGRsZWRmb3JkQHJlZGhhdC5jb20NCj4gQ2M6IGxlb25Aa2Vy
bmVsLm9yZzsgbGludXgtcmRtYUB2Z2VyLmtlcm5lbC5vcmc7DQo+IEthaVNoZW5AbGludXguYWxp
YmFiYS5jb207IGNoZW5neW91QGxpbnV4LmFsaWJhYmEuY29tOw0KPiB0b255bHVAbGludXguYWxp
YmFiYS5jb20NCj4gU3ViamVjdDogW0VYVEVSTkFMXSBbUEFUQ0ggcmRtYS1uZXh0IHYyIDA3LzEx
XSBSRE1BL2VyZG1hOiBBZGQgdmVyYnMNCj4gaW1wbGVtZW50YXRpb24NCj4gDQo+IFRoZSBSRE1B
IHZlcmJzIGltcGxlbWVudGF0aW9uIG9mIGVyZG1hIGlzIGRpdmlkZWQgaW50byB0aHJlZSBmaWxl
czoNCj4gZXJkbWFfcXAuYywgZXJkbWFfY3EuYywgYW5kIGVyZG1hX3ZlcmJzLmMuIEludGVybmFs
IHVzZWQgZnVuY3Rpb25zIGFuZA0KPiBkYXRhcGF0aCBmdW5jdGlvbnMgb2YgUVAvQ1EgYXJlIHB1
dCBpbiBlcmRtYV9xcC5jIGFuZCBlcmRtYV9jcS5jLCB0aGUNCj4gcmVzZXQNCj4gaXMgaW4gZXJk
bWFfdmVyYnMuYy4NCj4gDQo+IFNpZ25lZC1vZmYtYnk6IENoZW5nIFh1IDxjaGVuZ3lvdUBsaW51
eC5hbGliYWJhLmNvbT4NCj4gLS0tDQo+ICBkcml2ZXJzL2luZmluaWJhbmQvaHcvZXJkbWEvZXJk
bWFfY3EuYyAgICB8ICAxOTkgKysrDQo+ICBkcml2ZXJzL2luZmluaWJhbmQvaHcvZXJkbWEvZXJk
bWFfcXAuYyAgICB8ICA1NDcgKysrKysrKysNCj4gIGRyaXZlcnMvaW5maW5pYmFuZC9ody9lcmRt
YS9lcmRtYV92ZXJicy5jIHwgMTQwOSArKysrKysrKysrKysrKysrKysrKysNCj4gIDMgZmlsZXMg
Y2hhbmdlZCwgMjE1NSBpbnNlcnRpb25zKCspDQo+ICBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVy
cy9pbmZpbmliYW5kL2h3L2VyZG1hL2VyZG1hX2NxLmMNCj4gIGNyZWF0ZSBtb2RlIDEwMDY0NCBk
cml2ZXJzL2luZmluaWJhbmQvaHcvZXJkbWEvZXJkbWFfcXAuYw0KPiAgY3JlYXRlIG1vZGUgMTAw
NjQ0IGRyaXZlcnMvaW5maW5pYmFuZC9ody9lcmRtYS9lcmRtYV92ZXJicy5jDQo+IA0KPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9pbmZpbmliYW5kL2h3L2VyZG1hL2VyZG1hX2NxLmMNCj4gYi9kcml2
ZXJzL2luZmluaWJhbmQvaHcvZXJkbWEvZXJkbWFfY3EuYw0KPiBuZXcgZmlsZSBtb2RlIDEwMDY0
NA0KPiBpbmRleCAwMDAwMDAwMDAwMDAuLjlmMDI5ODc2MjFmNg0KPiAtLS0gL2Rldi9udWxsDQo+
ICsrKyBiL2RyaXZlcnMvaW5maW5pYmFuZC9ody9lcmRtYS9lcmRtYV9jcS5jDQo+IEBAIC0wLDAg
KzEsMTk5IEBADQo+ICsvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCBPUiBMaW51
eC1PcGVuSUINCj4gKw0KPiArLyogQXV0aG9yczogQ2hlbmcgWHUgPGNoZW5neW91QGxpbnV4LmFs
aWJhYmEuY29tPiAqLw0KPiArLyogICAgICAgICAgS2FpIFNoZW4gPGthaXNoZW5AbGludXguYWxp
YmFiYS5jb20+ICovDQo+ICsvKiBDb3B5cmlnaHQgKGMpIDIwMjAtMjAyMiwgQWxpYmFiYSBHcm91
cC4gKi8NCj4gKw0KPiArI2luY2x1ZGUgPHJkbWEvaWJfdmVyYnMuaD4NCj4gKw0KPiArI2luY2x1
ZGUgImVyZG1hX2h3LmgiDQo+ICsjaW5jbHVkZSAiZXJkbWFfdmVyYnMuaCINCj4gKw0KPiArc3Rh
dGljIGludCBlcmRtYV9jcV9ub3RlbXB0eShzdHJ1Y3QgZXJkbWFfY3EgKmNxKQ0KPiArew0KPiAr
CXN0cnVjdCBlcmRtYV9jcWUgKmNxZTsNCj4gKwl1bnNpZ25lZCBsb25nIGZsYWdzOw0KPiArCXUz
MiBoZHI7DQo+ICsNCj4gKwlzcGluX2xvY2tfaXJxc2F2ZSgmY3EtPmtlcm5fY3EubG9jaywgZmxh
Z3MpOw0KPiArDQo+ICsJY3FlID0gJmNxLT5rZXJuX2NxLnFidWZbY3EtPmtlcm5fY3EuY2kgJiAo
Y3EtPmRlcHRoIC0gMSldOw0KPiArCWhkciA9IGJlMzJfdG9fY3B1KFJFQURfT05DRShjcWUtPmhk
cikpOw0KPiArCWlmIChGSUVMRF9HRVQoRVJETUFfQ1FFX0hEUl9PV05FUl9NQVNLLCBoZHIpICE9
IGNxLT5rZXJuX2NxLm93bmVyKSB7DQo+ICsJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmNxLT5r
ZXJuX2NxLmxvY2ssIGZsYWdzKTsNCj4gKwkJcmV0dXJuIDA7DQo+ICsJfQ0KPiArDQo+ICsJc3Bp
bl91bmxvY2tfaXJxcmVzdG9yZSgmY3EtPmtlcm5fY3EubG9jaywgZmxhZ3MpOw0KPiArCXJldHVy
biAxOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgdm9pZCBub3RpZnlfY3Eoc3RydWN0IGVyZG1hX2Nx
ICpjcSwgdTggc29sY2l0aWVkKQ0KPiArew0KPiArCXU2NCBkYl9kYXRhID0gRklFTERfUFJFUChF
UkRNQV9DUURCX0VRTl9NQVNLLCBjcS0+YXNzb2NfZXFuKSB8DQo+ICsJCSAgICAgIEZJRUxEX1BS
RVAoRVJETUFfQ1FEQl9DUU5fTUFTSywgY3EtPmNxbikgfA0KPiArCQkgICAgICBGSUVMRF9QUkVQ
KEVSRE1BX0NRREJfQVJNX01BU0ssIDEpIHwNCj4gKwkJICAgICAgRklFTERfUFJFUChFUkRNQV9D
UURCX1NPTF9NQVNLLCBzb2xjaXRpZWQpIHwNCj4gKwkJICAgICAgRklFTERfUFJFUChFUkRNQV9D
UURCX0NNRFNOX01BU0ssIGNxLT5rZXJuX2NxLmNtZHNuKSB8DQo+ICsJCSAgICAgIEZJRUxEX1BS
RVAoRVJETUFfQ1FEQl9DSV9NQVNLLCBjcS0+a2Vybl9jcS5jaSk7DQo+ICsNCj4gKwkqKHU2NCAq
KWNxLT5rZXJuX2NxLmRiX2luZm8gPSBkYl9kYXRhOw0KPiArCXdyaXRlcShkYl9kYXRhLCBjcS0+
a2Vybl9jcS5kYik7DQo+ICt9DQo+ICsNCj4gK2ludCBlcmRtYV9yZXFfbm90aWZ5X2NxKHN0cnVj
dCBpYl9jcSAqaWJjcSwgZW51bSBpYl9jcV9ub3RpZnlfZmxhZ3MNCj4gZmxhZ3MpDQo+ICt7DQo+
ICsJc3RydWN0IGVyZG1hX2NxICpjcSA9IHRvX2VjcShpYmNxKTsNCj4gKwlpbnQgcmV0ID0gMDsN
Cj4gKw0KPiArCW5vdGlmeV9jcShjcSwgKGZsYWdzICYgSUJfQ1FfU09MSUNJVEVEX01BU0spID09
IElCX0NRX1NPTElDSVRFRCk7DQo+ICsNCj4gKwlpZiAoZmxhZ3MgJiBJQl9DUV9SRVBPUlRfTUlT
U0VEX0VWRU5UUykNCj4gKwkJcmV0ID0gZXJkbWFfY3Ffbm90ZW1wdHkoY3EpOw0KPiArDQo+ICsJ
cmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiArc3RhdGljIGNvbnN0IHN0cnVjdCB7DQo+ICsJZW51
bSBlcmRtYV9vcGNvZGUgZXJkbWE7DQo+ICsJZW51bSBpYl93Y19vcGNvZGUgYmFzZTsNCj4gK30g
bWFwX2NxZV9vcGNvZGVbRVJETUFfTlVNX09QQ09ERVNdID0gew0KPiArCXsgRVJETUFfT1BfV1JJ
VEUsIElCX1dDX1JETUFfV1JJVEUgfSwNCj4gKwl7IEVSRE1BX09QX1JFQUQsIElCX1dDX1JETUFf
UkVBRCB9LA0KPiArCXsgRVJETUFfT1BfU0VORCwgSUJfV0NfU0VORCB9LA0KPiArCXsgRVJETUFf
T1BfU0VORF9XSVRIX0lNTSwgSUJfV0NfU0VORCB9LA0KPiArCXsgRVJETUFfT1BfUkVDRUlWRSwg
SUJfV0NfUkVDViB9LA0KPiArCXsgRVJETUFfT1BfUkVDVl9JTU0sIElCX1dDX1JFQ1ZfUkRNQV9X
SVRIX0lNTSB9LA0KPiArCXsgRVJETUFfT1BfUkVDVl9JTlYsIElCX1dDX0xPQ0FMX0lOViB9LCAv
KiBjb25maXJtIGFmdGVyd2FyZHMgKi8NCj4gKwl7IEVSRE1BX09QX1JFUV9FUlIsIElCX1dDX1JF
Q1YgfSwgLyogcmVtb3ZlIGFmdGVyd2FyZHMgKi8NCj4gKwl7IEVSRE5BX09QX1JFQURfUkVTUE9O
U0UsIElCX1dDX1JFQ1YgfSwgLyogY2FuIG5vdCBhcHBlYXIgKi8NCj4gKwl7IEVSRE1BX09QX1dS
SVRFX1dJVEhfSU1NLCBJQl9XQ19SRE1BX1dSSVRFIH0sDQo+ICsJeyBFUkRNQV9PUF9SRUNWX0VS
UiwgSUJfV0NfUkVDVl9SRE1BX1dJVEhfSU1NIH0sIC8qIGNhbiBub3QgYXBwZWFyDQoNCkkgZG8g
bm90IHVuZGVyc3RhbmQgdGhlIGZvdXIgYWJvdmUgLyogY29tbWVudHMgKi8uDQpXaGF0IGRvZXMg
aXQgc2F5Pw0KPiAqLw0KPiArCXsgRVJETUFfT1BfSU5WQUxJREFURSwgSUJfV0NfTE9DQUxfSU5W
IH0sDQo+ICsJeyBFUkRNQV9PUF9SU1BfU0VORF9JTU0sIElCX1dDX1JFQ1YgfSwNCj4gKwl7IEVS
RE1BX09QX1NFTkRfV0lUSF9JTlYsIElCX1dDX1NFTkQgfSwNCj4gKwl7IEVSRE1BX09QX1JFR19N
UiwgSUJfV0NfUkVHX01SIH0sDQo+ICsJeyBFUkRNQV9PUF9MT0NBTF9JTlYsIElCX1dDX0xPQ0FM
X0lOViB9LA0KPiArCXsgRVJETUFfT1BfUkVBRF9XSVRIX0lOViwgSUJfV0NfUkRNQV9SRUFEIH0s
DQo+ICt9Ow0KPiArDQo+ICtzdGF0aWMgY29uc3Qgc3RydWN0IHsNCj4gKwllbnVtIGVyZG1hX3dj
X3N0YXR1cyBlcmRtYTsNCj4gKwllbnVtIGliX3djX3N0YXR1cyBiYXNlOw0KPiArCWVudW0gZXJk
bWFfdmVuZG9yX2VyciB2ZW5kb3I7DQo+ICt9IG1hcF9jcWVfc3RhdHVzW0VSRE1BX05VTV9XQ19T
VEFUVVNdID0gew0KPiArCXsgRVJETUFfV0NfU1VDQ0VTUywgSUJfV0NfU1VDQ0VTUywgRVJETUFf
V0NfVkVORE9SX05PX0VSUiB9LA0KPiArCXsgRVJETUFfV0NfR0VORVJBTF9FUlIsIElCX1dDX0dF
TkVSQUxfRVJSLCBFUkRNQV9XQ19WRU5ET1JfTk9fRVJSIH0sDQo+ICsJeyBFUkRNQV9XQ19SRUNW
X1dRRV9GT1JNQVRfRVJSLCBJQl9XQ19HRU5FUkFMX0VSUiwNCj4gRVJETUFfV0NfVkVORE9SX0lO
VkFMSURfUlFFIH0sDQo+ICsJeyBFUkRNQV9XQ19SRUNWX1NUQUdfSU5WQUxJRF9FUlIsIElCX1dD
X1JFTV9BQ0NFU1NfRVJSLA0KPiArCQlFUkRNQV9XQ19WRU5ET1JfUlFFX0lOVkFMSURfU1RBRyB9
LA0KPiArCXsgRVJETUFfV0NfUkVDVl9BRERSX1ZJT0xBVElPTl9FUlIsIElCX1dDX1JFTV9BQ0NF
U1NfRVJSLA0KPiArCQlFUkRNQV9XQ19WRU5ET1JfUlFFX0FERFJfVklPTEFUSU9OIH0sDQo+ICsJ
eyBFUkRNQV9XQ19SRUNWX1JJR0hUX1ZJT0xBVElPTl9FUlIsIElCX1dDX1JFTV9BQ0NFU1NfRVJS
LA0KPiArCQlFUkRNQV9XQ19WRU5ET1JfUlFFX0FDQ0VTU19SSUdIVF9FUlIgfSwNCj4gKwl7IEVS
RE1BX1dDX1JFQ1ZfUERJRF9FUlIsIElCX1dDX1JFTV9BQ0NFU1NfRVJSLA0KPiBFUkRNQV9XQ19W
RU5ET1JfUlFFX0lOVkFMSURfUEQgfSwNCj4gKwl7IEVSRE1BX1dDX1JFQ1ZfV0FSUlBJTkdfRVJS
LCBJQl9XQ19SRU1fQUNDRVNTX0VSUiwNCj4gRVJETUFfV0NfVkVORE9SX1JRRV9XUkFQX0VSUiB9
LA0KPiArCXsgRVJETUFfV0NfU0VORF9XUUVfRk9STUFUX0VSUiwgSUJfV0NfTE9DX1FQX09QX0VS
UiwNCj4gRVJETUFfV0NfVkVORE9SX0lOVkFMSURfU1FFIH0sDQo+ICsJeyBFUkRNQV9XQ19TRU5E
X1dRRV9PUkRfRVhDRUVELCBJQl9XQ19HRU5FUkFMX0VSUiwNCj4gRVJETUFfV0NfVkVORE9SX1pF
Uk9fT1JEIH0sDQo+ICsJeyBFUkRNQV9XQ19TRU5EX1NUQUdfSU5WQUxJRF9FUlIsIElCX1dDX0xP
Q19BQ0NFU1NfRVJSLA0KPiArCQlFUkRNQV9XQ19WRU5ET1JfU1FFX0lOVkFMSURfU1RBRyB9LA0K
PiArCXsgRVJETUFfV0NfU0VORF9BRERSX1ZJT0xBVElPTl9FUlIsIElCX1dDX0xPQ19BQ0NFU1Nf
RVJSLA0KPiArCQkJRVJETUFfV0NfVkVORE9SX1NRRV9BRERSX1ZJT0xBVElPTiB9LA0KPiArCXsg
RVJETUFfV0NfU0VORF9SSUdIVF9WSU9MQVRJT05fRVJSLCBJQl9XQ19MT0NfQUNDRVNTX0VSUiwN
Cj4gKwkJRVJETUFfV0NfVkVORE9SX1NRRV9BQ0NFU1NfRVJSIH0sDQo+ICsJeyBFUkRNQV9XQ19T
RU5EX1BESURfRVJSLCBJQl9XQ19MT0NfQUNDRVNTX0VSUiwNCj4gRVJETUFfV0NfVkVORE9SX1NR
RV9JTlZBTElEX1BEIH0sDQo+ICsJeyBFUkRNQV9XQ19TRU5EX1dBUlJQSU5HX0VSUiwgSUJfV0Nf
TE9DX0FDQ0VTU19FUlIsDQo+IEVSRE1BX1dDX1ZFTkRPUl9TUUVfV0FSUF9FUlIgfSwNCj4gKwl7
IEVSRE1BX1dDX0ZMVVNIX0VSUiwgSUJfV0NfV1JfRkxVU0hfRVJSLCBFUkRNQV9XQ19WRU5ET1Jf
Tk9fRVJSIH0sDQo+ICsJeyBFUkRNQV9XQ19SRVRSWV9FWENfRVJSLCBJQl9XQ19SRVRSWV9FWENf
RVJSLA0KPiBFUkRNQV9XQ19WRU5ET1JfTk9fRVJSIH0sDQo+ICt9Ow0KPiArDQo+ICtzdGF0aWMg
aW50IGVyZG1hX3BvbGxfb25lX2NxZShzdHJ1Y3QgZXJkbWFfY3EgKmNxLCBzdHJ1Y3QgZXJkbWFf
Y3FlICpjcWUsDQo+IHN0cnVjdCBpYl93YyAqd2MpDQo+ICt7DQo+ICsJc3RydWN0IGVyZG1hX2Rl
diAqZGV2ID0gdG9fZWRldihjcS0+aWJjcS5kZXZpY2UpOw0KPiArCXN0cnVjdCBlcmRtYV9xcCAq
cXA7DQo+ICsJc3RydWN0IGVyZG1hX2txcCAqa2Vybl9xcDsNCj4gKwl1NjQgKndxZV9oZHI7DQo+
ICsJdTY0ICppZF90YWJsZTsNCj4gKwl1MzIgcXBuID0gYmUzMl90b19jcHUoY3FlLT5xcG4pOw0K
PiArCXUxNiB3cWVfaWR4ID0gYmUzMl90b19jcHUoY3FlLT5xZV9pZHgpOw0KPiArCXUzMiBoZHIg
PSBiZTMyX3RvX2NwdShjcWUtPmhkcik7DQo+ICsJdTE2IGRlcHRoOw0KPiArCXU4IG9wY29kZSwg
c3luZHJvbWUsIHF0eXBlOw0KPiArDQo+ICsJcXAgPSBmaW5kX3FwX2J5X3FwbihkZXYsIHFwbik7
DQo+ICsJa2Vybl9xcCA9ICZxcC0+a2Vybl9xcDsNCj4gKw0KPiArCXF0eXBlID0gRklFTERfR0VU
KEVSRE1BX0NRRV9IRFJfUVRZUEVfTUFTSywgaGRyKTsNCj4gKwlzeW5kcm9tZSA9IEZJRUxEX0dF
VChFUkRNQV9DUUVfSERSX1NZTkRST01FX01BU0ssIGhkcik7DQo+ICsJb3Bjb2RlID0gRklFTERf
R0VUKEVSRE1BX0NRRV9IRFJfT1BDT0RFX01BU0ssIGhkcik7DQo+ICsNCj4gKwlpZiAocXR5cGUg
PT0gRVJETUFfQ1FFX1FUWVBFX1NRKSB7DQo+ICsJCWlkX3RhYmxlID0ga2Vybl9xcC0+c3dyX3Ri
bDsNCj4gKwkJZGVwdGggPSBxcC0+YXR0cnMuc3Ffc2l6ZTsNCj4gKwkJd3FlX2hkciA9ICh1NjQg
KilnZXRfc3FfZW50cnkocXAsIHdxZV9pZHgpOw0KPiArCQlrZXJuX3FwLT5zcV9jaSA9IHdxZV9p
ZHggKw0KPiBGSUVMRF9HRVQoRVJETUFfU1FFX0hEUl9XUUVCQl9DTlRfTUFTSywgKndxZV9oZHIp
ICsgMTsNCj4gKwl9IGVsc2Ugew0KPiArCQlpZF90YWJsZSA9IGtlcm5fcXAtPnJ3cl90Ymw7DQo+
ICsJCWRlcHRoID0gcXAtPmF0dHJzLnJxX3NpemU7DQo+ICsJfQ0KPiArCXdjLT53cl9pZCA9IGlk
X3RhYmxlW3dxZV9pZHggJiAoZGVwdGggLSAxKV07DQo+ICsJd2MtPmJ5dGVfbGVuID0gYmUzMl90
b19jcHUoY3FlLT5zaXplKTsNCj4gKw0KPiArCXdjLT53Y19mbGFncyA9IDA7DQo+ICsNCj4gKwl3
Yy0+b3Bjb2RlID0gbWFwX2NxZV9vcGNvZGVbb3Bjb2RlXS5iYXNlOw0KPiArCWlmICh3Yy0+b3Bj
b2RlID09IElCX1dDX1JFQ1ZfUkRNQV9XSVRIX0lNTSkgew0KPiArCQl3Yy0+ZXguaW1tX2RhdGEg
PSBiZTMyX3RvX2NwdShjcWUtPmltbV9kYXRhKTsNCj4gKwkJd2MtPndjX2ZsYWdzIHw9IElCX1dD
X1dJVEhfSU1NOw0KPiArCX0NCj4gKw0KPiArCWlmIChzeW5kcm9tZSA+PSBFUkRNQV9OVU1fV0Nf
U1RBVFVTKQ0KPiArCQlzeW5kcm9tZSA9IEVSRE1BX1dDX0dFTkVSQUxfRVJSOw0KPiArDQo+ICsJ
d2MtPnN0YXR1cyA9IG1hcF9jcWVfc3RhdHVzW3N5bmRyb21lXS5iYXNlOw0KPiArCXdjLT52ZW5k
b3JfZXJyID0gbWFwX2NxZV9zdGF0dXNbc3luZHJvbWVdLnZlbmRvcjsNCj4gKwl3Yy0+cXAgPSAm
cXAtPmlicXA7DQo+ICsNCj4gKwlyZXR1cm4gMDsNCj4gK30NCj4gKw0KPiAraW50IGVyZG1hX3Bv
bGxfY3Eoc3RydWN0IGliX2NxICppYmNxLCBpbnQgbnVtX2VudHJpZXMsIHN0cnVjdCBpYl93YyAq
d2MpDQo+ICt7DQo+ICsJc3RydWN0IGVyZG1hX2NxICpjcSA9IHRvX2VjcShpYmNxKTsNCj4gKwlz
dHJ1Y3QgZXJkbWFfY3FlICpjcWU7DQo+ICsJdW5zaWduZWQgbG9uZyBmbGFnczsNCj4gKwl1MzIg
b3duZXI7DQo+ICsJdTMyIGNpOw0KPiArCWludCBpLCByZXQ7DQo+ICsJaW50IG5ldyA9IDA7DQo+
ICsJdTMyIGhkcjsNCj4gKw0KPiArCXNwaW5fbG9ja19pcnFzYXZlKCZjcS0+a2Vybl9jcS5sb2Nr
LCBmbGFncyk7DQo+ICsNCj4gKwlvd25lciA9IGNxLT5rZXJuX2NxLm93bmVyOw0KPiArCWNpID0g
Y3EtPmtlcm5fY3EuY2k7DQo+ICsNCj4gKwlmb3IgKGkgPSAwOyBpIDwgbnVtX2VudHJpZXM7IGkr
Kykgew0KPiArCQljcWUgPSAmY3EtPmtlcm5fY3EucWJ1ZltjaSAmIChjcS0+ZGVwdGggLSAxKV07
DQo+ICsNCj4gKwkJaGRyID0gYmUzMl90b19jcHUoUkVBRF9PTkNFKGNxZS0+aGRyKSk7DQo+ICsJ
CWlmIChGSUVMRF9HRVQoRVJETUFfQ1FFX0hEUl9PV05FUl9NQVNLLCBoZHIpICE9IG93bmVyKQ0K
PiArCQkJYnJlYWs7DQo+ICsNCj4gKwkJLyogY3FidWYgc2hvdWxkIGJlIHJlYWR5IHdoZW4gd2Ug
cG9sbCovDQo+ICsJCWRtYV9ybWIoKTsNCj4gKwkJcmV0ID0gZXJkbWFfcG9sbF9vbmVfY3FlKGNx
LCBjcWUsIHdjKTsNCj4gKwkJY2krKzsNCj4gKwkJaWYgKChjaSAmIChjcS0+ZGVwdGggLSAxKSkg
PT0gMCkNCj4gKwkJCW93bmVyID0gIW93bmVyOw0KPiArCQlpZiAocmV0KQ0KPiArCQkJY29udGlu
dWU7DQo+ICsJCXdjKys7DQo+ICsJCW5ldysrOw0KPiArCX0NCj4gKwljcS0+a2Vybl9jcS5vd25l
ciA9IG93bmVyOw0KPiArCWNxLT5rZXJuX2NxLmNpID0gY2k7DQo+ICsNCj4gKwlzcGluX3VubG9j
a19pcnFyZXN0b3JlKCZjcS0+a2Vybl9jcS5sb2NrLCBmbGFncyk7DQo+ICsJcmV0dXJuIG5ldzsN
Cj4gK30NCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvaW5maW5pYmFuZC9ody9lcmRtYS9lcmRtYV9x
cC5jDQo+IGIvZHJpdmVycy9pbmZpbmliYW5kL2h3L2VyZG1hL2VyZG1hX3FwLmMNCj4gbmV3IGZp
bGUgbW9kZSAxMDA2NDQNCj4gaW5kZXggMDAwMDAwMDAwMDAwLi4wOWM2ZWUwNTY4ODYNCj4gLS0t
IC9kZXYvbnVsbA0KPiArKysgYi9kcml2ZXJzL2luZmluaWJhbmQvaHcvZXJkbWEvZXJkbWFfcXAu
Yw0KPiBAQCAtMCwwICsxLDU0NyBAQA0KPiArLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQ
TC0yLjAgb3IgQlNELTMtQ2xhdXNlDQo+ICsNCj4gKy8qIEF1dGhvcnM6IENoZW5nIFh1IDxjaGVu
Z3lvdUBsaW51eC5hbGliYWJhLmNvbT4gKi8NCj4gKy8qICAgICAgICAgIEthaSBTaGVuIDxrYWlz
aGVuQGxpbnV4LmFsaWJhYmEuY29tPiAqLw0KPiArLyogQ29weXJpZ2h0IChjKSAyMDIwLTIwMjEs
IEFsaWJhYmEgR3JvdXAgKi8NCj4gKy8qIEF1dGhvcnM6IEJlcm5hcmQgTWV0emxlciA8Ym10QHp1
cmljaC5pYm0uY29tPiAqLw0KPiArLyogQ29weXJpZ2h0IChjKSAyMDA4LTIwMTksIElCTSBDb3Jw
b3JhdGlvbiAqLw0KPiArDQo+ICsjaW5jbHVkZSA8bGludXgvZXJybm8uaD4NCj4gKyNpbmNsdWRl
IDxsaW51eC9wY2kuaD4NCj4gKyNpbmNsdWRlIDxsaW51eC9zY2F0dGVybGlzdC5oPg0KPiArI2lu
Y2x1ZGUgPGxpbnV4L3R5cGVzLmg+DQo+ICsNCj4gKyNpbmNsdWRlIDxyZG1hL2l3X2NtLmg+DQo+
ICsjaW5jbHVkZSA8cmRtYS9pYl91c2VyX3ZlcmJzLmg+DQo+ICsjaW5jbHVkZSA8cmRtYS9pYl92
ZXJicy5oPg0KPiArDQo+ICsjaW5jbHVkZSAiZXJkbWEuaCINCj4gKyNpbmNsdWRlICJlcmRtYV9j
bS5oIg0KPiArI2luY2x1ZGUgImVyZG1hX3ZlcmJzLmgiDQo+ICsNCj4gK3ZvaWQgZXJkbWFfcXBf
bGxwX2Nsb3NlKHN0cnVjdCBlcmRtYV9xcCAqcXApDQo+ICt7DQo+ICsJc3RydWN0IGVyZG1hX3Fw
X2F0dHJzIHFwX2F0dHJzOw0KPiArDQo+ICsJZG93bl93cml0ZSgmcXAtPnN0YXRlX2xvY2spOw0K
PiArDQo+ICsJc3dpdGNoIChxcC0+YXR0cnMuc3RhdGUpIHsNCj4gKwljYXNlIEVSRE1BX1FQX1NU
QVRFX1JUUzoNCj4gKwljYXNlIEVSRE1BX1FQX1NUQVRFX1JUUjoNCj4gKwljYXNlIEVSRE1BX1FQ
X1NUQVRFX0lETEU6DQo+ICsJY2FzZSBFUkRNQV9RUF9TVEFURV9URVJNSU5BVEU6DQo+ICsJCXFw
X2F0dHJzLnN0YXRlID0gRVJETUFfUVBfU1RBVEVfQ0xPU0lORzsNCj4gKwkJZXJkbWFfbW9kaWZ5
X3FwX2ludGVybmFsKHFwLCAmcXBfYXR0cnMsIEVSRE1BX1FQX0FUVFJfU1RBVEUpOw0KPiArCQli
cmVhazsNCj4gKwljYXNlIEVSRE1BX1FQX1NUQVRFX0NMT1NJTkc6DQo+ICsJCXFwLT5hdHRycy5z
dGF0ZSA9IEVSRE1BX1FQX1NUQVRFX0lETEU7DQo+ICsJCWJyZWFrOw0KPiArCWRlZmF1bHQ6DQo+
ICsJCWJyZWFrOw0KPiArCX0NCj4gKw0KPiArCWlmIChxcC0+Y2VwKSB7DQo+ICsJCWVyZG1hX2Nl
cF9wdXQocXAtPmNlcCk7DQo+ICsJCXFwLT5jZXAgPSBOVUxMOw0KPiArCX0NCj4gKw0KPiArCXVw
X3dyaXRlKCZxcC0+c3RhdGVfbG9jayk7DQo+ICt9DQo+ICsNCj4gK3N0cnVjdCBpYl9xcCAqZXJk
bWFfZ2V0X2licXAoc3RydWN0IGliX2RldmljZSAqaWJkZXYsIGludCBpZCkNCj4gK3sNCj4gKwlz
dHJ1Y3QgZXJkbWFfcXAgKnFwID0gZmluZF9xcF9ieV9xcG4odG9fZWRldihpYmRldiksIGlkKTsN
Cj4gKw0KPiArCWlmIChxcCkNCj4gKwkJcmV0dXJuICZxcC0+aWJxcDsNCj4gKw0KPiArCXJldHVy
biAoc3RydWN0IGliX3FwICopTlVMTDsNCj4gK30NCj4gKw0KPiArc3RhdGljIGludCBlcmRtYV9t
b2RpZnlfcXBfc3RhdGVfdG9fcnRzKHN0cnVjdCBlcmRtYV9xcCAqcXAsDQo+ICsJCQkJCXN0cnVj
dCBlcmRtYV9xcF9hdHRycyAqYXR0cnMsDQo+ICsJCQkJCWVudW0gZXJkbWFfcXBfYXR0cl9tYXNr
IG1hc2spDQo+ICt7DQo+ICsJaW50IHJldDsNCj4gKwlzdHJ1Y3QgZXJkbWFfZGV2ICpkZXYgPSBx
cC0+ZGV2Ow0KPiArCXN0cnVjdCBlcmRtYV9jbWRxX21vZGlmeV9xcF9yZXEgcmVxOw0KPiArCXN0
cnVjdCB0Y3Bfc29jayAqdHA7DQo+ICsJc3RydWN0IGVyZG1hX2NlcCAqY2VwID0gcXAtPmNlcDsN
Cj4gKwlzdHJ1Y3Qgc29ja2FkZHJfc3RvcmFnZSBsb2NhbF9hZGRyLCByZW1vdGVfYWRkcjsNCj4g
Kw0KPiArCWlmICghKG1hc2sgJiBFUkRNQV9RUF9BVFRSX0xMUF9IQU5ETEUpKQ0KPiArCQlyZXR1
cm4gLUVJTlZBTDsNCj4gKw0KPiArCWlmICghKG1hc2sgJiBFUkRNQV9RUF9BVFRSX01QQSkpDQo+
ICsJCXJldHVybiAtRUlOVkFMOw0KPiArDQo+ICsJcmV0ID0gZ2V0bmFtZV9sb2NhbChjZXAtPnNv
Y2ssICZsb2NhbF9hZGRyKTsNCj4gKwlpZiAocmV0IDwgMCkNCj4gKwkJcmV0dXJuIHJldDsNCj4g
Kw0KPiArCXJldCA9IGdldG5hbWVfcGVlcihjZXAtPnNvY2ssICZyZW1vdGVfYWRkcik7DQo+ICsJ
aWYgKHJldCA8IDApDQo+ICsJCXJldHVybiByZXQ7DQo+ICsNCj4gKwlxcC0+YXR0cnMuc3RhdGUg
PSBFUkRNQV9RUF9TVEFURV9SVFM7DQo+ICsNCj4gKwl0cCA9IHRjcF9zayhxcC0+Y2VwLT5zb2Nr
LT5zayk7DQo+ICsNCj4gKwlFUkRNQV9DTURRX0JVSUxEX1JFUV9IRFIoJnJlcSwgQ01EUV9TVUJN
T0RfUkRNQSwNCj4gQ01EUV9PUENPREVfTU9ESUZZX1FQKTsNCj4gKw0KPiArCXJlcS5jZmcwID0g
RklFTERfUFJFUChFUkRNQV9DTURfTU9ESUZZX1FQX1NUQVRFX01BU0ssIHFwLQ0KPiA+YXR0cnMu
c3RhdGUpIHwNCj4gKwkJICAgRklFTERfUFJFUChFUkRNQV9DTURfTU9ESUZZX1FQX0NDX01BU0ss
IHFwLT5jY19tZXRob2QpIHwNCj4gKwkJICAgRklFTERfUFJFUChFUkRNQV9DTURfTU9ESUZZX1FQ
X1FQTl9NQVNLLCBRUF9JRChxcCkpOw0KPiArDQo+ICsJcmVxLmNvb2tpZSA9IHFwLT5jZXAtPm1w
YS5leHRfZGF0YS5jb29raWU7DQo+ICsJcmVxLmRpcCA9IHRvX3NvY2thZGRyX2luKHJlbW90ZV9h
ZGRyKS5zaW5fYWRkci5zX2FkZHI7DQo+ICsJcmVxLnNpcCA9IHRvX3NvY2thZGRyX2luKGxvY2Fs
X2FkZHIpLnNpbl9hZGRyLnNfYWRkcjsNCj4gKwlyZXEuZHBvcnQgPSB0b19zb2NrYWRkcl9pbihy
ZW1vdGVfYWRkcikuc2luX3BvcnQ7DQo+ICsJcmVxLnNwb3J0ID0gdG9fc29ja2FkZHJfaW4obG9j
YWxfYWRkcikuc2luX3BvcnQ7DQo+ICsNCj4gKwlyZXEuc2VuZF9ueHQgPSB0cC0+c25kX254dDsN
Cj4gKwkgLyogcnN2ZCB0Y3Agc2VxIGZvciBtcGEtcnNwIGluIHNlcnZlci4gKi8NCj4gKwlpZiAo
cXAtPnFwX3R5cGUgPT0gRVJETUFfUVBfUEFTU0lWRSkNCj4gKwkJcmVxLnNlbmRfbnh0ICs9IE1Q
QV9ERUZBVUxUX0hEUl9MRU4gKyBxcC0+cHJpdmF0ZV9kYXRhX2xlbjsNCj4gKwlyZXEucmVjdl9u
eHQgPSB0cC0+cmN2X254dDsNCj4gKw0KPiArCXJldCA9IGVyZG1hX3Bvc3RfY21kX3dhaXQoZGV2
LT5jbWRxLCAodTY0ICopJnJlcSwgc2l6ZW9mKHJlcSksIE5VTEwsDQo+IE5VTEwpOw0KPiArCWlm
IChyZXQpIHsNCj4gKwkJZGV2X2VycihkZXYtPmRtYWRldiwgIkVSUk9SOiBlcnIgY29kZSA9ICVk
LCBjbWQgb2YgbW9kaWZ5IHFwDQo+IGZhaWxlZC5cbiIsIHJldCk7DQo+ICsJCXJldHVybiByZXQ7
DQo+ICsJfQ0KPiArDQo+ICsJcmV0dXJuIDA7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyBpbnQgZXJk
bWFfbW9kaWZ5X3FwX3N0YXRlX3RvX3N0b3Aoc3RydWN0IGVyZG1hX3FwICpxcCwgc3RydWN0DQo+
IGVyZG1hX3FwX2F0dHJzICphdHRycywNCj4gKwkJCQkJIGVudW0gZXJkbWFfcXBfYXR0cl9tYXNr
IG1hc2spDQo+ICt7DQo+ICsJaW50IHJldDsNCj4gKwlzdHJ1Y3QgZXJkbWFfZGV2ICpkZXYgPSBx
cC0+ZGV2Ow0KPiArCXN0cnVjdCBlcmRtYV9jbWRxX21vZGlmeV9xcF9yZXEgcmVxOw0KPiArDQo+
ICsJcXAtPmF0dHJzLnN0YXRlID0gYXR0cnMtPnN0YXRlOw0KPiArDQo+ICsJRVJETUFfQ01EUV9C
VUlMRF9SRVFfSERSKCZyZXEsIENNRFFfU1VCTU9EX1JETUEsDQo+IENNRFFfT1BDT0RFX01PRElG
WV9RUCk7DQo+ICsNCj4gKwlyZXEuY2ZnMCA9IEZJRUxEX1BSRVAoRVJETUFfQ01EX01PRElGWV9R
UF9TVEFURV9NQVNLLCBhdHRycy0+c3RhdGUpDQo+IHwNCj4gKwkJICAgRklFTERfUFJFUChFUkRN
QV9DTURfTU9ESUZZX1FQX1FQTl9NQVNLLCBRUF9JRChxcCkpOw0KPiArDQo+ICsJcmV0ID0gZXJk
bWFfcG9zdF9jbWRfd2FpdChkZXYtPmNtZHEsICh1NjQgKikmcmVxLCBzaXplb2YocmVxKSwgTlVM
TCwNCj4gTlVMTCk7DQo+ICsJaWYgKHJldCkgew0KPiArCQlkZXZfZXJyKGRldi0+ZG1hZGV2LCAi
RVJST1I6IGVyciBjb2RlID0gJWQsIGNtZCBvZiBtb2RpZnkgcXANCj4gZmFpbGVkLlxuIiwgcmV0
KTsNCj4gKwkJcmV0dXJuIHJldDsNCj4gKwl9DQo+ICsNCj4gKwlyZXR1cm4gMDsNCj4gK30NCj4g
Kw0KPiAraW50IGVyZG1hX21vZGlmeV9xcF9pbnRlcm5hbChzdHJ1Y3QgZXJkbWFfcXAgKnFwLCBz
dHJ1Y3QgZXJkbWFfcXBfYXR0cnMNCj4gKmF0dHJzLA0KPiArCQkJICAgICBlbnVtIGVyZG1hX3Fw
X2F0dHJfbWFzayBtYXNrKQ0KPiArew0KPiArCWludCBkcm9wX2Nvbm4gPSAwLCByZXQgPSAwOw0K
PiArDQo+ICsJaWYgKCFtYXNrKQ0KPiArCQlyZXR1cm4gMDsNCj4gKw0KPiArCWlmICghKG1hc2sg
JiBFUkRNQV9RUF9BVFRSX1NUQVRFKSkNCj4gKwkJcmV0dXJuIDA7DQo+ICsNCj4gKwlzd2l0Y2gg
KHFwLT5hdHRycy5zdGF0ZSkgew0KPiArCWNhc2UgRVJETUFfUVBfU1RBVEVfSURMRToNCj4gKwlj
YXNlIEVSRE1BX1FQX1NUQVRFX1JUUjoNCj4gKwkJaWYgKGF0dHJzLT5zdGF0ZSA9PSBFUkRNQV9R
UF9TVEFURV9SVFMpIHsNCj4gKwkJCXJldCA9IGVyZG1hX21vZGlmeV9xcF9zdGF0ZV90b19ydHMo
cXAsIGF0dHJzLCBtYXNrKTsNCj4gKwkJfSBlbHNlIGlmIChhdHRycy0+c3RhdGUgPT0gRVJETUFf
UVBfU1RBVEVfRVJST1IpIHsNCj4gKwkJCXFwLT5hdHRycy5zdGF0ZSA9IEVSRE1BX1FQX1NUQVRF
X0VSUk9SOw0KPiArCQkJaWYgKHFwLT5jZXApIHsNCj4gKwkJCQllcmRtYV9jZXBfcHV0KHFwLT5j
ZXApOw0KPiArCQkJCXFwLT5jZXAgPSBOVUxMOw0KPiArCQkJfQ0KPiArCQkJcmV0ID0gZXJkbWFf
bW9kaWZ5X3FwX3N0YXRlX3RvX3N0b3AocXAsIGF0dHJzLCBtYXNrKTsNCj4gKwkJfQ0KPiArCQli
cmVhazsNCj4gKwljYXNlIEVSRE1BX1FQX1NUQVRFX1JUUzoNCj4gKwkJaWYgKGF0dHJzLT5zdGF0
ZSA9PSBFUkRNQV9RUF9TVEFURV9DTE9TSU5HKSB7DQo+ICsJCQlyZXQgPSBlcmRtYV9tb2RpZnlf
cXBfc3RhdGVfdG9fc3RvcChxcCwgYXR0cnMsIG1hc2spOw0KPiArCQkJZHJvcF9jb25uID0gMTsN
Cj4gKwkJfSBlbHNlIGlmIChhdHRycy0+c3RhdGUgPT0gRVJETUFfUVBfU1RBVEVfVEVSTUlOQVRF
KSB7DQo+ICsJCQlxcC0+YXR0cnMuc3RhdGUgPSBFUkRNQV9RUF9TVEFURV9URVJNSU5BVEU7DQo+
ICsJCQlyZXQgPSBlcmRtYV9tb2RpZnlfcXBfc3RhdGVfdG9fc3RvcChxcCwgYXR0cnMsIG1hc2sp
Ow0KPiArCQkJZHJvcF9jb25uID0gMTsNCj4gKwkJfSBlbHNlIGlmIChhdHRycy0+c3RhdGUgPT0g
RVJETUFfUVBfU1RBVEVfRVJST1IpIHsNCj4gKwkJCXJldCA9IGVyZG1hX21vZGlmeV9xcF9zdGF0
ZV90b19zdG9wKHFwLCBhdHRycywgbWFzayk7DQo+ICsJCQlxcC0+YXR0cnMuc3RhdGUgPSBFUkRN
QV9RUF9TVEFURV9FUlJPUjsNCj4gKwkJCWRyb3BfY29ubiA9IDE7DQo+ICsJCX0NCj4gKwkJYnJl
YWs7DQo+ICsJY2FzZSBFUkRNQV9RUF9TVEFURV9URVJNSU5BVEU6DQo+ICsJCWlmIChhdHRycy0+
c3RhdGUgPT0gRVJETUFfUVBfU1RBVEVfRVJST1IpDQo+ICsJCQlxcC0+YXR0cnMuc3RhdGUgPSBF
UkRNQV9RUF9TVEFURV9FUlJPUjsNCj4gKwkJYnJlYWs7DQo+ICsJY2FzZSBFUkRNQV9RUF9TVEFU
RV9DTE9TSU5HOg0KPiArCQlpZiAoYXR0cnMtPnN0YXRlID09IEVSRE1BX1FQX1NUQVRFX0lETEUp
DQo+ICsJCQlxcC0+YXR0cnMuc3RhdGUgPSBFUkRNQV9RUF9TVEFURV9JRExFOw0KPiArCQllbHNl
IGlmIChhdHRycy0+c3RhdGUgPT0gRVJETUFfUVBfU1RBVEVfRVJST1IpIHsNCj4gKwkJCXJldCA9
IGVyZG1hX21vZGlmeV9xcF9zdGF0ZV90b19zdG9wKHFwLCBhdHRycywgbWFzayk7DQo+ICsJCQlx
cC0+YXR0cnMuc3RhdGUgPSBFUkRNQV9RUF9TVEFURV9FUlJPUjsNCj4gKwkJfSBlbHNlIGlmIChh
dHRycy0+c3RhdGUgIT0gRVJETUFfUVBfU1RBVEVfQ0xPU0lORykgew0KPiArCQkJcmV0dXJuIC1F
Q09OTkFCT1JURUQ7DQo+ICsJCX0NCj4gKwkJYnJlYWs7DQo+ICsJZGVmYXVsdDoNCj4gKwkJYnJl
YWs7DQo+ICsJfQ0KPiArDQo+ICsJaWYgKGRyb3BfY29ubikNCj4gKwkJZXJkbWFfcXBfY21fZHJv
cChxcCk7DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+ICtzdGF0aWMgdm9pZCBl
cmRtYV9xcF9zYWZlX2ZyZWUoc3RydWN0IGtyZWYgKnJlZikNCj4gK3sNCj4gKwlzdHJ1Y3QgZXJk
bWFfcXAgKnFwID0gY29udGFpbmVyX29mKHJlZiwgc3RydWN0IGVyZG1hX3FwLCByZWYpOw0KPiAr
DQo+ICsJY29tcGxldGUoJnFwLT5zYWZlX2ZyZWUpOw0KPiArfQ0KPiArDQo+ICt2b2lkIGVyZG1h
X3FwX3B1dChzdHJ1Y3QgZXJkbWFfcXAgKnFwKQ0KPiArew0KPiArCVdBUk5fT04oa3JlZl9yZWFk
KCZxcC0+cmVmKSA8IDEpOw0KPiArCWtyZWZfcHV0KCZxcC0+cmVmLCBlcmRtYV9xcF9zYWZlX2Zy
ZWUpOw0KPiArfQ0KPiArDQo+ICt2b2lkIGVyZG1hX3FwX2dldChzdHJ1Y3QgZXJkbWFfcXAgKnFw
KQ0KPiArew0KPiArCWtyZWZfZ2V0KCZxcC0+cmVmKTsNCj4gK30NCj4gKw0KPiArc3RhdGljIGlu
dCBmaWxsX2lubGluZV9kYXRhKHN0cnVjdCBlcmRtYV9xcCAqcXAsIGNvbnN0IHN0cnVjdCBpYl9z
ZW5kX3dyDQo+ICpzZW5kX3dyLA0KPiArCQkJICAgIHUxNiB3cWViYl9pZHgsIHUzMiBzZ2xfb2Zm
c2V0LCB1MzIgKmxlbmd0aF9maWVsZCkNCj4gK3sNCj4gKwlpbnQgaSA9IDA7DQo+ICsJY2hhciAq
ZGF0YTsNCj4gKwl1MzIgcmVtYWluX3NpemUsIGNvcHlfc2l6ZSwgZGF0YV9vZmYsIGJ5dGVzID0g
MDsNCj4gKw0KPiArCXdxZWJiX2lkeCArPSAoc2dsX29mZnNldCA+PiBTUUVCQl9TSElGVCk7DQo+
ICsJc2dsX29mZnNldCAmPSAoU1FFQkJfU0laRSAtIDEpOw0KPiArCWRhdGEgPSBnZXRfc3FfZW50
cnkocXAsIHdxZWJiX2lkeCk7DQo+ICsNCj4gKwl3aGlsZSAoaSA8IHNlbmRfd3ItPm51bV9zZ2Up
IHsNCj4gKwkJYnl0ZXMgKz0gc2VuZF93ci0+c2dfbGlzdFtpXS5sZW5ndGg7DQo+ICsJCWlmIChi
eXRlcyA+IChpbnQpRVJETUFfTUFYX0lOTElORSkNCj4gKwkJCXJldHVybiAtRUlOVkFMOw0KPiAr
DQo+ICsJCXJlbWFpbl9zaXplID0gc2VuZF93ci0+c2dfbGlzdFtpXS5sZW5ndGg7DQo+ICsJCWRh
dGFfb2ZmID0gMDsNCj4gKw0KPiArCQl3aGlsZSAoMSkgew0KPiArCQkJY29weV9zaXplID0gbWlu
KHJlbWFpbl9zaXplLCBTUUVCQl9TSVpFIC0gc2dsX29mZnNldCk7DQo+ICsNCj4gKwkJCW1lbWNw
eShkYXRhICsgc2dsX29mZnNldCwNCj4gKwkJCSAgICAgICAodm9pZCAqKSh1aW50cHRyX3Qpc2Vu
ZF93ci0+c2dfbGlzdFtpXS5hZGRyICsNCj4gZGF0YV9vZmYsDQo+ICsJCQkgICAgICAgY29weV9z
aXplKTsNCj4gKwkJCXJlbWFpbl9zaXplIC09IGNvcHlfc2l6ZTsNCj4gKwkJCWRhdGFfb2ZmICs9
IGNvcHlfc2l6ZTsNCj4gKwkJCXNnbF9vZmZzZXQgKz0gY29weV9zaXplOw0KPiArCQkJd3FlYmJf
aWR4ICs9IChzZ2xfb2Zmc2V0ID4+IFNRRUJCX1NISUZUKTsNCj4gKwkJCXNnbF9vZmZzZXQgJj0g
KFNRRUJCX1NJWkUgLSAxKTsNCj4gKw0KPiArCQkJZGF0YSA9IGdldF9zcV9lbnRyeShxcCwgd3Fl
YmJfaWR4KTsNCj4gKwkJCWlmICghcmVtYWluX3NpemUpDQo+ICsJCQkJYnJlYWs7DQo+ICsJCX07
DQo+ICsNCj4gKwkJaSsrOw0KPiArCX0NCj4gKwkqbGVuZ3RoX2ZpZWxkID0gYnl0ZXM7DQo+ICsN
Cj4gKwlyZXR1cm4gYnl0ZXM7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyBpbnQgZmlsbF9zZ2woc3Ry
dWN0IGVyZG1hX3FwICpxcCwgY29uc3Qgc3RydWN0IGliX3NlbmRfd3INCj4gKnNlbmRfd3IsDQo+
ICsJCSAgICB1MTYgd3FlYmJfaWR4LCB1MzIgc2dsX29mZnNldCwgdTMyICpsZW5ndGhfZmllbGQp
DQo+ICt7DQo+ICsJaW50IGkgPSAwOw0KPiArCXUzMiBieXRlcyA9IDA7DQo+ICsJY2hhciAqc2ds
Ow0KPiArDQo+ICsJaWYgKHNlbmRfd3ItPm51bV9zZ2UgPiBxcC0+ZGV2LT5hdHRycy5tYXhfc2Vu
ZF9zZ2UpDQo+ICsJCXJldHVybiAtRUlOVkFMOw0KPiArDQo+ICsJaWYgKHNnbF9vZmZzZXQgJiAw
eGYpIHsNCj4gKwkJaWJkZXZfd2FybigmcXAtPmRldi0+aWJkZXYsICJzZ2wgaW4gd3FlIG5vdCAx
NiBCeXRlDQo+IGFsaWduZWQuIik7DQo+ICsJCXJldHVybiAtRUlOVkFMOw0KPiArCX0NCj4gKw0K
PiArCXdoaWxlIChpIDwgc2VuZF93ci0+bnVtX3NnZSkgew0KPiArCQl3cWViYl9pZHggKz0gKHNn
bF9vZmZzZXQgPj4gU1FFQkJfU0hJRlQpOw0KPiArCQlzZ2xfb2Zmc2V0ICY9IChTUUVCQl9TSVpF
IC0gMSk7DQo+ICsJCXNnbCA9IGdldF9zcV9lbnRyeShxcCwgd3FlYmJfaWR4KTsNCj4gKw0KPiAr
CQlieXRlcyArPSBzZW5kX3dyLT5zZ19saXN0W2ldLmxlbmd0aDsNCj4gKwkJbWVtY3B5KHNnbCAr
IHNnbF9vZmZzZXQsICZzZW5kX3dyLT5zZ19saXN0W2ldLCBzaXplb2Yoc3RydWN0DQo+IGliX3Nn
ZSkpOw0KPiArDQo+ICsJCXNnbF9vZmZzZXQgKz0gc2l6ZW9mKHN0cnVjdCBpYl9zZ2UpOw0KPiAr
CQlpKys7DQo+ICsJfQ0KPiArDQo+ICsJKmxlbmd0aF9maWVsZCA9IGJ5dGVzOw0KPiArCXJldHVy
biAwOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgaW50IGVyZG1hX3B1c2hfb25lX3NxZShzdHJ1Y3Qg
ZXJkbWFfcXAgKnFwLCB1MTYgKnBpLA0KPiArCQkJICAgICAgY29uc3Qgc3RydWN0IGliX3NlbmRf
d3IgKnNlbmRfd3IpDQo+ICt7DQo+ICsJc3RydWN0IGVyZG1hX3dyaXRlX3NxZSAqd3JpdGVfc3Fl
Ow0KPiArCXN0cnVjdCBlcmRtYV9zZW5kX3NxZSAqc2VuZF9zcWU7DQo+ICsJc3RydWN0IGVyZG1h
X3JlYWRyZXFfc3FlICpyZWFkX3NxZTsNCj4gKwlzdHJ1Y3QgZXJkbWFfcmVnX21yX3NxZSAqcmVn
bXJfc2dlOw0KPiArCXN0cnVjdCBlcmRtYV9tciAqbXI7DQo+ICsJc3RydWN0IGliX3JkbWFfd3Ig
KnJkbWFfd3I7DQo+ICsJc3RydWN0IGliX3NnZSAqc2dlOw0KPiArCXUzMiB3cWVfc2l6ZSwgd3Fl
YmJfY250Ow0KPiArCWludCByZXQ7DQo+ICsJdTMyIGZsYWdzID0gc2VuZF93ci0+c2VuZF9mbGFn
czsNCj4gKwl1MzIgaWR4ID0gKnBpICYgKHFwLT5hdHRycy5zcV9zaXplIC0gMSk7DQo+ICsJdTY0
ICplbnRyeSA9ICh1NjQgKilnZXRfc3FfZW50cnkocXAsIGlkeCk7DQo+ICsJdTY0IHdxZV9oZHI7
DQo+ICsJdTMyICpsZW5ndGhfZmllbGQgPSBOVUxMOw0KPiArCXU2NCBzZ2xfb2Zmc2V0ID0gMDsN
Cj4gKwllbnVtIGliX3dyX29wY29kZSBvcCA9IHNlbmRfd3ItPm9wY29kZTsNCj4gKwl1NjQgKmlu
bGluZV9kYXRhOw0KPiArDQo+ICsJKmVudHJ5ID0gMDsNCj4gKwlxcC0+a2Vybl9xcC5zd3JfdGJs
W2lkeF0gPSBzZW5kX3dyLT53cl9pZDsNCj4gKw0KPiArCXdxZV9oZHIgPSBGSUVMRF9QUkVQKEVS
RE1BX1NRRV9IRFJfQ0VfTUFTSywNCj4gKwkJCSAgICAgKChmbGFncyAmIElCX1NFTkRfU0lHTkFM
RUQpIHx8IHFwLT5rZXJuX3FwLnNpZ19hbGwpDQo+ID8gMSA6IDApOw0KPiArCXdxZV9oZHIgfD0g
RklFTERfUFJFUChFUkRNQV9TUUVfSERSX1NFX01BU0ssIGZsYWdzICYNCj4gSUJfU0VORF9TT0xJ
Q0lURUQgPyAxIDogMCk7DQo+ICsJd3FlX2hkciB8PSBGSUVMRF9QUkVQKEVSRE1BX1NRRV9IRFJf
RkVOQ0VfTUFTSywgZmxhZ3MgJg0KPiBJQl9TRU5EX0ZFTkNFID8gMSA6IDApOw0KPiArCXdxZV9o
ZHIgfD0gRklFTERfUFJFUChFUkRNQV9TUUVfSERSX0lOTElORV9NQVNLLCBmbGFncyAmDQo+IElC
X1NFTkRfSU5MSU5FID8gMSA6IDApOw0KPiArCXdxZV9oZHIgfD0gRklFTERfUFJFUChFUkRNQV9T
UUVfSERSX1FQTl9NQVNLLCBRUF9JRChxcCkpOw0KPiArDQo+ICsJc3dpdGNoIChvcCkgew0KPiAr
CWNhc2UgSUJfV1JfUkRNQV9XUklURToNCj4gKwljYXNlIElCX1dSX1JETUFfV1JJVEVfV0lUSF9J
TU06DQo+ICsJCXdxZV9oZHIgfD0gRklFTERfUFJFUChFUkRNQV9TUUVfSERSX09QQ09ERV9NQVNL
LCBvcCA9PQ0KPiBJQl9XUl9SRE1BX1dSSVRFID8NCj4gKwkJCUVSRE1BX09QX1dSSVRFIDogRVJE
TUFfT1BfV1JJVEVfV0lUSF9JTU0pOw0KPiArCQlyZG1hX3dyID0gY29udGFpbmVyX29mKHNlbmRf
d3IsIHN0cnVjdCBpYl9yZG1hX3dyLCB3cik7DQo+ICsJCXdyaXRlX3NxZSA9IChzdHJ1Y3QgZXJk
bWFfd3JpdGVfc3FlICopZW50cnk7DQo+ICsNCj4gKwkJd3JpdGVfc3FlLT5pbW1fZGF0YSA9IHNl
bmRfd3ItPmV4LmltbV9kYXRhOw0KPiArCQl3cml0ZV9zcWUtPnNpbmtfc3RhZyA9IHJkbWFfd3It
PnJrZXk7DQo+ICsJCXdyaXRlX3NxZS0+c2lua190b19oaWdoID0gKHJkbWFfd3ItPnJlbW90ZV9h
ZGRyID4+IDMyKSAmDQo+IDB4RkZGRkZGRkY7DQo+ICsJCXdyaXRlX3NxZS0+c2lua190b19sb3cg
PSByZG1hX3dyLT5yZW1vdGVfYWRkciAmIDB4RkZGRkZGRkY7DQo+ICsNCj4gKwkJbGVuZ3RoX2Zp
ZWxkID0gJndyaXRlX3NxZS0+bGVuZ3RoOw0KPiArCQl3cWVfc2l6ZSA9IHNpemVvZihzdHJ1Y3Qg
ZXJkbWFfd3JpdGVfc3FlKTsNCj4gKwkJc2dsX29mZnNldCA9IHdxZV9zaXplOw0KPiArCQlicmVh
azsNCj4gKwljYXNlIElCX1dSX1JETUFfUkVBRDoNCj4gKwljYXNlIElCX1dSX1JETUFfUkVBRF9X
SVRIX0lOVjoNCj4gKwkJaWYgKHVubGlrZWx5KHNlbmRfd3ItPm51bV9zZ2UgIT0gMSkpDQo+ICsJ
CQlyZXR1cm4gLUVJTlZBTDsNCj4gKwkJd3FlX2hkciB8PSBGSUVMRF9QUkVQKEVSRE1BX1NRRV9I
RFJfT1BDT0RFX01BU0ssDQo+ICsJCQlvcCA9PSBJQl9XUl9SRE1BX1JFQUQgPyBFUkRNQV9PUF9S
RUFEIDoNCj4gRVJETUFfT1BfUkVBRF9XSVRIX0lOVik7DQo+ICsJCXJkbWFfd3IgPSBjb250YWlu
ZXJfb2Yoc2VuZF93ciwgc3RydWN0IGliX3JkbWFfd3IsIHdyKTsNCj4gKwkJcmVhZF9zcWUgPSAo
c3RydWN0IGVyZG1hX3JlYWRyZXFfc3FlICopZW50cnk7DQo+ICsJCWlmIChvcCA9PSBJQl9XUl9S
RE1BX1JFQURfV0lUSF9JTlYpDQo+ICsJCQlyZWFkX3NxZS0+aW52YWxpZF9zdGFnID0gc2VuZF93
ci0+ZXguaW52YWxpZGF0ZV9ya2V5Ow0KPiArDQo+ICsJCXJlYWRfc3FlLT5sZW5ndGggPSBzZW5k
X3dyLT5zZ19saXN0WzBdLmxlbmd0aDsNCj4gKwkJcmVhZF9zcWUtPnNpbmtfc3RhZyA9IHNlbmRf
d3ItPnNnX2xpc3RbMF0ubGtleTsNCj4gKwkJcmVhZF9zcWUtPnNpbmtfdG9fbG93ID0gKihfX3Uz
MiAqKSgmc2VuZF93ci0+c2dfbGlzdFswXS5hZGRyKTsNCj4gKwkJcmVhZF9zcWUtPnNpbmtfdG9f
aGlnaCA9ICooKF9fdTMyICopKCZzZW5kX3dyLQ0KPiA+c2dfbGlzdFswXS5hZGRyKSArIDEpOw0K
PiArDQo+ICsJCXNnZSA9IChzdHJ1Y3QgaWJfc2dlICopZ2V0X3NxX2VudHJ5KHFwLCBpZHggKyAx
KTsNCj4gKwkJc2dlLT5hZGRyID0gcmRtYV93ci0+cmVtb3RlX2FkZHI7DQo+ICsJCXNnZS0+bGtl
eSA9IHJkbWFfd3ItPnJrZXk7DQo+ICsJCXNnZS0+bGVuZ3RoID0gc2VuZF93ci0+c2dfbGlzdFsw
XS5sZW5ndGg7DQo+ICsJCXdxZV9zaXplID0gc2l6ZW9mKHN0cnVjdCBlcmRtYV9yZWFkcmVxX3Nx
ZSkgKyBzZW5kX3dyLT5udW1fc2dlDQo+ICogMTY7DQo+ICsNCj4gKwkJZ290byBvdXQ7DQo+ICsJ
Y2FzZSBJQl9XUl9TRU5EOg0KPiArCWNhc2UgSUJfV1JfU0VORF9XSVRIX0lNTToNCj4gKwljYXNl
IElCX1dSX1NFTkRfV0lUSF9JTlY6DQo+ICsJCXdxZV9oZHIgfD0gRklFTERfUFJFUChFUkRNQV9T
UUVfSERSX09QQ09ERV9NQVNLLA0KPiArCQkJb3AgPT0gSUJfV1JfU0VORCA/IEVSRE1BX09QX1NF
TkQgOiAob3AgPT0NCj4gSUJfV1JfU0VORF9XSVRIX0lNTSA/DQo+ICsJCQlFUkRNQV9PUF9TRU5E
X1dJVEhfSU1NIDogRVJETUFfT1BfU0VORF9XSVRIX0lOVikpOw0KPiArCQlzZW5kX3NxZSA9IChz
dHJ1Y3QgZXJkbWFfc2VuZF9zcWUgKillbnRyeTsNCj4gKwkJaWYgKG9wID09IElCX1dSX1NFTkRf
V0lUSF9JTlYpDQo+ICsJCQlzZW5kX3NxZS0+aW1tX2RhdGEgPSBzZW5kX3dyLT5leC5pbnZhbGlk
YXRlX3JrZXk7DQo+ICsJCWVsc2UNCj4gKwkJCXNlbmRfc3FlLT5pbW1fZGF0YSA9IHNlbmRfd3It
PmV4LmltbV9kYXRhOw0KPiArDQo+ICsJCWxlbmd0aF9maWVsZCA9ICZzZW5kX3NxZS0+bGVuZ3Ro
Ow0KPiArCQl3cWVfc2l6ZSA9IHNpemVvZihzdHJ1Y3QgZXJkbWFfc2VuZF9zcWUpOw0KPiArCQlz
Z2xfb2Zmc2V0ID0gd3FlX3NpemU7DQo+ICsNCj4gKwkJYnJlYWs7DQo+ICsJY2FzZSBJQl9XUl9S
RUdfTVI6DQo+ICsJCXdxZV9oZHIgfD0gRklFTERfUFJFUChFUkRNQV9TUUVfSERSX09QQ09ERV9N
QVNLLA0KPiBFUkRNQV9PUF9SRUdfTVIpOw0KPiArCQlyZWdtcl9zZ2UgPSAoc3RydWN0IGVyZG1h
X3JlZ19tcl9zcWUgKillbnRyeTsNCj4gKwkJbXIgPSB0b19lbXIocmVnX3dyKHNlbmRfd3IpLT5t
cik7DQo+ICsNCj4gKwkJbXItPmFjY2VzcyA9IEVSRE1BX01SX0FDQ19MUiB8DQo+ICsJCQkocmVn
X3dyKHNlbmRfd3IpLT5hY2Nlc3MgJiBJQl9BQ0NFU1NfUkVNT1RFX1JFQUQgID8NCj4gRVJETUFf
TVJfQUNDX1JSIDogMCkgfA0KPiArCQkJKHJlZ193cihzZW5kX3dyKS0+YWNjZXNzICYgSUJfQUND
RVNTX0xPQ0FMX1dSSVRFICA/DQo+IEVSRE1BX01SX0FDQ19MVyA6IDApIHwNCj4gKwkJCShyZWdf
d3Ioc2VuZF93ciktPmFjY2VzcyAmIElCX0FDQ0VTU19SRU1PVEVfV1JJVEUgPw0KPiBFUkRNQV9N
Ul9BQ0NfUlcgOiAwKTsNCj4gKwkJcmVnbXJfc2dlLT5hZGRyID0gbXItPmlibXIuaW92YTsNCj4g
KwkJcmVnbXJfc2dlLT5sZW5ndGggPSBtci0+aWJtci5sZW5ndGg7DQo+ICsJCXJlZ21yX3NnZS0+
c3RhZyA9IG1yLT5pYm1yLmxrZXk7DQo+ICsJCXJlZ21yX3NnZS0+YXR0cnMgfD0gRklFTERfUFJF
UChFUkRNQV9TUUVfTVJfQUNDRVNTX01PREVfTUFTSywNCj4gMCk7DQo+ICsJCXJlZ21yX3NnZS0+
YXR0cnMgfD0gRklFTERfUFJFUChFUkRNQV9TUUVfTVJfQUNDRVNTX1JJR0hUX01BU0ssDQo+IG1y
LT5hY2Nlc3MpOw0KPiArCQlyZWdtcl9zZ2UtPmF0dHJzIHw9IEZJRUxEX1BSRVAoRVJETUFfU1FF
X01SX01UVF9DT1VOVF9NQVNLLA0KPiBtci0+bWVtLm10dF9uZW50cyk7DQo+ICsNCj4gKwkJaWYg
KG1yLT5tZW0ubXR0X25lbnRzIDwgNCkgew0KPiArCQkJcmVnbXJfc2dlLT5hdHRycyB8PQ0KPiBG
SUVMRF9QUkVQKEVSRE1BX1NRRV9NUl9NVFRfVFlQRV9NQVNLLCAwKTsNCj4gKwkJCWlubGluZV9k
YXRhID0gKHU2NCAqKWdldF9zcV9lbnRyeShxcCwgaWR4ICsgMSk7DQo+ICsJCQltZW1jcHkoaW5s
aW5lX2RhdGEsIG1yLT5tZW0ubXR0X2J1ZiwgbXItPm1lbS5tdHRfbmVudHMgKg0KPiA4KTsNCj4g
KwkJCXdxZV9zaXplID0gc2l6ZW9mKHN0cnVjdCBlcmRtYV9yZWdfbXJfc3FlKSArIG1yLQ0KPiA+
bWVtLm10dF9uZW50cyAqIDg7DQo+ICsJCX0gZWxzZSB7DQo+ICsJCQlyZWdtcl9zZ2UtPmF0dHJz
IHw9DQo+IEZJRUxEX1BSRVAoRVJETUFfU1FFX01SX01UVF9UWVBFX01BU0ssIDEpOw0KPiArCQkJ
d3FlX3NpemUgPSBzaXplb2Yoc3RydWN0IGVyZG1hX3JlZ19tcl9zcWUpOw0KPiArCQl9DQo+ICsN
Cj4gKwkJZ290byBvdXQ7DQo+ICsJY2FzZSBJQl9XUl9MT0NBTF9JTlY6DQo+ICsJCXdxZV9oZHIg
fD0gRklFTERfUFJFUChFUkRNQV9TUUVfSERSX09QQ09ERV9NQVNLLA0KPiBFUkRNQV9PUF9MT0NB
TF9JTlYpOw0KPiArCQlyZWdtcl9zZ2UgPSAoc3RydWN0IGVyZG1hX3JlZ19tcl9zcWUgKillbnRy
eTsNCj4gKwkJcmVnbXJfc2dlLT5zdGFnID0gc2VuZF93ci0+ZXguaW52YWxpZGF0ZV9ya2V5Ow0K
PiArCQl3cWVfc2l6ZSA9IHNpemVvZihzdHJ1Y3QgZXJkbWFfcmVnX21yX3NxZSk7DQo+ICsJCWdv
dG8gb3V0Ow0KPiArCWRlZmF1bHQ6DQo+ICsJCXJldHVybiAtRU9QTk9UU1VQUDsNCj4gKwl9DQo+
ICsNCj4gKwlpZiAoZmxhZ3MgJiBJQl9TRU5EX0lOTElORSkgew0KPiArCQlyZXQgPSBmaWxsX2lu
bGluZV9kYXRhKHFwLCBzZW5kX3dyLCBpZHgsIHNnbF9vZmZzZXQsDQo+IGxlbmd0aF9maWVsZCk7
DQo+ICsJCWlmIChyZXQgPCAwKQ0KPiArCQkJcmV0dXJuIC1FSU5WQUw7DQo+ICsJCXdxZV9zaXpl
ICs9IHJldDsNCj4gKwkJd3FlX2hkciB8PSBGSUVMRF9QUkVQKEVSRE1BX1NRRV9IRFJfU0dMX0xF
Tl9NQVNLLCByZXQpOw0KPiArCX0gZWxzZSB7DQo+ICsJCXJldCA9IGZpbGxfc2dsKHFwLCBzZW5k
X3dyLCBpZHgsIHNnbF9vZmZzZXQsIGxlbmd0aF9maWVsZCk7DQo+ICsJCWlmIChyZXQpDQo+ICsJ
CQlyZXR1cm4gLUVJTlZBTDsNCj4gKwkJd3FlX3NpemUgKz0gc2VuZF93ci0+bnVtX3NnZSAqIHNp
emVvZihzdHJ1Y3QgaWJfc2dlKTsNCj4gKwkJd3FlX2hkciB8PSBGSUVMRF9QUkVQKEVSRE1BX1NR
RV9IRFJfU0dMX0xFTl9NQVNLLCBzZW5kX3dyLQ0KPiA+bnVtX3NnZSk7DQo+ICsJfQ0KPiArDQo+
ICtvdXQ6DQo+ICsJd3FlYmJfY250ID0gU1FFQkJfQ09VTlQod3FlX3NpemUpOw0KPiArCXdxZV9o
ZHIgfD0gRklFTERfUFJFUChFUkRNQV9TUUVfSERSX1dRRUJCX0NOVF9NQVNLLCB3cWViYl9jbnQg
LSAxKTsNCj4gKwkqcGkgKz0gd3FlYmJfY250Ow0KPiArCXdxZV9oZHIgfD0gRklFTERfUFJFUChF
UkRNQV9TUUVfSERSX1dRRUJCX0lOREVYX01BU0ssICpwaSk7DQo+ICsNCj4gKwkqZW50cnkgPSB3
cWVfaGRyOw0KPiArDQo+ICsJcmV0dXJuIDA7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyB2b2lkIGtp
Y2tfc3FfZGIoc3RydWN0IGVyZG1hX3FwICpxcCwgdTE2IHBpKQ0KPiArew0KPiArCXU2NCBkYl9k
YXRhID0gRklFTERfUFJFUChFUkRNQV9TUUVfSERSX1FQTl9NQVNLLCBRUF9JRChxcCkpIHwNCj4g
KwkJICAgICAgRklFTERfUFJFUChFUkRNQV9TUUVfSERSX1dRRUJCX0lOREVYX01BU0ssIHBpKTsN
Cj4gKw0KPiArCSoodTY0ICopcXAtPmtlcm5fcXAuc3FfZGJfaW5mbyA9IGRiX2RhdGE7DQo+ICsJ
d3JpdGVxKGRiX2RhdGEsIHFwLT5rZXJuX3FwLmh3X3NxX2RiKTsNCj4gK30NCj4gKw0KPiAraW50
IGVyZG1hX3Bvc3Rfc2VuZChzdHJ1Y3QgaWJfcXAgKmlicXAsIGNvbnN0IHN0cnVjdCBpYl9zZW5k
X3dyICpzZW5kX3dyLA0KPiArCQkgICAgY29uc3Qgc3RydWN0IGliX3NlbmRfd3IgKipiYWRfc2Vu
ZF93cikNCj4gK3sNCj4gKwlzdHJ1Y3QgZXJkbWFfcXAgKnFwID0gdG9fZXFwKGlicXApOw0KPiAr
CWludCByZXQgPSAwOw0KPiArCWNvbnN0IHN0cnVjdCBpYl9zZW5kX3dyICp3ciA9IHNlbmRfd3I7
DQo+ICsJdW5zaWduZWQgbG9uZyBmbGFnczsNCj4gKwl1MTYgc3FfcGk7DQo+ICsNCj4gKwlpZiAo
IXNlbmRfd3IpDQo+ICsJCXJldHVybiAtRUlOVkFMOw0KPiArDQo+ICsJc3Bpbl9sb2NrX2lycXNh
dmUoJnFwLT5sb2NrLCBmbGFncyk7DQo+ICsJc3FfcGkgPSBxcC0+a2Vybl9xcC5zcV9waTsNCj4g
Kw0KPiArCXdoaWxlICh3cikgew0KPiArCQlpZiAoKHUxNikoc3FfcGkgLSBxcC0+a2Vybl9xcC5z
cV9jaSkgPj0gcXAtPmF0dHJzLnNxX3NpemUpIHsNCj4gKwkJCXJldCA9IC1FTk9NRU07DQo+ICsJ
CQkqYmFkX3NlbmRfd3IgPSBzZW5kX3dyOw0KPiArCQkJYnJlYWs7DQo+ICsJCX0NCj4gKw0KPiAr
CQlyZXQgPSBlcmRtYV9wdXNoX29uZV9zcWUocXAsICZzcV9waSwgd3IpOw0KPiArCQlpZiAocmV0
KSB7DQo+ICsJCQkqYmFkX3NlbmRfd3IgPSB3cjsNCj4gKwkJCWJyZWFrOw0KPiArCQl9DQo+ICsJ
CXFwLT5rZXJuX3FwLnNxX3BpID0gc3FfcGk7DQo+ICsJCWtpY2tfc3FfZGIocXAsIHNxX3BpKTsN
Cj4gKw0KPiArCQl3ciA9IHdyLT5uZXh0Ow0KPiArCX0NCj4gKwlzcGluX3VubG9ja19pcnFyZXN0
b3JlKCZxcC0+bG9jaywgZmxhZ3MpOw0KPiArDQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0K
PiArc3RhdGljIGludCBlcmRtYV9wb3N0X3JlY3Zfb25lKHN0cnVjdCBpYl9xcCAqaWJxcCwgY29u
c3Qgc3RydWN0DQo+IGliX3JlY3Zfd3IgKnJlY3Zfd3IsDQo+ICsJCQkgICAgICAgY29uc3Qgc3Ry
dWN0IGliX3JlY3Zfd3IgKipiYWRfcmVjdl93cikNCj4gK3sNCj4gKwlzdHJ1Y3QgZXJkbWFfcXAg
KnFwID0gdG9fZXFwKGlicXApOw0KPiArCXN0cnVjdCBlcmRtYV9ycWUgKnJxZTsNCj4gKwl1bnNp
Z25lZCBpbnQgcnFfcGk7DQo+ICsJdTE2IGlkeDsNCj4gKw0KPiArCXJxX3BpID0gcXAtPmtlcm5f
cXAucnFfcGk7DQo+ICsJaWR4ID0gcnFfcGkgJiAocXAtPmF0dHJzLnJxX3NpemUgLSAxKTsNCj4g
KwlycWUgPSAoc3RydWN0IGVyZG1hX3JxZSAqKXFwLT5rZXJuX3FwLnJxX2J1ZiArIGlkeDsNCj4g
Kw0KPiArCXJxZS0+cWVfaWR4ID0gcnFfcGkgKyAxOw0KPiArCXJxZS0+cXBuID0gUVBfSUQocXAp
Ow0KPiArDQo+ICsJaWYgKHJlY3Zfd3ItPm51bV9zZ2UgPT0gMCkgew0KPiArCQlycWUtPmxlbmd0
aCA9IDA7DQo+ICsJfSBlbHNlIGlmIChyZWN2X3dyLT5udW1fc2dlID09IDEpIHsNCj4gKwkJcnFl
LT5zdGFnID0gcmVjdl93ci0+c2dfbGlzdFswXS5sa2V5Ow0KPiArCQlycWUtPnRvID0gcmVjdl93
ci0+c2dfbGlzdFswXS5hZGRyOw0KPiArCQlycWUtPmxlbmd0aCA9IHJlY3Zfd3ItPnNnX2xpc3Rb
MF0ubGVuZ3RoOw0KPiArCX0gZWxzZSB7DQo+ICsJCXJldHVybiAtRUlOVkFMOw0KPiArCX0NCj4g
Kw0KPiArCSoodTY0ICopcXAtPmtlcm5fcXAucnFfZGJfaW5mbyA9ICoodTY0ICopcnFlOw0KPiAr
CXdyaXRlcSgqKHU2NCAqKXJxZSwgcXAtPmtlcm5fcXAuaHdfcnFfZGIpOw0KPiArDQo+ICsJcXAt
Pmtlcm5fcXAucndyX3RibFtpZHhdID0gcmVjdl93ci0+d3JfaWQ7DQo+ICsJcXAtPmtlcm5fcXAu
cnFfcGkgPSBycV9waSArIDE7DQo+ICsNCj4gKwlyZXR1cm4gMDsNCj4gK30NCj4gKw0KPiAraW50
IGVyZG1hX3Bvc3RfcmVjdihzdHJ1Y3QgaWJfcXAgKnFwLCBjb25zdCBzdHJ1Y3QgaWJfcmVjdl93
ciAqcmVjdl93ciwNCj4gKwkJICAgIGNvbnN0IHN0cnVjdCBpYl9yZWN2X3dyICoqYmFkX3JlY3Zf
d3IpDQo+ICt7DQo+ICsJc3RydWN0IGVyZG1hX3FwICplcXAgPSB0b19lcXAocXApOw0KPiArCWlu
dCByZXQgPSAwOw0KPiArCWNvbnN0IHN0cnVjdCBpYl9yZWN2X3dyICp3ciA9IHJlY3Zfd3I7DQo+
ICsJdW5zaWduZWQgbG9uZyBmbGFnczsNCj4gKw0KPiArCWlmICghcXAgfHwgIXJlY3Zfd3IpDQo+
ICsJCXJldHVybiAtRUlOVkFMOw0KPiArDQo+ICsJc3Bpbl9sb2NrX2lycXNhdmUoJmVxcC0+bG9j
aywgZmxhZ3MpOw0KPiArCXdoaWxlICh3cikgew0KPiArCQlyZXQgPSBlcmRtYV9wb3N0X3JlY3Zf
b25lKHFwLCB3ciwgYmFkX3JlY3Zfd3IpOw0KPiArCQlpZiAocmV0KSB7DQo+ICsJCQkqYmFkX3Jl
Y3Zfd3IgPSB3cjsNCj4gKwkJCWJyZWFrOw0KPiArCQl9DQo+ICsJCXdyID0gd3ItPm5leHQ7DQo+
ICsJfQ0KPiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmVxcC0+bG9jaywgZmxhZ3MpOw0KPiAr
CXJldHVybiByZXQ7DQo+ICt9DQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2luZmluaWJhbmQvaHcv
ZXJkbWEvZXJkbWFfdmVyYnMuYw0KPiBiL2RyaXZlcnMvaW5maW5pYmFuZC9ody9lcmRtYS9lcmRt
YV92ZXJicy5jDQo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0DQo+IGluZGV4IDAwMDAwMDAwMDAwMC4u
ZWQzMDUwNTg1YjI1DQo+IC0tLSAvZGV2L251bGwNCj4gKysrIGIvZHJpdmVycy9pbmZpbmliYW5k
L2h3L2VyZG1hL2VyZG1hX3ZlcmJzLmMNCj4gQEAgLTAsMCArMSwxNDA5IEBADQo+ICsvLyBTUERY
LUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMA0KPiArDQo+ICsvKiBBdXRob3JzOiBDaGVuZyBY
dSA8Y2hlbmd5b3VAbGludXguYWxpYmFiYS5jb20+ICovDQo+ICsvKiAgICAgICAgICBLYWkgU2hl
biA8a2Fpc2hlbkBsaW51eC5hbGliYWJhLmNvbT4gKi8NCj4gKy8qIENvcHlyaWdodCAoYykgMjAy
MC0yMDIyLCBBbGliYWJhIEdyb3VwLiAqLw0KPiArDQo+ICsvKiBBdXRob3JzOiBCZXJuYXJkIE1l
dHpsZXIgPGJtdEB6dXJpY2guaWJtLmNvbT4gKi8NCj4gKy8qIENvcHlyaWdodCAoYykgMjAwOC0y
MDE5LCBJQk0gQ29ycG9yYXRpb24gKi8NCj4gKw0KPiArLyogQ29weXJpZ2h0IChjKSAyMDEzLTIw
MTUsIE1lbGxhbm94IFRlY2hub2xvZ2llcy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4NCj4gKi8NCj4g
Kw0KPiArI2luY2x1ZGUgPGxpbnV4L2Vycm5vLmg+DQo+ICsjaW5jbHVkZSA8bGludXgvcGNpLmg+
DQo+ICsjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4NCj4gKyNpbmNsdWRlIDxsaW51eC91YWNjZXNz
Lmg+DQo+ICsjaW5jbHVkZSA8bGludXgvdm1hbGxvYy5oPg0KPiArI2luY2x1ZGUgPG5ldC9hZGRy
Y29uZi5oPg0KPiArI2luY2x1ZGUgPHJkbWEvZXJkbWEtYWJpLmg+DQo+ICsjaW5jbHVkZSA8cmRt
YS9pd19jbS5oPg0KPiArI2luY2x1ZGUgPHJkbWEvaWJfdmVyYnMuaD4NCj4gKyNpbmNsdWRlIDxy
ZG1hL2liX3NtaS5oPg0KPiArI2luY2x1ZGUgPHJkbWEvaWJfdW1lbS5oPg0KPiArI2luY2x1ZGUg
PHJkbWEvaWJfdXNlcl92ZXJicy5oPg0KPiArI2luY2x1ZGUgPHJkbWEvdXZlcmJzX2lvY3RsLmg+
DQo+ICsNCj4gKyNpbmNsdWRlICJlcmRtYS5oIg0KPiArI2luY2x1ZGUgImVyZG1hX2NtLmgiDQo+
ICsjaW5jbHVkZSAiZXJkbWFfaHcuaCINCj4gKyNpbmNsdWRlICJlcmRtYV92ZXJicy5oIg0KPiAr
DQo+ICtzdGF0aWMgaW50IGNyZWF0ZV9xcF9jbWQoc3RydWN0IGVyZG1hX2RldiAqZGV2LCBzdHJ1
Y3QgZXJkbWFfcXAgKnFwKQ0KPiArew0KPiArCXN0cnVjdCBlcmRtYV9jbWRxX2NyZWF0ZV9xcF9y
ZXEgcmVxOw0KPiArCXN0cnVjdCBlcmRtYV9wZCAqcGQgPSB0b19lcGQocXAtPmlicXAucGQpOw0K
PiArCXN0cnVjdCBlcmRtYV91cXAgKnVzZXJfcXA7DQo+ICsJaW50IGVycjsNCj4gKw0KPiArCUVS
RE1BX0NNRFFfQlVJTERfUkVRX0hEUigmcmVxLCBDTURRX1NVQk1PRF9SRE1BLA0KPiBDTURRX09Q
Q09ERV9DUkVBVEVfUVApOw0KPiArDQo+ICsJcmVxLmNmZzAgPSBGSUVMRF9QUkVQKEVSRE1BX0NN
RF9DUkVBVEVfUVBfU1FfREVQVEhfTUFTSywgaWxvZzIocXAtDQo+ID5hdHRycy5zcV9zaXplKSkg
fA0KPiArCQkgICBGSUVMRF9QUkVQKEVSRE1BX0NNRF9DUkVBVEVfUVBfUVBOX01BU0ssIFFQX0lE
KHFwKSk7DQo+ICsJcmVxLmNmZzEgPSBGSUVMRF9QUkVQKEVSRE1BX0NNRF9DUkVBVEVfUVBfUlFf
REVQVEhfTUFTSywgaWxvZzIocXAtDQo+ID5hdHRycy5ycV9zaXplKSkgfA0KPiArCQkgICBGSUVM
RF9QUkVQKEVSRE1BX0NNRF9DUkVBVEVfUVBfUERfTUFTSywgcGQtPnBkbik7DQo+ICsNCj4gKwlp
ZiAocXAtPmlzX2tlcm5lbF9xcCkgew0KDQp1c2UgcmRtYV9pc19rZXJuZWxfcmVzKCZxcC0+aWJx
cC5yZXMpDQoNCj4gKwkJdTMyIHBnc3pfcmFuZ2UgPSBpbG9nMihTWl8xTSkgLSBQQUdFX1NISUZU
Ow0KPiArDQo+ICsJCXJlcS5zcV9jcW5fbXR0X2NmZyA9DQo+IEZJRUxEX1BSRVAoRVJETUFfQ01E
X0NSRUFURV9RUF9QQUdFX1NJWkVfTUFTSywgcGdzel9yYW5nZSkgfA0KPiArCQkJCSAgICAgRklF
TERfUFJFUChFUkRNQV9DTURfQ1JFQVRFX1FQX0NRTl9NQVNLLCBxcC0NCj4gPnNjcS0+Y3FuKTsN
Cj4gKwkJcmVxLnJxX2Nxbl9tdHRfY2ZnID0NCj4gRklFTERfUFJFUChFUkRNQV9DTURfQ1JFQVRF
X1FQX1BBR0VfU0laRV9NQVNLLCBwZ3N6X3JhbmdlKSB8DQo+ICsJCQkJICAgICBGSUVMRF9QUkVQ
KEVSRE1BX0NNRF9DUkVBVEVfUVBfQ1FOX01BU0ssIHFwLQ0KPiA+cmNxLT5jcW4pOw0KPiArDQo+
ICsJCXJlcS5zcV9tdHRfY2ZnID0NCj4gKwkJCUZJRUxEX1BSRVAoRVJETUFfQ01EX0NSRUFURV9R
UF9QQUdFX09GRlNFVF9NQVNLLCAwKSB8DQo+ICsJCQlGSUVMRF9QUkVQKEVSRE1BX0NNRF9DUkVB
VEVfUVBfTVRUX0NOVF9NQVNLLCAxKSB8DQo+ICsJCQlGSUVMRF9QUkVQKEVSRE1BX0NNRF9DUkVB
VEVfUVBfTVRUX1RZUEVfTUFTSywNCj4gRVJETUFfTVJfSU5MSU5FX01UVCk7DQo+ICsJCXJlcS5y
cV9tdHRfY2ZnID0gcmVxLnNxX210dF9jZmc7DQo+ICsNCj4gKwkJcmVxLnJxX2J1Zl9hZGRyID0g
cXAtPmtlcm5fcXAucnFfYnVmX2RtYV9hZGRyOw0KPiArCQlyZXEuc3FfYnVmX2FkZHIgPSBxcC0+
a2Vybl9xcC5zcV9idWZfZG1hX2FkZHI7DQo+ICsJCXJlcS5zcV9kYl9pbmZvX2RtYV9hZGRyID0N
Cj4gKwkJCXFwLT5rZXJuX3FwLnNxX2J1Zl9kbWFfYWRkciArIChTUUVCQl9TSElGVCA8PCBxcC0N
Cj4gPmF0dHJzLnNxX3NpemUpOw0KPiArCQlyZXEucnFfZGJfaW5mb19kbWFfYWRkciA9DQo+ICsJ
CQlxcC0+a2Vybl9xcC5ycV9idWZfZG1hX2FkZHIgKyAoUlFFX1NISUZUIDw8IHFwLQ0KPiA+YXR0
cnMucnFfc2l6ZSk7DQo+ICsJfSBlbHNlIHsNCj4gKwkJdXNlcl9xcCA9ICZxcC0+dXNlcl9xcDsN
Cj4gKwkJcmVxLnNxX2Nxbl9tdHRfY2ZnID0NCj4gRklFTERfUFJFUChFUkRNQV9DTURfQ1JFQVRF
X1FQX1BBR0VfU0laRV9NQVNLLA0KPiArCQkJCQkJaWxvZzIodXNlcl9xcC0+c3FfbXR0LnBhZ2Vf
c2l6ZSkgLQ0KPiBQQUdFX1NISUZUKTsNCj4gKwkJcmVxLnNxX2Nxbl9tdHRfY2ZnIHw9IEZJRUxE
X1BSRVAoRVJETUFfQ01EX0NSRUFURV9RUF9DUU5fTUFTSywNCj4gcXAtPnNjcS0+Y3FuKTsNCj4g
Kw0KPiArCQlyZXEucnFfY3FuX210dF9jZmcgPQ0KPiBGSUVMRF9QUkVQKEVSRE1BX0NNRF9DUkVB
VEVfUVBfUEFHRV9TSVpFX01BU0ssDQo+ICsJCQkJCQlpbG9nMih1c2VyX3FwLT5ycV9tdHQucGFn
ZV9zaXplKSAtDQo+IFBBR0VfU0hJRlQpOw0KPiArCQlyZXEucnFfY3FuX210dF9jZmcgfD0gRklF
TERfUFJFUChFUkRNQV9DTURfQ1JFQVRFX1FQX0NRTl9NQVNLLA0KPiBxcC0+cmNxLT5jcW4pOw0K
PiArDQo+ICsJCXJlcS5zcV9tdHRfY2ZnID0gdXNlcl9xcC0+c3FfbXR0LnBhZ2Vfb2Zmc2V0Ow0K
PiArCQlyZXEuc3FfbXR0X2NmZyB8PQ0KPiArCQkJRklFTERfUFJFUChFUkRNQV9DTURfQ1JFQVRF
X1FQX01UVF9DTlRfTUFTSywgdXNlcl9xcC0NCj4gPnNxX210dC5tdHRfbmVudHMpIHwNCj4gKwkJ
CUZJRUxEX1BSRVAoRVJETUFfQ01EX0NSRUFURV9RUF9NVFRfVFlQRV9NQVNLLCB1c2VyX3FwLQ0K
PiA+c3FfbXR0Lm10dF90eXBlKTsNCj4gKw0KPiArCQlyZXEucnFfbXR0X2NmZyA9IHVzZXJfcXAt
PnJxX210dC5wYWdlX29mZnNldDsNCj4gKwkJcmVxLnJxX210dF9jZmcgfD0NCj4gKwkJCUZJRUxE
X1BSRVAoRVJETUFfQ01EX0NSRUFURV9RUF9NVFRfQ05UX01BU0ssIHVzZXJfcXAtDQo+ID5ycV9t
dHQubXR0X25lbnRzKSB8DQo+ICsJCQlGSUVMRF9QUkVQKEVSRE1BX0NNRF9DUkVBVEVfUVBfTVRU
X1RZUEVfTUFTSywgdXNlcl9xcC0NCj4gPnJxX210dC5tdHRfdHlwZSk7DQo+ICsNCj4gKwkJaWYg
KHVzZXJfcXAtPnNxX210dC5tdHRfbmVudHMgPT0gMSkNCj4gKwkJCXJlcS5zcV9idWZfYWRkciA9
ICoodTY0ICopdXNlcl9xcC0+c3FfbXR0Lm10dF9idWY7DQo+ICsJCWVsc2UNCj4gKwkJCXJlcS5z
cV9idWZfYWRkciA9IHVzZXJfcXAtPnNxX210dC5tdHRfZW50cnlbMF07DQo+ICsNCj4gKwkJaWYg
KHVzZXJfcXAtPnJxX210dC5tdHRfbmVudHMgPT0gMSkNCj4gKwkJCXJlcS5ycV9idWZfYWRkciA9
ICoodTY0ICopdXNlcl9xcC0+cnFfbXR0Lm10dF9idWY7DQo+ICsJCWVsc2UNCj4gKwkJCXJlcS5y
cV9idWZfYWRkciA9IHVzZXJfcXAtPnJxX210dC5tdHRfZW50cnlbMF07DQo+ICsNCj4gKwkJcmVx
LnNxX2RiX2luZm9fZG1hX2FkZHIgPSB1c2VyX3FwLT5zcV9kYl9pbmZvX2RtYV9hZGRyOw0KPiAr
CQlyZXEucnFfZGJfaW5mb19kbWFfYWRkciA9IHVzZXJfcXAtPnJxX2RiX2luZm9fZG1hX2FkZHI7
DQo+ICsJfQ0KPiArDQo+ICsJZXJyID0gZXJkbWFfcG9zdF9jbWRfd2FpdChkZXYtPmNtZHEsICh1
NjQgKikmcmVxLCBzaXplb2YocmVxKSwgTlVMTCwNCj4gTlVMTCk7DQo+ICsJaWYgKGVycikgew0K
PiArCQlkZXZfZXJyKGRldi0+ZG1hZGV2LCAiRVJST1I6IGVyciBjb2RlID0gJWQsIGNtZCBvZiBj
cmVhdGUgcXANCj4gZmFpbGVkLlxuIiwgZXJyKTsNCj4gKwkJcmV0dXJuIGVycjsNCj4gKwl9DQo+
ICsNCj4gKwlyZXR1cm4gMDsNCj4gK30NCj4gKw0KPiArc3RhdGljIGludCByZWdtcl9jbWQoc3Ry
dWN0IGVyZG1hX2RldiAqZGV2LCBzdHJ1Y3QgZXJkbWFfbXIgKm1yKQ0KPiArew0KPiArCXN0cnVj
dCBlcmRtYV9jbWRxX3JlZ19tcl9yZXEgcmVxOw0KPiArCXN0cnVjdCBlcmRtYV9wZCAqcGQgPSB0
b19lcGQobXItPmlibXIucGQpOw0KPiArCXU2NCAqcGh5X2FkZHI7DQo+ICsJaW50IGVyciwgaTsN
Cj4gKw0KPiArCUVSRE1BX0NNRFFfQlVJTERfUkVRX0hEUigmcmVxLCBDTURRX1NVQk1PRF9SRE1B
LA0KPiBDTURRX09QQ09ERV9SRUdfTVIpOw0KPiArDQo+ICsJcmVxLmNmZzAgPSBGSUVMRF9QUkVQ
KEVSRE1BX0NNRF9NUl9WQUxJRF9NQVNLLCBtci0+dmFsaWQpIHwNCj4gKwkJICAgRklFTERfUFJF
UChFUkRNQV9DTURfTVJfS0VZX01BU0ssIG1yLT5pYm1yLmxrZXkgJiAweEZGKSB8DQo+ICsJCSAg
IEZJRUxEX1BSRVAoRVJETUFfQ01EX01SX01QVF9JRFhfTUFTSywgbXItPmlibXIubGtleSA+PiA4
KTsNCj4gKwlyZXEuY2ZnMSA9IEZJRUxEX1BSRVAoRVJETUFfQ01EX1JFR01SX1BEX01BU0ssIHBk
LT5wZG4pIHwNCj4gKwkJICAgRklFTERfUFJFUChFUkRNQV9DTURfUkVHTVJfVFlQRV9NQVNLLCBt
ci0+dHlwZSkgfA0KPiArCQkgICBGSUVMRF9QUkVQKEVSRE1BX0NNRF9SRUdNUl9SSUdIVF9NQVNL
LCBtci0+YWNjZXNzKSB8DQo+ICsJCSAgIEZJRUxEX1BSRVAoRVJETUFfQ01EX1JFR01SX0FDQ19N
T0RFX01BU0ssIDApOw0KPiArCXJlcS5jZmcyID0gRklFTERfUFJFUChFUkRNQV9DTURfUkVHTVJf
UEFHRVNJWkVfTUFTSywgaWxvZzIobXItDQo+ID5tZW0ucGFnZV9zaXplKSkgfA0KPiArCQkgICBG
SUVMRF9QUkVQKEVSRE1BX0NNRF9SRUdNUl9NVFRfVFlQRV9NQVNLLCBtci0+bWVtLm10dF90eXBl
KQ0KPiB8DQo+ICsJCSAgIEZJRUxEX1BSRVAoRVJETUFfQ01EX1JFR01SX01UVF9DTlRfTUFTSywg
bXItPm1lbS5wYWdlX2NudCk7DQo+ICsNCj4gKwlpZiAobXItPnR5cGUgPT0gRVJETUFfTVJfVFlQ
RV9ETUEpDQo+ICsJCWdvdG8gcG9zdF9jbWQ7DQo+ICsNCj4gKwlpZiAobXItPnR5cGUgPT0gRVJE
TUFfTVJfVFlQRV9OT1JNQUwpIHsNCj4gKwkJcmVxLnN0YXJ0X3ZhID0gbXItPm1lbS52YTsNCj4g
KwkJcmVxLnNpemUgPSBtci0+bWVtLmxlbjsNCj4gKwl9DQo+ICsNCj4gKwlpZiAobXItPnR5cGUg
PT0gRVJETUFfTVJfVFlQRV9GUk1SIHx8IG1yLT5tZW0ubXR0X3R5cGUgPT0NCj4gRVJETUFfTVJf
SU5ESVJFQ1RfTVRUKSB7DQo+ICsJCXBoeV9hZGRyID0gcmVxLnBoeV9hZGRyOw0KPiArCQkqcGh5
X2FkZHIgPSBtci0+bWVtLm10dF9lbnRyeVswXTsNCj4gKwl9IGVsc2Ugew0KPiArCQlwaHlfYWRk
ciA9IHJlcS5waHlfYWRkcjsNCj4gKwkJZm9yIChpID0gMDsgaSA8IG1yLT5tZW0ubXR0X25lbnRz
OyBpKyspDQo+ICsJCQkqcGh5X2FkZHIrKyA9IG1yLT5tZW0ubXR0X2VudHJ5W2ldOw0KPiArCX0N
Cj4gKw0KPiArcG9zdF9jbWQ6DQo+ICsJZXJyID0gZXJkbWFfcG9zdF9jbWRfd2FpdChkZXYtPmNt
ZHEsICh1NjQgKikmcmVxLCBzaXplb2YocmVxKSwgTlVMTCwNCj4gTlVMTCk7DQo+ICsJaWYgKGVy
cikgew0KPiArCQlkZXZfZXJyKGRldi0+ZG1hZGV2LCAiRVJST1I6IGVyciBjb2RlID0gJWQsIGNt
ZCBvZiByZWcgbXINCj4gZmFpbGVkLlxuIiwgZXJyKTsNCj4gKwkJcmV0dXJuIGVycjsNCj4gKwl9
DQo+ICsNCj4gKwlyZXR1cm4gZXJyOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgaW50IGNyZWF0ZV9j
cV9jbWQoc3RydWN0IGVyZG1hX2RldiAqZGV2LCBzdHJ1Y3QgZXJkbWFfY3EgKmNxKQ0KPiArew0K
PiArCWludCBlcnI7DQo+ICsJc3RydWN0IGVyZG1hX2NtZHFfY3JlYXRlX2NxX3JlcSByZXE7DQo+
ICsJdTMyIHBhZ2Vfc2l6ZTsNCj4gKw0KPiArCUVSRE1BX0NNRFFfQlVJTERfUkVRX0hEUigmcmVx
LCBDTURRX1NVQk1PRF9SRE1BLA0KPiBDTURRX09QQ09ERV9DUkVBVEVfQ1EpOw0KPiArDQo+ICsJ
cmVxLmNmZzAgPSBGSUVMRF9QUkVQKEVSRE1BX0NNRF9DUkVBVEVfQ1FfQ1FOX01BU0ssIGNxLT5j
cW4pIHwNCj4gKwkJICAgRklFTERfUFJFUChFUkRNQV9DTURfQ1JFQVRFX0NRX0RFUFRIX01BU0ss
IGlsb2cyKGNxLQ0KPiA+ZGVwdGgpKTsNCj4gKwlyZXEuY2ZnMSA9IEZJRUxEX1BSRVAoRVJETUFf
Q01EX0NSRUFURV9DUV9FUU5fTUFTSywgY3EtPmFzc29jX2Vxbik7DQo+ICsNCj4gKwlpZiAoY3Et
PmlzX2tlcm5lbF9jcSkgew0KDQp1c2UgcmRtYV9pc19rZXJuZWxfcmVzKCZjcS0+aWJjcS5yZXMp
DQoNCg0KPiArCQlwYWdlX3NpemUgPSBTWl8zMk07DQo+ICsJCXJlcS5jZmcwIHw9IEZJRUxEX1BS
RVAoRVJETUFfQ01EX0NSRUFURV9DUV9QQUdFU0laRV9NQVNLLA0KPiArCQkJCSAgICAgICBpbG9n
MihwYWdlX3NpemUpIC0gUEFHRV9TSElGVCk7DQo+ICsJCXJlcS5xYnVmX2FkZHJfbCA9IGxvd2Vy
XzMyX2JpdHMoY3EtPmtlcm5fY3EucWJ1Zl9kbWFfYWRkcik7DQo+ICsJCXJlcS5xYnVmX2FkZHJf
aCA9IHVwcGVyXzMyX2JpdHMoY3EtPmtlcm5fY3EucWJ1Zl9kbWFfYWRkcik7DQo+ICsNCj4gKwkJ
cmVxLmNmZzEgfD0gRklFTERfUFJFUChFUkRNQV9DTURfQ1JFQVRFX0NRX01UVF9DTlRfTUFTSywg
MSkgfA0KPiArCQkJICAgIEZJRUxEX1BSRVAoRVJETUFfQ01EX0NSRUFURV9DUV9NVFRfVFlQRV9N
QVNLLA0KPiBFUkRNQV9NUl9JTkxJTkVfTVRUKTsNCj4gKw0KPiArCQlyZXEuZmlyc3RfcGFnZV9v
ZmZzZXQgPSAwOw0KPiArCQlyZXEuY3FfZGJfaW5mb19hZGRyID0gY3EtPmtlcm5fY3EucWJ1Zl9k
bWFfYWRkciArIChjcS0+ZGVwdGgNCj4gPDwgQ1FFX1NISUZUKTsNCj4gKwl9IGVsc2Ugew0KPiAr
CQlyZXEuY2ZnMCB8PSBGSUVMRF9QUkVQKEVSRE1BX0NNRF9DUkVBVEVfQ1FfUEFHRVNJWkVfTUFT
SywNCj4gKwkJCQkgICAgICAgaWxvZzIoY3EtPnVzZXJfY3EucWJ1Zl9tdHQucGFnZV9zaXplKSAt
DQo+IFBBR0VfU0hJRlQpOw0KPiArCQlpZiAoY3EtPnVzZXJfY3EucWJ1Zl9tdHQubXR0X25lbnRz
ID09IDEpIHsNCj4gKwkJCXJlcS5xYnVmX2FkZHJfbCA9IGxvd2VyXzMyX2JpdHMoKih1NjQgKilj
cS0NCj4gPnVzZXJfY3EucWJ1Zl9tdHQubXR0X2J1Zik7DQo+ICsJCQlyZXEucWJ1Zl9hZGRyX2gg
PSB1cHBlcl8zMl9iaXRzKCoodTY0ICopY3EtDQo+ID51c2VyX2NxLnFidWZfbXR0Lm10dF9idWYp
Ow0KPiArCQl9IGVsc2Ugew0KPiArCQkJcmVxLnFidWZfYWRkcl9sID0gbG93ZXJfMzJfYml0cyhj
cS0NCj4gPnVzZXJfY3EucWJ1Zl9tdHQubXR0X2VudHJ5WzBdKTsNCj4gKwkJCXJlcS5xYnVmX2Fk
ZHJfaCA9IHVwcGVyXzMyX2JpdHMoY3EtDQo+ID51c2VyX2NxLnFidWZfbXR0Lm10dF9lbnRyeVsw
XSk7DQo+ICsJCX0NCj4gKwkJcmVxLmNmZzEgfD0gRklFTERfUFJFUChFUkRNQV9DTURfQ1JFQVRF
X0NRX01UVF9DTlRfTUFTSywNCj4gKwkJCQkgICAgICAgY3EtPnVzZXJfY3EucWJ1Zl9tdHQubXR0
X25lbnRzKTsNCj4gKwkJcmVxLmNmZzEgfD0gRklFTERfUFJFUChFUkRNQV9DTURfQ1JFQVRFX0NR
X01UVF9UWVBFX01BU0ssDQo+ICsJCQkJICAgICAgIGNxLT51c2VyX2NxLnFidWZfbXR0Lm10dF90
eXBlKTsNCj4gKw0KPiArCQlyZXEuZmlyc3RfcGFnZV9vZmZzZXQgPSBjcS0+dXNlcl9jcS5xYnVm
X210dC5wYWdlX29mZnNldDsNCj4gKwkJcmVxLmNxX2RiX2luZm9fYWRkciA9IGNxLT51c2VyX2Nx
LmRiX2luZm9fZG1hX2FkZHI7DQo+ICsJfQ0KPiArDQo+ICsJZXJyID0gZXJkbWFfcG9zdF9jbWRf
d2FpdChkZXYtPmNtZHEsICh1NjQgKikmcmVxLCBzaXplb2YocmVxKSwgTlVMTCwNCj4gTlVMTCk7
DQo+ICsJaWYgKGVycikgew0KPiArCQlkZXZfZXJyKGRldi0+ZG1hZGV2LCAiRVJST1I6IGVyciBj
b2RlID0gJWQsIGNtZCBvZiBjcmVhdGUgY3ENCj4gZmFpbGVkLlxuIiwgZXJyKTsNCj4gKwkJcmV0
dXJuIGVycjsNCj4gKwl9DQo+ICsNCj4gKwlyZXR1cm4gMDsNCj4gK30NCj4gKw0KPiArDQo+ICtz
dGF0aWMgc3RydWN0IHJkbWFfdXNlcl9tbWFwX2VudHJ5ICoNCj4gK2VyZG1hX3VzZXJfbW1hcF9l
bnRyeV9pbnNlcnQoc3RydWN0IGVyZG1hX3Vjb250ZXh0ICp1Y3R4LCB2b2lkICphZGRyZXNzLA0K
PiB1MzIgc2l6ZSwNCj4gKwkJCSAgICAgdTggbW1hcF9mbGFnLCB1NjQgKm1tYXBfb2Zmc2V0KQ0K
PiArew0KPiArCXN0cnVjdCBlcmRtYV91c2VyX21tYXBfZW50cnkgKmVudHJ5ID0ga3phbGxvYyhz
aXplb2YoKmVudHJ5KSwNCj4gR0ZQX0tFUk5FTCk7DQo+ICsJaW50IHJldDsNCj4gKw0KPiArCWlm
ICghZW50cnkpDQo+ICsJCXJldHVybiBOVUxMOw0KPiArDQo+ICsJZW50cnktPmFkZHJlc3MgPSAo
dTY0KWFkZHJlc3M7DQo+ICsJZW50cnktPm1tYXBfZmxhZyA9IG1tYXBfZmxhZzsNCj4gKw0KPiAr
CXNpemUgPSBQQUdFX0FMSUdOKHNpemUpOw0KPiArDQo+ICsJcmV0ID0gcmRtYV91c2VyX21tYXBf
ZW50cnlfaW5zZXJ0KCZ1Y3R4LT5pYnVjb250ZXh0LCAmZW50cnktDQo+ID5yZG1hX2VudHJ5LCBz
aXplKTsNCj4gKwlpZiAocmV0KSB7DQo+ICsJCWtmcmVlKGVudHJ5KTsNCj4gKwkJcmV0dXJuIE5V
TEw7DQo+ICsJfQ0KPiArDQo+ICsJKm1tYXBfb2Zmc2V0ID0gcmRtYV91c2VyX21tYXBfZ2V0X29m
ZnNldCgmZW50cnktPnJkbWFfZW50cnkpOw0KPiArDQo+ICsJcmV0dXJuICZlbnRyeS0+cmRtYV9l
bnRyeTsNCj4gK30NCj4gKw0KPiAraW50IGVyZG1hX3F1ZXJ5X2RldmljZShzdHJ1Y3QgaWJfZGV2
aWNlICppYmRldiwgc3RydWN0IGliX2RldmljZV9hdHRyDQo+ICphdHRyLA0KPiArCQkgICAgICAg
c3RydWN0IGliX3VkYXRhICp1bnVzZWQpDQo+ICt7DQo+ICsJc3RydWN0IGVyZG1hX2RldiAqZGV2
ID0gdG9fZWRldihpYmRldik7DQo+ICsNCj4gKwltZW1zZXQoYXR0ciwgMCwgc2l6ZW9mKCphdHRy
KSk7DQo+ICsNCj4gKwlhdHRyLT5tYXhfbXJfc2l6ZSA9IGRldi0+YXR0cnMubWF4X21yX3NpemU7
DQo+ICsJYXR0ci0+dmVuZG9yX2lkID0gZGV2LT5hdHRycy52ZW5kb3JfaWQ7DQo+ICsJYXR0ci0+
dmVuZG9yX3BhcnRfaWQgPSAwOw0KPiArCWF0dHItPm1heF9xcCA9IGRldi0+YXR0cnMubWF4X3Fw
Ow0KPiArCWF0dHItPm1heF9xcF93ciA9IGRldi0+YXR0cnMubWF4X3NlbmRfd3IgPiBkZXYtPmF0
dHJzLm1heF9yZWN2X3dyID8NCj4gKwkJZGV2LT5hdHRycy5tYXhfcmVjdl93ciA6IGRldi0+YXR0
cnMubWF4X3NlbmRfd3I7DQo+ICsNCj4gKwlhdHRyLT5tYXhfcXBfcmRfYXRvbSA9IGRldi0+YXR0
cnMubWF4X29yZDsNCj4gKwlhdHRyLT5tYXhfcXBfaW5pdF9yZF9hdG9tID0gZGV2LT5hdHRycy5t
YXhfaXJkOw0KPiArCWF0dHItPm1heF9yZXNfcmRfYXRvbSA9IGRldi0+YXR0cnMubWF4X3FwICog
ZGV2LT5hdHRycy5tYXhfaXJkOw0KPiArCWF0dHItPmRldmljZV9jYXBfZmxhZ3MgPSBkZXYtPmF0
dHJzLmNhcF9mbGFnczsNCj4gKwlpYmRldi0+bG9jYWxfZG1hX2xrZXkgPSBkZXYtPmF0dHJzLmxv
Y2FsX2RtYV9rZXk7DQo+ICsJYXR0ci0+bWF4X3NlbmRfc2dlID0gZGV2LT5hdHRycy5tYXhfc2Vu
ZF9zZ2U7DQo+ICsJYXR0ci0+bWF4X3JlY3Zfc2dlID0gZGV2LT5hdHRycy5tYXhfcmVjdl9zZ2U7
DQo+ICsJYXR0ci0+bWF4X3NnZV9yZCA9IGRldi0+YXR0cnMubWF4X3NnZV9yZDsNCj4gKwlhdHRy
LT5tYXhfY3EgPSBkZXYtPmF0dHJzLm1heF9jcTsNCj4gKwlhdHRyLT5tYXhfY3FlID0gZGV2LT5h
dHRycy5tYXhfY3FlOw0KPiArCWF0dHItPm1heF9tciA9IGRldi0+YXR0cnMubWF4X21yOw0KPiAr
CWF0dHItPm1heF9wZCA9IGRldi0+YXR0cnMubWF4X3BkOw0KPiArCWF0dHItPm1heF9tdyA9IGRl
di0+YXR0cnMubWF4X213Ow0KPiArCWF0dHItPm1heF9zcnEgPSBkZXYtPmF0dHJzLm1heF9zcnE7
DQo+ICsJYXR0ci0+bWF4X3NycV93ciA9IGRldi0+YXR0cnMubWF4X3NycV93cjsNCj4gKwlhdHRy
LT5tYXhfc3JxX3NnZSA9IGRldi0+YXR0cnMubWF4X3NycV9zZ2U7DQo+ICsJYXR0ci0+bWF4X2Zh
c3RfcmVnX3BhZ2VfbGlzdF9sZW4gPSBFUkRNQV9NQVhfRlJNUl9QQTsNCj4gKwlhdHRyLT5wYWdl
X3NpemVfY2FwID0gRVJETUFfUEFHRV9TSVpFX1NVUFBPUlQ7DQo+ICsNCj4gKwlhZGRyY29uZl9h
ZGRyX2V1aTQ4KCh1OCAqKSZhdHRyLT5zeXNfaW1hZ2VfZ3VpZCwgZGV2LT5uZXRkZXYtDQo+ID5k
ZXZfYWRkcik7DQo+ICsNCj4gKwlyZXR1cm4gMDsNCj4gK30NCj4gKw0KPiAraW50IGVyZG1hX3F1
ZXJ5X2dpZChzdHJ1Y3QgaWJfZGV2aWNlICppYmRldiwgdTMyIHBvcnQsIGludCBpZHgsIHVuaW9u
DQo+IGliX2dpZCAqZ2lkKQ0KPiArew0KPiArCXN0cnVjdCBlcmRtYV9kZXYgKmRldiA9IHRvX2Vk
ZXYoaWJkZXYpOw0KPiArDQo+ICsJbWVtc2V0KGdpZCwgMCwgc2l6ZW9mKCpnaWQpKTsNCj4gKwlt
ZW1jcHkoJmdpZC0+cmF3WzBdLCBkZXYtPm5ldGRldi0+ZGV2X2FkZHIsIDYpOw0KPiArDQo+ICsJ
cmV0dXJuIDA7DQo+ICt9DQo+ICsNCj4gK2ludCBlcmRtYV9xdWVyeV9wb3J0KHN0cnVjdCBpYl9k
ZXZpY2UgKmliZGV2LCB1MzIgcG9ydCwgc3RydWN0DQo+IGliX3BvcnRfYXR0ciAqYXR0cikNCj4g
K3sNCj4gKwlzdHJ1Y3QgZXJkbWFfZGV2ICpkZXYgPSB0b19lZGV2KGliZGV2KTsNCj4gKwlpbnQg
cmV0Ow0KPiArDQo+ICsJbWVtc2V0KGF0dHIsIDAsIHNpemVvZigqYXR0cikpOw0KPiArDQo+ICsJ
cmV0ID0gaWJfZ2V0X2V0aF9zcGVlZChpYmRldiwgcG9ydCwgJmF0dHItPmFjdGl2ZV9zcGVlZCwg
JmF0dHItDQo+ID5hY3RpdmVfd2lkdGgpOw0KPiArDQo+ICsJYXR0ci0+c3RhdGUgPSBkZXYtPnN0
YXRlOw0KPiArCWF0dHItPm1heF9tdHUgPSBpYl9tdHVfaW50X3RvX2VudW0oZGV2LT5uZXRkZXYt
Pm10dSk7DQo+ICsJYXR0ci0+YWN0aXZlX210dSA9IGliX210dV9pbnRfdG9fZW51bShkZXYtPm5l
dGRldi0+bXR1KTsNCj4gKwlhdHRyLT5naWRfdGJsX2xlbiA9IDE7DQo+ICsJYXR0ci0+cG9ydF9j
YXBfZmxhZ3MgPSBJQl9QT1JUX0NNX1NVUDsNCj4gKwlhdHRyLT5wb3J0X2NhcF9mbGFncyB8PSBJ
Ql9QT1JUX0RFVklDRV9NR01UX1NVUDsNCg0KeW91IG1heSBiZXR0ZXIgd3JpdGUgYWJvdmUgdHdv
IGxpbmVzIGluIG9uZSBsaW5lDQoNCj4gKwlhdHRyLT5tYXhfbXNnX3N6ID0gLTE7DQo+ICsJYXR0
ci0+cGh5c19zdGF0ZSA9IGRldi0+c3RhdGUgPT0gSUJfUE9SVF9BQ1RJVkUgPw0KPiArCQlJQl9Q
T1JUX1BIWVNfU1RBVEVfTElOS19VUCA6IElCX1BPUlRfUEhZU19TVEFURV9ESVNBQkxFRDsNCj4g
Kw0KPiArCXJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4gK2ludCBlcmRtYV9nZXRfcG9ydF9pbW11
dGFibGUoc3RydWN0IGliX2RldmljZSAqaWJkZXYsIHUzMiBwb3J0LA0KPiArCQkJICAgICBzdHJ1
Y3QgaWJfcG9ydF9pbW11dGFibGUgKnBvcnRfaW1tdXRhYmxlKQ0KPiArew0KPiArCXN0cnVjdCBp
Yl9wb3J0X2F0dHIgYXR0cjsNCj4gKwlpbnQgcmV0ID0gZXJkbWFfcXVlcnlfcG9ydChpYmRldiwg
cG9ydCwgJmF0dHIpOw0KPiArDQo+ICsJaWYgKHJldCkNCj4gKwkJcmV0dXJuIHJldDsNCj4gKw0K
PiArCXBvcnRfaW1tdXRhYmxlLT5naWRfdGJsX2xlbiA9IGF0dHIuZ2lkX3RibF9sZW47DQo+ICsJ
cG9ydF9pbW11dGFibGUtPmNvcmVfY2FwX2ZsYWdzID0gUkRNQV9DT1JFX1BPUlRfSVdBUlA7DQo+
ICsNCj4gKwlyZXR1cm4gMDsNCj4gK30NCj4gKw0KPiAraW50IGVyZG1hX2FsbG9jX3BkKHN0cnVj
dCBpYl9wZCAqaWJwZCwgc3RydWN0IGliX3VkYXRhICp1ZGF0YSkNCj4gK3sNCj4gKwlzdHJ1Y3Qg
ZXJkbWFfcGQgKnBkID0gdG9fZXBkKGlicGQpOw0KPiArCXN0cnVjdCBlcmRtYV9kZXYgKmRldiA9
IHRvX2VkZXYoaWJwZC0+ZGV2aWNlKTsNCj4gKwlpbnQgcGRuOw0KPiArDQo+ICsJcGRuID0gZXJk
bWFfYWxsb2NfaWR4KCZkZXYtPnJlc19jYltFUkRNQV9SRVNfVFlQRV9QRF0pOw0KPiArCWlmIChw
ZG4gPCAwKQ0KPiArCQlyZXR1cm4gcGRuOw0KPiArDQo+ICsJcGQtPnBkbiA9IHBkbjsNCj4gKw0K
PiArCWF0b21pY19pbmMoJmRldi0+bnVtX3BkKTsNCj4gKw0KPiArCXJldHVybiAwOw0KPiArfQ0K
PiArDQo+ICtpbnQgZXJkbWFfZGVhbGxvY19wZChzdHJ1Y3QgaWJfcGQgKmlicGQsIHN0cnVjdCBp
Yl91ZGF0YSAqdWRhdGEpDQo+ICt7DQo+ICsJc3RydWN0IGVyZG1hX3BkICpwZCA9IHRvX2VwZChp
YnBkKTsNCj4gKwlzdHJ1Y3QgZXJkbWFfZGV2ICpkZXYgPSB0b19lZGV2KGlicGQtPmRldmljZSk7
DQo+ICsNCj4gKwllcmRtYV9mcmVlX2lkeCgmZGV2LT5yZXNfY2JbRVJETUFfUkVTX1RZUEVfUERd
LCBwZC0+cGRuKTsNCj4gKwlhdG9taWNfZGVjKCZkZXYtPm51bV9wZCk7DQo+ICsNCj4gKwlyZXR1
cm4gMDsNCj4gK30NCj4gKw0KPiArc3RhdGljIGludCBlcmRtYV9xcF92YWxpZGF0ZV9jYXAoc3Ry
dWN0IGVyZG1hX2RldiAqZGV2LCBzdHJ1Y3QNCj4gaWJfcXBfaW5pdF9hdHRyICphdHRycykNCj4g
K3sNCj4gKwlpZiAoKGF0dHJzLT5jYXAubWF4X3NlbmRfd3IgPiBkZXYtPmF0dHJzLm1heF9zZW5k
X3dyKSB8fA0KPiArCSAgICAoYXR0cnMtPmNhcC5tYXhfcmVjdl93ciA+IGRldi0+YXR0cnMubWF4
X3JlY3Zfd3IpIHx8DQo+ICsJICAgIChhdHRycy0+Y2FwLm1heF9zZW5kX3NnZSA+IGRldi0+YXR0
cnMubWF4X3NlbmRfc2dlKSB8fA0KPiArCSAgICAoYXR0cnMtPmNhcC5tYXhfcmVjdl9zZ2UgPiBk
ZXYtPmF0dHJzLm1heF9yZWN2X3NnZSkgfHwNCj4gKwkgICAgKGF0dHJzLT5jYXAubWF4X2lubGlu
ZV9kYXRhID4gRVJETUFfTUFYX0lOTElORSkgfHwNCj4gKwkgICAgIWF0dHJzLT5jYXAubWF4X3Nl
bmRfd3IgfHwNCj4gKwkgICAgIWF0dHJzLT5jYXAubWF4X3JlY3Zfd3IpIHsNCj4gKwkJcmV0dXJu
IC1FSU5WQUw7DQo+ICsJfQ0KPiArDQo+ICsJcmV0dXJuIDA7DQo+ICt9DQo+ICsNCj4gK3N0YXRp
YyBpbnQgZXJkbWFfcXBfdmFsaWRhdGVfYXR0cihzdHJ1Y3QgZXJkbWFfZGV2ICpkZXYsIHN0cnVj
dA0KPiBpYl9xcF9pbml0X2F0dHIgKmF0dHJzKQ0KPiArew0KPiArCWlmIChhdHRycy0+cXBfdHlw
ZSAhPSBJQl9RUFRfUkMpIHsNCj4gKwkJaWJkZXZfZXJyX3JhdGVsaW1pdGVkKCZkZXYtPmliZGV2
LCAib25seSBzdXBwb3J0IFJDIG1vZGUuIik7DQo+ICsJCXJldHVybiAtRU9QTk9UU1VQUDsNCj4g
Kwl9DQo+ICsNCj4gKwlpZiAoYXR0cnMtPnNycSkgew0KPiArCQlpYmRldl9lcnJfcmF0ZWxpbWl0
ZWQoJmRldi0+aWJkZXYsICJub3Qgc3VwcG9ydCBTUlEgbm93LiIpOw0KPiArCQlyZXR1cm4gLUVP
UE5PVFNVUFA7DQo+ICsJfQ0KPiArDQo+ICsJaWYgKCFhdHRycy0+c2VuZF9jcSB8fCAhYXR0cnMt
PnJlY3ZfY3EpIHsNCj4gKwkJaWJkZXZfZXJyX3JhdGVsaW1pdGVkKCZkZXYtPmliZGV2LCAiU0NR
IG9yIFJDUSBpcyBudWxsLiIpOw0KPiArCQlyZXR1cm4gLUVPUE5PVFNVUFA7DQo+ICsJfQ0KPiAr
DQo+ICsJcmV0dXJuIDA7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyB2b2lkIGZyZWVfa2VybmVsX3Fw
KHN0cnVjdCBlcmRtYV9xcCAqcXApDQo+ICt7DQo+ICsJc3RydWN0IGVyZG1hX2RldiAqZGV2ID0g
cXAtPmRldjsNCj4gKw0KPiArCXZmcmVlKHFwLT5rZXJuX3FwLnN3cl90YmwpOw0KPiArCXZmcmVl
KHFwLT5rZXJuX3FwLnJ3cl90YmwpOw0KPiArDQo+ICsJaWYgKHFwLT5rZXJuX3FwLnNxX2J1Zikg
ew0KPiArCQlkbWFfZnJlZV9jb2hlcmVudChkZXYtPmRtYWRldiwNCj4gKwkJCQkgIChxcC0+YXR0
cnMuc3Ffc2l6ZSA8PCBTUUVCQl9TSElGVCkgKw0KPiBFUkRNQV9FWFRSQV9CVUZGRVJfU0laRSwN
Cj4gKwkJCQkgIHFwLT5rZXJuX3FwLnNxX2J1ZiwgcXAtDQo+ID5rZXJuX3FwLnNxX2J1Zl9kbWFf
YWRkcik7DQo+ICsJfQ0KPiArDQo+ICsJaWYgKHFwLT5rZXJuX3FwLnJxX2J1Zikgew0KPiArCQlk
bWFfZnJlZV9jb2hlcmVudChkZXYtPmRtYWRldiwNCj4gKwkJCQkgIChxcC0+YXR0cnMucnFfc2l6
ZSA8PCBSUUVfU0hJRlQpICsNCj4gRVJETUFfRVhUUkFfQlVGRkVSX1NJWkUsDQo+ICsJCQkJICBx
cC0+a2Vybl9xcC5ycV9idWYsIHFwLQ0KPiA+a2Vybl9xcC5ycV9idWZfZG1hX2FkZHIpOw0KPiAr
CX0NCj4gK30NCj4gKw0KPiArc3RhdGljIGludCBpbml0X2tlcm5lbF9xcChzdHJ1Y3QgZXJkbWFf
ZGV2ICpkZXYsIHN0cnVjdCBlcmRtYV9xcCAqcXAsDQo+ICsJCQkgIHN0cnVjdCBpYl9xcF9pbml0
X2F0dHIgKmF0dHJzKQ0KPiArew0KPiArCWludCByZXQgPSAtRU5PTUVNOw0KPiArCXN0cnVjdCBl
cmRtYV9rcXAgKmtxcCA9ICZxcC0+a2Vybl9xcDsNCj4gKwlpbnQgc2l6ZTsNCj4gKw0KPiArCWlm
IChhdHRycy0+c3Ffc2lnX3R5cGUgPT0gSUJfU0lHTkFMX0FMTF9XUikNCj4gKwkJa3FwLT5zaWdf
YWxsID0gMTsNCj4gKw0KPiArCXFwLT5pc19rZXJuZWxfcXAgPSAxOw0KPiArCWtxcC0+c3FfcGkg
PSAwOw0KPiArCWtxcC0+c3FfY2kgPSAwOw0KPiArCWtxcC0+cnFfcGkgPSAwOw0KPiArCWtxcC0+
cnFfY2kgPSAwOw0KPiArCWtxcC0+aHdfc3FfZGIgPSBkZXYtPmRiX3NwYWNlICsgKEVSRE1BX1NE
Ql9TSEFSRURfUEFHRV9JTkRFWCA8PA0KPiBQQUdFX1NISUZUKTsNCj4gKwlrcXAtPmh3X3JxX2Ri
ID0gZGV2LT5kYl9zcGFjZSArIEVSRE1BX0JBUl9SUURCX1NQQUNFX09GRlNFVDsNCj4gKw0KPiAr
CWtxcC0+c3dyX3RibCA9IHZtYWxsb2MocXAtPmF0dHJzLnNxX3NpemUgKiBzaXplb2YodTY0KSk7
DQo+ICsJa3FwLT5yd3JfdGJsID0gdm1hbGxvYyhxcC0+YXR0cnMucnFfc2l6ZSAqIHNpemVvZih1
NjQpKTsNCj4gKw0KPiArCXNpemUgPSAocXAtPmF0dHJzLnNxX3NpemUgPDwgU1FFQkJfU0hJRlQp
ICsgRVJETUFfRVhUUkFfQlVGRkVSX1NJWkU7DQo+ICsJa3FwLT5zcV9idWYgPSBkbWFfYWxsb2Nf
Y29oZXJlbnQoZGV2LT5kbWFkZXYsIHNpemUsICZrcXAtDQo+ID5zcV9idWZfZG1hX2FkZHIsIEdG
UF9LRVJORUwpOw0KPiArCWlmICgha3FwLT5zcV9idWYpDQo+ICsJCWdvdG8gZXJyX291dDsNCj4g
Kw0KPiArCXNpemUgPSAocXAtPmF0dHJzLnJxX3NpemUgPDwgUlFFX1NISUZUKSArIEVSRE1BX0VY
VFJBX0JVRkZFUl9TSVpFOw0KPiArCWtxcC0+cnFfYnVmID0gZG1hX2FsbG9jX2NvaGVyZW50KGRl
di0+ZG1hZGV2LCBzaXplLCAma3FwLQ0KPiA+cnFfYnVmX2RtYV9hZGRyLCBHRlBfS0VSTkVMKTsN
Cj4gKwlpZiAoIWtxcC0+cnFfYnVmKQ0KPiArCQlnb3RvIGVycl9vdXQ7DQo+ICsNCj4gKwlrcXAt
PnNxX2RiX2luZm8gPSBrcXAtPnNxX2J1ZiArIChxcC0+YXR0cnMuc3Ffc2l6ZSA8PCBTUUVCQl9T
SElGVCk7DQo+ICsJa3FwLT5ycV9kYl9pbmZvID0ga3FwLT5ycV9idWYgKyAocXAtPmF0dHJzLnJx
X3NpemUgPDwgUlFFX1NISUZUKTsNCj4gKw0KPiArCXJldHVybiAwOw0KPiArDQo+ICtlcnJfb3V0
Og0KPiArCWZyZWVfa2VybmVsX3FwKHFwKTsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+
ICtzdGF0aWMgaW50IGdldF9tdHRfZW50cmllcyhzdHJ1Y3QgZXJkbWFfZGV2ICpkZXYsIHN0cnVj
dCBlcmRtYV9tZW0gKm1lbSwNCj4gdTY0IHN0YXJ0LA0KPiArCQkJICAgdTY0IGxlbiwgaW50IGFj
Y2VzcywgdTY0IHZpcnQsIHVuc2lnbmVkIGxvbmcNCj4gcmVxX3BhZ2Vfc2l6ZSwNCj4gKwkJCSAg
IHU4IGZvcmNlX2luZGlyZWN0X210dCkNCj4gK3sNCj4gKwlzdHJ1Y3QgaWJfYmxvY2tfaXRlciBi
aXRlcjsNCj4gKwl1aW50NjRfdCAqcGh5X2FkZHIgPSBOVUxMOw0KPiArCWludCByZXQgPSAwOw0K
PiArDQo+ICsJbWVtLT51bWVtID0gaWJfdW1lbV9nZXQoJmRldi0+aWJkZXYsIHN0YXJ0LCBsZW4s
IGFjY2Vzcyk7DQo+ICsJaWYgKElTX0VSUihtZW0tPnVtZW0pKSB7DQo+ICsJCXJldCA9IFBUUl9F
UlIobWVtLT51bWVtKTsNCj4gKwkJbWVtLT51bWVtID0gTlVMTDsNCj4gKwkJcmV0dXJuIHJldDsN
Cj4gKwl9DQo+ICsNCj4gKwltZW0tPnBhZ2Vfc2l6ZSA9IGliX3VtZW1fZmluZF9iZXN0X3Bnc3oo
bWVtLT51bWVtLCByZXFfcGFnZV9zaXplLA0KPiB2aXJ0KTsNCj4gKwltZW0tPnBhZ2Vfb2Zmc2V0
ID0gc3RhcnQgJiAobWVtLT5wYWdlX3NpemUgLSAxKTsNCj4gKwltZW0tPm10dF9uZW50cyA9IGli
X3VtZW1fbnVtX2RtYV9ibG9ja3MobWVtLT51bWVtLCBtZW0tPnBhZ2Vfc2l6ZSk7DQo+ICsJbWVt
LT5wYWdlX2NudCA9IG1lbS0+bXR0X25lbnRzOw0KPiArDQo+ICsJaWYgKG1lbS0+cGFnZV9jbnQg
PiBFUkRNQV9NQVhfSU5MSU5FX01UVF9FTlRSSUVTIHx8DQo+IGZvcmNlX2luZGlyZWN0X210dCkg
ew0KPiArCQltZW0tPm10dF90eXBlID0gRVJETUFfTVJfSU5ESVJFQ1RfTVRUOw0KPiArCQltZW0t
Pm10dF9idWYgPSBhbGxvY19wYWdlc19leGFjdChNVFRfU0laRShtZW0tPnBhZ2VfY250KSwNCj4g
R0ZQX0tFUk5FTCk7DQo+ICsJCWlmICghbWVtLT5tdHRfYnVmKSB7DQo+ICsJCQlyZXQgPSAtRU5P
TUVNOw0KPiArCQkJZ290byBlcnJvcl9yZXQ7DQo+ICsJCX0NCj4gKwkJcGh5X2FkZHIgPSBtZW0t
Pm10dF9idWY7DQo+ICsJfSBlbHNlIHsNCj4gKwkJbWVtLT5tdHRfdHlwZSA9IEVSRE1BX01SX0lO
TElORV9NVFQ7DQo+ICsJCXBoeV9hZGRyID0gbWVtLT5tdHRfZW50cnk7DQo+ICsJfQ0KPiArDQo+
ICsJcmRtYV91bWVtX2Zvcl9lYWNoX2RtYV9ibG9jayhtZW0tPnVtZW0sICZiaXRlciwgbWVtLT5w
YWdlX3NpemUpIHsNCj4gKwkJKnBoeV9hZGRyID0gcmRtYV9ibG9ja19pdGVyX2RtYV9hZGRyZXNz
KCZiaXRlcik7DQo+ICsJCXBoeV9hZGRyKys7DQo+ICsJfQ0KPiArDQo+ICsJaWYgKG1lbS0+bXR0
X3R5cGUgPT0gRVJETUFfTVJfSU5ESVJFQ1RfTVRUKSB7DQo+ICsJCW1lbS0+bXR0X2VudHJ5WzBd
ID0gZG1hX21hcF9zaW5nbGUoZGV2LT5kbWFkZXYsIG1lbS0+bXR0X2J1ZiwNCj4gKwkJCQkJCSAg
IE1UVF9TSVpFKG1lbS0+cGFnZV9jbnQpLA0KPiBETUFfVE9fREVWSUNFKTsNCj4gKwkJaWYgKGRt
YV9tYXBwaW5nX2Vycm9yKGRldi0+ZG1hZGV2LCBtZW0tPm10dF9lbnRyeVswXSkpIHsNCj4gKwkJ
CWliZGV2X2VycigmZGV2LT5pYmRldiwgImZhaWxlZCB0byBtYXAgRE1BIGFkZHJlc3MuXG4iKTsN
Cj4gKwkJCWZyZWVfcGFnZXNfZXhhY3QobWVtLT5tdHRfYnVmLCBNVFRfU0laRShtZW0tPnBhZ2Vf
Y250KSk7DQo+ICsJCQltZW0tPm10dF9idWYgPSBOVUxMOw0KPiArCQkJcmV0ID0gLUVOT01FTTsN
Cj4gKwkJCWdvdG8gZXJyb3JfcmV0Ow0KPiArCQl9DQo+ICsJfQ0KPiArDQo+ICsJcmV0dXJuIDA7
DQo+ICsNCj4gK2Vycm9yX3JldDoNCj4gKwlpZiAobWVtLT51bWVtKSB7DQo+ICsJCWliX3VtZW1f
cmVsZWFzZShtZW0tPnVtZW0pOw0KPiArCQltZW0tPnVtZW0gPSBOVUxMOw0KPiArCX0NCj4gKw0K
PiArCXJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyB2b2lkIHB1dF9tdHRfZW50cmll
cyhzdHJ1Y3QgZXJkbWFfZGV2ICpkZXYsIHN0cnVjdCBlcmRtYV9tZW0gKm1lbSkNCj4gK3sNCj4g
KwlpZiAobWVtLT51bWVtKSB7DQo+ICsJCWliX3VtZW1fcmVsZWFzZShtZW0tPnVtZW0pOw0KPiAr
CQltZW0tPnVtZW0gPSBOVUxMOw0KPiArCX0NCj4gKw0KPiArCWlmIChtZW0tPm10dF9idWYpIHsN
Cj4gKwkJZG1hX3VubWFwX3NpbmdsZShkZXYtPmRtYWRldiwgbWVtLT5tdHRfZW50cnlbMF0sIE1U
VF9TSVpFKG1lbS0NCj4gPnBhZ2VfY250KSwNCj4gKwkJCQkgRE1BX1RPX0RFVklDRSk7DQo+ICsJ
CWZyZWVfcGFnZXNfZXhhY3QobWVtLT5tdHRfYnVmLCBNVFRfU0laRShtZW0tPnBhZ2VfY250KSk7
DQo+ICsJfQ0KPiArfQ0KPiArDQo+ICtzdGF0aWMgaW50IGVyZG1hX21hcF91c2VyX2RicmVjb3Jk
cyhzdHJ1Y3QgZXJkbWFfdWNvbnRleHQgKmN0eCwgdTY0DQo+IGRicmVjb3Jkc192YSwNCj4gKwkJ
CQkgICAgc3RydWN0IGVyZG1hX3VzZXJfZGJyZWNvcmRzX3BhZ2UgKipkYnJfcGFnZSwNCj4gKwkJ
CQkgICAgZG1hX2FkZHJfdCAqZG1hX2FkZHIpDQo+ICt7DQo+ICsJc3RydWN0IGVyZG1hX3VzZXJf
ZGJyZWNvcmRzX3BhZ2UgKnBhZ2UgPSBOVUxMOw0KPiArCWludCBydiA9IDA7DQo+ICsNCj4gKwlt
dXRleF9sb2NrKCZjdHgtPmRicmVjb3Jkc19wYWdlX211dGV4KTsNCj4gKw0KPiArCWxpc3RfZm9y
X2VhY2hfZW50cnkocGFnZSwgJmN0eC0+ZGJyZWNvcmRzX3BhZ2VfbGlzdCwgbGlzdCkNCj4gKwkJ
aWYgKHBhZ2UtPnZhID09IChkYnJlY29yZHNfdmEgJiBQQUdFX01BU0spKQ0KPiArCQkJZ290byBm
b3VuZDsNCj4gKw0KPiArCXBhZ2UgPSBrbWFsbG9jKHNpemVvZigqcGFnZSksIEdGUF9LRVJORUwp
Ow0KPiArCWlmICghcGFnZSkgew0KPiArCQlydiA9IC1FTk9NRU07DQo+ICsJCWdvdG8gb3V0Ow0K
PiArCX0NCj4gKw0KPiArCXBhZ2UtPnZhID0gKGRicmVjb3Jkc192YSAmIFBBR0VfTUFTSyk7DQo+
ICsJcGFnZS0+cmVmY250ID0gMDsNCj4gKw0KPiArCXBhZ2UtPnVtZW0gPSBpYl91bWVtX2dldChj
dHgtPmlidWNvbnRleHQuZGV2aWNlLCBkYnJlY29yZHNfdmEgJg0KPiBQQUdFX01BU0ssIFBBR0Vf
U0laRSwgMCk7DQo+ICsJaWYgKElTX0VSUihwYWdlLT51bWVtKSkgew0KPiArCQlydiA9IFBUUl9F
UlIocGFnZS0+dW1lbSk7DQo+ICsJCWtmcmVlKHBhZ2UpOw0KPiArCQlnb3RvIG91dDsNCj4gKwl9
DQo+ICsNCj4gKwlsaXN0X2FkZCgmcGFnZS0+bGlzdCwgJmN0eC0+ZGJyZWNvcmRzX3BhZ2VfbGlz
dCk7DQo+ICsNCj4gK2ZvdW5kOg0KPiArCSpkbWFfYWRkciA9IHNnX2RtYV9hZGRyZXNzKHBhZ2Ut
PnVtZW0tPnNndF9hcHBlbmQuc2d0LnNnbCkgKw0KPiAoZGJyZWNvcmRzX3ZhICYgflBBR0VfTUFT
Syk7DQo+ICsJKmRicl9wYWdlID0gcGFnZTsNCj4gKwlwYWdlLT5yZWZjbnQrKzsNCj4gKw0KPiAr
b3V0Og0KPiArCW11dGV4X3VubG9jaygmY3R4LT5kYnJlY29yZHNfcGFnZV9tdXRleCk7DQo+ICsJ
cmV0dXJuIHJ2Ow0KPiArfQ0KPiArDQo+ICtzdGF0aWMgdm9pZA0KPiArZXJkbWFfdW5tYXBfdXNl
cl9kYnJlY29yZHMoc3RydWN0IGVyZG1hX3Vjb250ZXh0ICpjdHgsDQo+ICsJCQkgICBzdHJ1Y3Qg
ZXJkbWFfdXNlcl9kYnJlY29yZHNfcGFnZSAqKmRicl9wYWdlKQ0KPiArew0KPiArCWlmICghY3R4
IHx8ICEoKmRicl9wYWdlKSkNCj4gKwkJcmV0dXJuOw0KPiArDQo+ICsJbXV0ZXhfbG9jaygmY3R4
LT5kYnJlY29yZHNfcGFnZV9tdXRleCk7DQo+ICsJaWYgKC0tKCpkYnJfcGFnZSktPnJlZmNudCA9
PSAwKSB7DQo+ICsJCWxpc3RfZGVsKCYoKmRicl9wYWdlKS0+bGlzdCk7DQo+ICsJCWliX3VtZW1f
cmVsZWFzZSgoKmRicl9wYWdlKS0+dW1lbSk7DQo+ICsJCWtmcmVlKCpkYnJfcGFnZSk7DQo+ICsJ
fQ0KPiArDQo+ICsJKmRicl9wYWdlID0gTlVMTDsNCj4gKwltdXRleF91bmxvY2soJmN0eC0+ZGJy
ZWNvcmRzX3BhZ2VfbXV0ZXgpOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgaW50IGluaXRfdXNlcl9x
cChzdHJ1Y3QgZXJkbWFfcXAgKnFwLCBzdHJ1Y3QgZXJkbWFfdWNvbnRleHQgKnVjdHgsDQo+ICsJ
CQl1NjQgdmEsIHUzMiBsZW4sIHU2NCBkYl9pbmZvX3ZhKQ0KPiArew0KPiArCWludCByZXQ7DQo+
ICsJZG1hX2FkZHJfdCBkYl9pbmZvX2RtYV9hZGRyOw0KPiArCXUzMiBycV9vZmZzZXQ7DQo+ICsN
Cj4gKwlxcC0+aXNfa2VybmVsX3FwID0gZmFsc2U7DQo+ICsJaWYgKGxlbiA8IChQQUdFX0FMSUdO
KHFwLT5hdHRycy5zcV9zaXplICogU1FFQkJfU0laRSkgKyBxcC0NCj4gPmF0dHJzLnJxX3NpemUg
KiBSUUVfU0laRSkpIHsNCj4gKwkJaWJkZXZfZXJyKCZxcC0+ZGV2LT5pYmRldiwgInF1ZXVlIGxl
biBlcnJvciBxYnVmKCV1KSBzcSgldSkNCj4gcnEoJXUpLlxuIiwgbGVuLA0KPiArCQkJICBxcC0+
YXR0cnMuc3Ffc2l6ZSwgcXAtPmF0dHJzLnJxX3NpemUpOw0KPiArCQlyZXR1cm4gLUVJTlZBTDsN
Cj4gKwl9DQo+ICsNCj4gKwlyZXQgPSBnZXRfbXR0X2VudHJpZXMocXAtPmRldiwgJnFwLT51c2Vy
X3FwLnNxX210dCwgdmEsIHFwLQ0KPiA+YXR0cnMuc3Ffc2l6ZSA8PCBTUUVCQl9TSElGVCwNCj4g
KwkJCSAgICAgIDAsIHZhLCAoU1pfMU0gLSBTWl80SyksIDEpOw0KPiArCWlmIChyZXQpDQo+ICsJ
CWdvdG8gZXJyX291dDsNCj4gKw0KPiArCXJxX29mZnNldCA9IFBBR0VfQUxJR04ocXAtPmF0dHJz
LnNxX3NpemUgPDwgU1FFQkJfU0hJRlQpOw0KPiArCXFwLT51c2VyX3FwLnJxX29mZnNldCA9IHJx
X29mZnNldDsNCj4gKw0KPiArCXJldCA9IGdldF9tdHRfZW50cmllcyhxcC0+ZGV2LCAmcXAtPnVz
ZXJfcXAucnFfbXR0LCB2YSArIHJxX29mZnNldCwNCj4gKwkJCSAgICAgIHFwLT5hdHRycy5ycV9z
aXplIDw8IFJRRV9TSElGVCwgMCwgdmEgKyBycV9vZmZzZXQsDQo+IChTWl8xTSAtIFNaXzRLKSwN
Cj4gKwkJCSAgICAgIDEpOw0KPiArCWlmIChyZXQpDQo+ICsJCWdvdG8gZXJyX291dDsNCj4gKw0K
PiArCXJldCA9IGVyZG1hX21hcF91c2VyX2RicmVjb3Jkcyh1Y3R4LCBkYl9pbmZvX3ZhLCAmcXAt
DQo+ID51c2VyX3FwLnVzZXJfZGJyX3BhZ2UsDQo+ICsJCQkJICAgICAgICZkYl9pbmZvX2RtYV9h
ZGRyKTsNCj4gKwlpZiAocmV0KQ0KPiArCQlnb3RvIGVycl9vdXQ7DQo+ICsNCj4gKwlxcC0+dXNl
cl9xcC5zcV9kYl9pbmZvX2RtYV9hZGRyID0gZGJfaW5mb19kbWFfYWRkcjsNCj4gKwlxcC0+dXNl
cl9xcC5ycV9kYl9pbmZvX2RtYV9hZGRyID0gZGJfaW5mb19kbWFfYWRkciArIDg7DQo+ICsNCj4g
KwlyZXR1cm4gMDsNCj4gKw0KPiArZXJyX291dDoNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiAr
DQo+ICtzdGF0aWMgdm9pZCBmcmVlX3VzZXJfcXAoc3RydWN0IGVyZG1hX3FwICpxcCwgc3RydWN0
IGVyZG1hX3Vjb250ZXh0DQo+ICp1Y3R4KQ0KPiArew0KPiArCXB1dF9tdHRfZW50cmllcyhxcC0+
ZGV2LCAmcXAtPnVzZXJfcXAuc3FfbXR0KTsNCj4gKwlwdXRfbXR0X2VudHJpZXMocXAtPmRldiwg
JnFwLT51c2VyX3FwLnJxX210dCk7DQo+ICsJZXJkbWFfdW5tYXBfdXNlcl9kYnJlY29yZHModWN0
eCwgJnFwLT51c2VyX3FwLnVzZXJfZGJyX3BhZ2UpOw0KPiArfQ0KPiArDQo+ICtpbnQgZXJkbWFf
Y3JlYXRlX3FwKHN0cnVjdCBpYl9xcCAqaWJxcCwgc3RydWN0IGliX3FwX2luaXRfYXR0ciAqYXR0
cnMsDQo+IHN0cnVjdCBpYl91ZGF0YSAqdWRhdGEpDQo+ICt7DQo+ICsJc3RydWN0IGVyZG1hX3Fw
ICpxcCA9IHRvX2VxcChpYnFwKTsNCj4gKwlzdHJ1Y3QgZXJkbWFfZGV2ICpkZXYgPSB0b19lZGV2
KGlicXAtPmRldmljZSk7DQo+ICsJc3RydWN0IGVyZG1hX3Vjb250ZXh0ICp1Y3R4ID0NCj4gKwkJ
cmRtYV91ZGF0YV90b19kcnZfY29udGV4dCh1ZGF0YSwgc3RydWN0IGVyZG1hX3Vjb250ZXh0LA0K
PiBpYnVjb250ZXh0KTsNCj4gKwlzdHJ1Y3QgZXJkbWFfdXJlcV9jcmVhdGVfcXAgdXJlcTsNCj4g
KwlzdHJ1Y3QgZXJkbWFfdXJlc3BfY3JlYXRlX3FwIHVyZXNwOw0KPiArCWludCByZXQ7DQo+ICsN
Cj4gKwlyZXQgPSBlcmRtYV9xcF92YWxpZGF0ZV9jYXAoZGV2LCBhdHRycyk7DQo+ICsJaWYgKHJl
dCkNCj4gKwkJZ290byBlcnJfb3V0Ow0KPiArDQo+ICsJcmV0ID0gZXJkbWFfcXBfdmFsaWRhdGVf
YXR0cihkZXYsIGF0dHJzKTsNCj4gKwlpZiAocmV0KQ0KPiArCQlnb3RvIGVycl9vdXQ7DQo+ICsN
Cj4gKwlxcC0+c2NxID0gdG9fZWNxKGF0dHJzLT5zZW5kX2NxKTsNCj4gKwlxcC0+cmNxID0gdG9f
ZWNxKGF0dHJzLT5yZWN2X2NxKTsNCj4gKwlxcC0+ZGV2ID0gZGV2Ow0KPiArDQo+ICsJaW5pdF9y
d3NlbSgmcXAtPnN0YXRlX2xvY2spOw0KPiArCWtyZWZfaW5pdCgmcXAtPnJlZik7DQo+ICsJaW5p
dF9jb21wbGV0aW9uKCZxcC0+c2FmZV9mcmVlKTsNCj4gKw0KPiArCXJldCA9IHhhX2FsbG9jX2N5
Y2xpYygmZGV2LT5xcF94YSwgJnFwLT5pYnFwLnFwX251bSwgcXAsDQo+ICsJCQkgICAgICBYQV9M
SU1JVCgxLCBkZXYtPmF0dHJzLm1heF9xcCAtIDEpLCAmZGV2LQ0KPiA+bmV4dF9hbGxvY19xcG4s
DQo+ICsJCQkgICAgICBHRlBfS0VSTkVMKTsNCj4gKwlpZiAocmV0IDwgMCkgew0KPiArCQlyZXQg
PSAtRU5PTUVNOw0KPiArCQlnb3RvIGVycl9vdXQ7DQo+ICsJfQ0KPiArDQo+ICsJcXAtPmF0dHJz
LnNxX3NpemUgPSByb3VuZHVwX3Bvd19vZl90d28oYXR0cnMtPmNhcC5tYXhfc2VuZF93ciAqDQo+
IEVSRE1BX01BWF9XUUVCQl9QRVJfU1FFKTsNCj4gKwlxcC0+YXR0cnMucnFfc2l6ZSA9IHJvdW5k
dXBfcG93X29mX3R3byhhdHRycy0+Y2FwLm1heF9yZWN2X3dyKTsNCj4gKw0KPiArCWlmICh1Y3R4
KSB7DQo+ICsJCXJldCA9IGliX2NvcHlfZnJvbV91ZGF0YSgmdXJlcSwgdWRhdGEsIG1pbihzaXpl
b2YodXJlcSksDQo+IHVkYXRhLT5pbmxlbikpOw0KPiArCQlpZiAocmV0KQ0KPiArCQkJZ290byBl
cnJfb3V0X3hhOw0KPiArDQo+ICsJCWluaXRfdXNlcl9xcChxcCwgdWN0eCwgdXJlcS5xYnVmX3Zh
LCB1cmVxLnFidWZfbGVuLA0KPiB1cmVxLmRiX3JlY29yZF92YSk7DQo+ICsNCj4gKwkJbWVtc2V0
KCZ1cmVzcCwgMCwgc2l6ZW9mKHVyZXNwKSk7DQo+ICsNCj4gKwkJdXJlc3AubnVtX3NxZSA9IHFw
LT5hdHRycy5zcV9zaXplOw0KPiArCQl1cmVzcC5udW1fcnFlID0gcXAtPmF0dHJzLnJxX3NpemU7
DQo+ICsJCXVyZXNwLnFwX2lkID0gUVBfSUQocXApOw0KPiArCQl1cmVzcC5ycV9vZmZzZXQgPSBx
cC0+dXNlcl9xcC5ycV9vZmZzZXQ7DQo+ICsNCj4gKwkJcmV0ID0gaWJfY29weV90b191ZGF0YSh1
ZGF0YSwgJnVyZXNwLCBzaXplb2YodXJlc3ApKTsNCj4gKwkJaWYgKHJldCkNCj4gKwkJCWdvdG8g
ZXJyX291dF94YTsNCj4gKwl9IGVsc2Ugew0KPiArCQlpbml0X2tlcm5lbF9xcChkZXYsIHFwLCBh
dHRycyk7DQo+ICsJfQ0KPiArDQo+ICsJcXAtPmF0dHJzLm1heF9zZW5kX3NnZSA9IGF0dHJzLT5j
YXAubWF4X3NlbmRfc2dlOw0KPiArCXFwLT5hdHRycy5tYXhfcmVjdl9zZ2UgPSBhdHRycy0+Y2Fw
Lm1heF9yZWN2X3NnZTsNCj4gKwlxcC0+YXR0cnMuc3RhdGUgPSBFUkRNQV9RUF9TVEFURV9JRExF
Ow0KPiArDQo+ICsJcmV0ID0gY3JlYXRlX3FwX2NtZChkZXYsIHFwKTsNCj4gKwlpZiAocmV0KQ0K
PiArCQlnb3RvIGVycl9vdXRfY21kOw0KPiArDQo+ICsJc3Bpbl9sb2NrX2luaXQoJnFwLT5sb2Nr
KTsNCj4gKwlhdG9taWNfaW5jKCZkZXYtPm51bV9xcCk7DQo+ICsNCj4gKwlyZXR1cm4gMDsNCj4g
Kw0KPiArZXJyX291dF9jbWQ6DQo+ICsJaWYgKHFwLT5pc19rZXJuZWxfcXApDQo+ICsJCWZyZWVf
a2VybmVsX3FwKHFwKTsNCj4gKwllbHNlDQo+ICsJCWZyZWVfdXNlcl9xcChxcCwgdWN0eCk7DQo+
ICtlcnJfb3V0X3hhOg0KPiArCXhhX2VyYXNlKCZkZXYtPnFwX3hhLCBRUF9JRChxcCkpOw0KPiAr
ZXJyX291dDoNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+ICtzdGF0aWMgaW50IGVyZG1h
X2NyZWF0ZV9zdGFnKHN0cnVjdCBlcmRtYV9kZXYgKmRldiwgdTMyICpzdGFnKQ0KPiArew0KPiAr
CWludCBzdGFnX2lkeDsNCj4gKwl1MzIga2V5ID0gMDsNCj4gKw0KPiArCXN0YWdfaWR4ID0gZXJk
bWFfYWxsb2NfaWR4KCZkZXYtPnJlc19jYltFUkRNQV9SRVNfVFlQRV9TVEFHX0lEWF0pOw0KPiAr
CWlmIChzdGFnX2lkeCA8IDApDQo+ICsJCXJldHVybiBzdGFnX2lkeDsNCj4gKw0KPiArCSpzdGFn
ID0gKHN0YWdfaWR4IDw8IDgpIHwgKGtleSAmIDB4RkYpOw0KPiArDQo+ICsJcmV0dXJuIDA7DQo+
ICt9DQo+ICsNCj4gK3N0cnVjdCBpYl9tciAqZXJkbWFfZ2V0X2RtYV9tcihzdHJ1Y3QgaWJfcGQg
KmlicGQsIGludCBtcl9hY2Nlc3NfZmxhZ3MpDQo+ICt7DQo+ICsJc3RydWN0IGVyZG1hX21yICpt
cjsNCj4gKwlzdHJ1Y3QgZXJkbWFfZGV2ICpkZXYgPSB0b19lZGV2KGlicGQtPmRldmljZSk7DQo+
ICsJaW50IHJldDsNCj4gKwl1MzIgc3RhZzsNCj4gKw0KPiArCW1yID0ga3phbGxvYyhzaXplb2Yo
Km1yKSwgR0ZQX0tFUk5FTCk7DQo+ICsJaWYgKCFtcikNCj4gKwkJcmV0dXJuIEVSUl9QVFIoLUVO
T01FTSk7DQo+ICsNCj4gKwlyZXQgPSBlcmRtYV9jcmVhdGVfc3RhZyhkZXYsICZzdGFnKTsNCj4g
KwlpZiAocmV0KQ0KPiArCQlnb3RvIG91dF9mcmVlOw0KPiArDQo+ICsJbXItPnR5cGUgPSBFUkRN
QV9NUl9UWVBFX0RNQTsNCj4gKw0KPiArCW1yLT5pYm1yLmxrZXkgPSBzdGFnOw0KPiArCW1yLT5p
Ym1yLnJrZXkgPSBzdGFnOw0KPiArCW1yLT5pYm1yLnBkID0gaWJwZDsNCj4gKwltci0+YWNjZXNz
ID0gRVJETUFfTVJfQUNDX0xSIHwNCj4gKwkJICAgICAobXJfYWNjZXNzX2ZsYWdzICYgSUJfQUND
RVNTX1JFTU9URV9SRUFEID8NCj4gRVJETUFfTVJfQUNDX1JSIDogMCkgfA0KPiArCQkgICAgICht
cl9hY2Nlc3NfZmxhZ3MgJiBJQl9BQ0NFU1NfTE9DQUxfV1JJVEUgPw0KPiBFUkRNQV9NUl9BQ0Nf
TFcgOiAwKSB8DQo+ICsJCSAgICAgKG1yX2FjY2Vzc19mbGFncyAmIElCX0FDQ0VTU19SRU1PVEVf
V1JJVEUgPw0KPiBFUkRNQV9NUl9BQ0NfUlcgOiAwKTsNCj4gKwlyZXQgPSByZWdtcl9jbWQoZGV2
LCBtcik7DQo+ICsJaWYgKHJldCkgew0KPiArCQlyZXQgPSAtRUlPOw0KPiArCQlnb3RvIG91dF9y
ZW1vdmVfc3RhZzsNCj4gKwl9DQo+ICsNCj4gKwlhdG9taWNfaW5jKCZkZXYtPm51bV9tcik7DQo+
ICsJcmV0dXJuICZtci0+aWJtcjsNCj4gKw0KPiArb3V0X3JlbW92ZV9zdGFnOg0KPiArCWVyZG1h
X2ZyZWVfaWR4KCZkZXYtPnJlc19jYltFUkRNQV9SRVNfVFlQRV9TVEFHX0lEWF0sIG1yLT5pYm1y
LmxrZXkNCj4gPj4gOCk7DQo+ICsNCj4gK291dF9mcmVlOg0KPiArCWtmcmVlKG1yKTsNCj4gKw0K
PiArCXJldHVybiBFUlJfUFRSKHJldCk7DQo+ICt9DQo+ICsNCj4gK3N0cnVjdCBpYl9tciAqZXJk
bWFfaWJfYWxsb2NfbXIoc3RydWN0IGliX3BkICppYnBkLCBlbnVtIGliX21yX3R5cGUNCj4gbXJf
dHlwZSwgdTMyIG1heF9udW1fc2cpDQo+ICt7DQo+ICsJc3RydWN0IGVyZG1hX21yICptcjsNCj4g
KwlzdHJ1Y3QgZXJkbWFfZGV2ICpkZXYgPSB0b19lZGV2KGlicGQtPmRldmljZSk7DQo+ICsJaW50
IHJldDsNCj4gKwl1MzIgc3RhZzsNCj4gKw0KPiArCWlmIChtcl90eXBlICE9IElCX01SX1RZUEVf
TUVNX1JFRykNCj4gKwkJcmV0dXJuIEVSUl9QVFIoLUVPUE5PVFNVUFApOw0KPiArDQo+ICsJaWYg
KG1heF9udW1fc2cgPiBFUkRNQV9NUl9NQVhfTVRUX0NOVCkgew0KDQpEb2VzIGVyZG1hIHJlYWxs
eSBhY2NlcHQgNTI0Mjg4IGxpc3QgZW50cmllcywgb3IgaXMNCnRoYXQgYSB0eXBvPw0KDQo+ICsJ
CWliZGV2X2VycigmZGV2LT5pYmRldiwgIm1heF9udW1fc2cgdG9vIGxhcmdlOiV1IiwgbWF4X251
bV9zZyk7DQo+ICsJCXJldHVybiBFUlJfUFRSKC1FSU5WQUwpOw0KPiArCX0NCj4gKw0KPiArCW1y
ID0ga3phbGxvYyhzaXplb2YoKm1yKSwgR0ZQX0tFUk5FTCk7DQo+ICsJaWYgKCFtcikNCj4gKwkJ
cmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7DQo+ICsNCj4gKwlyZXQgPSBlcmRtYV9jcmVhdGVfc3Rh
ZyhkZXYsICZzdGFnKTsNCj4gKwlpZiAocmV0KQ0KPiArCQlnb3RvIG91dF9mcmVlOw0KPiArDQo+
ICsJbXItPnR5cGUgPSBFUkRNQV9NUl9UWVBFX0ZSTVI7DQo+ICsNCj4gKwltci0+aWJtci5sa2V5
ID0gc3RhZzsNCj4gKwltci0+aWJtci5ya2V5ID0gc3RhZzsNCj4gKwltci0+aWJtci5wZCA9IGli
cGQ7DQo+ICsJLyogdXBkYXRlIGl0IGluIEZSTVIuICovDQo+ICsJbXItPmFjY2VzcyA9IEVSRE1B
X01SX0FDQ19MUiB8IEVSRE1BX01SX0FDQ19MVyB8IEVSRE1BX01SX0FDQ19SUiB8DQo+IEVSRE1B
X01SX0FDQ19SVzsNCj4gKw0KPiArCW1yLT5tZW0ucGFnZV9zaXplID0gUEFHRV9TSVpFOyAvKiB1
cGRhdGUgaXQgbGF0ZXIuICovDQo+ICsJbXItPm1lbS5wYWdlX2NudCA9IG1heF9udW1fc2c7DQo+
ICsJbXItPm1lbS5tdHRfdHlwZSA9IEVSRE1BX01SX0lORElSRUNUX01UVDsNCj4gKwltci0+bWVt
Lm10dF9idWYgPSBhbGxvY19wYWdlc19leGFjdChNVFRfU0laRShtci0+bWVtLnBhZ2VfY250KSwN
Cj4gR0ZQX0tFUk5FTCk7DQo+ICsJaWYgKCFtci0+bWVtLm10dF9idWYpIHsNCj4gKwkJcmV0ID0g
LUVOT01FTTsNCj4gKwkJZ290byBvdXRfcmVtb3ZlX3N0YWc7DQo+ICsJfQ0KPiArDQo+ICsJbXIt
Pm1lbS5tdHRfZW50cnlbMF0gPSBkbWFfbWFwX3NpbmdsZShkZXYtPmRtYWRldiwgbXItPm1lbS5t
dHRfYnVmLA0KPiArCQkJCQkgICAgICBNVFRfU0laRShtci0+bWVtLnBhZ2VfY250KSwNCj4gRE1B
X1RPX0RFVklDRSk7DQo+ICsJaWYgKGRtYV9tYXBwaW5nX2Vycm9yKGRldi0+ZG1hZGV2LCBtci0+
bWVtLm10dF9lbnRyeVswXSkpIHsNCj4gKwkJcmV0ID0gLUVOT01FTTsNCj4gKwkJZ290byBvdXRf
ZnJlZV9tdHQ7DQo+ICsJfQ0KPiArDQo+ICsJcmV0ID0gcmVnbXJfY21kKGRldiwgbXIpOw0KPiAr
CWlmIChyZXQpIHsNCj4gKwkJcmV0ID0gLUVJTzsNCj4gKwkJZ290byBvdXRfZG1hX3VubWFwOw0K
PiArCX0NCj4gKw0KPiArCWF0b21pY19pbmMoJmRldi0+bnVtX21yKTsNCj4gKwlyZXR1cm4gJm1y
LT5pYm1yOw0KPiArDQo+ICtvdXRfZG1hX3VubWFwOg0KPiArCWRtYV91bm1hcF9zaW5nbGUoZGV2
LT5kbWFkZXYsIG1yLT5tZW0ubXR0X2VudHJ5WzBdLCBNVFRfU0laRShtci0NCj4gPm1lbS5wYWdl
X2NudCksDQo+ICsJCQkgRE1BX1RPX0RFVklDRSk7DQo+ICtvdXRfZnJlZV9tdHQ6DQo+ICsJZnJl
ZV9wYWdlc19leGFjdChtci0+bWVtLm10dF9idWYsIE1UVF9TSVpFKG1yLT5tZW0ucGFnZV9jbnQp
KTsNCj4gKw0KPiArb3V0X3JlbW92ZV9zdGFnOg0KPiArCWVyZG1hX2ZyZWVfaWR4KCZkZXYtPnJl
c19jYltFUkRNQV9SRVNfVFlQRV9TVEFHX0lEWF0sIG1yLT5pYm1yLmxrZXkNCj4gPj4gOCk7DQo+
ICsNCj4gK291dF9mcmVlOg0KPiArCWtmcmVlKG1yKTsNCj4gKw0KPiArCXJldHVybiBFUlJfUFRS
KHJldCk7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyBpbnQgZXJkbWFfc2V0X3BhZ2Uoc3RydWN0IGli
X21yICppYm1yLCB1NjQgYWRkcikNCj4gK3sNCj4gKwlzdHJ1Y3QgZXJkbWFfbXIgKm1yID0gdG9f
ZW1yKGlibXIpOw0KPiArDQo+ICsJaWYgKG1yLT5tZW0ubXR0X25lbnRzID49IG1yLT5tZW0ucGFn
ZV9jbnQpDQo+ICsJCXJldHVybiAtMTsNCj4gKw0KPiArCSooKHU2NCAqKW1yLT5tZW0ubXR0X2J1
ZiArIG1yLT5tZW0ubXR0X25lbnRzKSA9IGFkZHI7DQo+ICsJbXItPm1lbS5tdHRfbmVudHMrKzsN
Cj4gKw0KPiArCXJldHVybiAwOw0KPiArfQ0KPiArDQo+ICtpbnQgZXJkbWFfbWFwX21yX3NnKHN0
cnVjdCBpYl9tciAqaWJtciwgc3RydWN0IHNjYXR0ZXJsaXN0ICpzZywgaW50DQo+IHNnX25lbnRz
LA0KPiArCQkgICAgdW5zaWduZWQgaW50ICpzZ19vZmZzZXQpDQo+ICt7DQo+ICsJc3RydWN0IGVy
ZG1hX21yICptciA9IHRvX2VtcihpYm1yKTsNCj4gKwlpbnQgbnVtOw0KPiArDQo+ICsJbXItPm1l
bS5tdHRfbmVudHMgPSAwOw0KPiArDQo+ICsJbnVtID0gaWJfc2dfdG9fcGFnZXMoJm1yLT5pYm1y
LCBzZywgc2dfbmVudHMsIHNnX29mZnNldCwNCj4gZXJkbWFfc2V0X3BhZ2UpOw0KPiArDQo+ICsJ
cmV0dXJuIG51bTsNCj4gK30NCj4gKw0KPiArc3RydWN0IGliX21yICplcmRtYV9yZWdfdXNlcl9t
cihzdHJ1Y3QgaWJfcGQgKmlicGQsIHU2NCBzdGFydCwgdTY0IGxlbiwNCj4gKwkJCQl1NjQgdmly
dCwgaW50IGFjY2Vzcywgc3RydWN0IGliX3VkYXRhICp1ZGF0YSkNCj4gK3sNCj4gKwlzdHJ1Y3Qg
ZXJkbWFfbXIgKm1yID0gTlVMTDsNCj4gKwlzdHJ1Y3QgZXJkbWFfZGV2ICpkZXYgPSB0b19lZGV2
KGlicGQtPmRldmljZSk7DQo+ICsJdTMyIHN0YWc7DQo+ICsJaW50IHJldDsNCj4gKw0KPiArCWlm
ICghbGVuIHx8IGxlbiA+IGRldi0+YXR0cnMubWF4X21yX3NpemUpIHsNCj4gKwkJaWJkZXZfZXJy
KCZkZXYtPmliZGV2LCAiRVJST1I6IE91dCBvZiBtciBzaXplOiAlbGx1LCBtYXgNCj4gJWxsdVxu
IiwNCj4gKwkJCWxlbiwgZGV2LT5hdHRycy5tYXhfbXJfc2l6ZSk7DQo+ICsJCXJldHVybiBFUlJf
UFRSKC1FSU5WQUwpOw0KPiArCX0NCj4gKw0KPiArCW1yID0ga3phbGxvYyhzaXplb2YoKm1yKSwg
R0ZQX0tFUk5FTCk7DQo+ICsJaWYgKCFtcikNCj4gKwkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7
DQo+ICsNCj4gKwlyZXQgPSBnZXRfbXR0X2VudHJpZXMoZGV2LCAmbXItPm1lbSwgc3RhcnQsIGxl
biwgYWNjZXNzLCB2aXJ0LCBTWl8yRw0KPiAtIFNaXzRLLCAwKTsNCj4gKwlpZiAocmV0KQ0KPiAr
CQlnb3RvIGVycl9vdXRfZnJlZTsNCj4gKw0KPiArCXJldCA9IGVyZG1hX2NyZWF0ZV9zdGFnKGRl
diwgJnN0YWcpOw0KPiArCWlmIChyZXQpDQo+ICsJCWdvdG8gZXJyX291dF9wdXRfbXR0Ow0KPiAr
DQo+ICsJbXItPmlibXIubGtleSA9IG1yLT5pYm1yLnJrZXkgPSBzdGFnOw0KPiArCW1yLT5pYm1y
LnBkID0gaWJwZDsNCj4gKwltci0+bWVtLnZhID0gdmlydDsNCj4gKwltci0+bWVtLmxlbiA9IGxl
bjsNCj4gKwltci0+YWNjZXNzID0gRVJETUFfTVJfQUNDX0xSIHwgKGFjY2VzcyAmIElCX0FDQ0VT
U19SRU1PVEVfUkVBRCA/DQo+IEVSRE1BX01SX0FDQ19SUiA6IDApIHwNCj4gKwkJICAgICAoYWNj
ZXNzICYgSUJfQUNDRVNTX0xPQ0FMX1dSSVRFID8gRVJETUFfTVJfQUNDX0xXIDogMCkgfA0KPiAr
CQkgICAgIChhY2Nlc3MgJiBJQl9BQ0NFU1NfUkVNT1RFX1dSSVRFID8gRVJETUFfTVJfQUNDX1JX
IDogMCk7DQo+ICsJbXItPnZhbGlkID0gMTsNCj4gKwltci0+dHlwZSA9IEVSRE1BX01SX1RZUEVf
Tk9STUFMOw0KPiArDQo+ICsJcmV0ID0gcmVnbXJfY21kKGRldiwgbXIpOw0KPiArCWlmIChyZXQp
IHsNCj4gKwkJcmV0ID0gLUVJTzsNCj4gKwkJZ290byBlcnJfb3V0X21yOw0KPiArCX0NCj4gKw0K
PiArCWF0b21pY19pbmMoJmRldi0+bnVtX21yKTsNCg0KVGhpcyBkZXYtPm51bV9tciB0aGluZyBn
ZXRzIGluaXRpYWxpemVkLCBpbmNyZW1lbnRlZCBhbmQgZGVjcmVtZW50ZWQgaGVyZQ0KYW5kIHRo
ZXJlLCBidXQgaXMgbmV2ZXIgY2hlY2tlZC4gU28gaXQgaGFzIG5vIG1lYW5pbmcuIEl0IHNlZW1z
IG1heCBNUiBpcw0KZW5mb3JjZWQgdmlhIG1heCBwb3NzaWJsZSBTVGFncy4NCg0KU2FtZSBpcyB0
cnVlIGZvciBkZXZpY2VzIG51bV9xcCwgbnVtX2NxLCBudW1fcGQgY291bnRlcnMuIFRoZSBpbnRl
bnQgcHJvYmFibHkNCndhcyB0byBlbmZvcmNlIHJlc291cmNlIGxpbWl0cy4gSG93IGlzIHRoYXQg
ZG9uZSB0b2RheT8NCkluIGFueSBjYXNlLCB0aGV5IGFyZSBuZXZlciBjaGVja2VkLiBTbyBqdXN0
IHJlbW92ZSB0aGF0LCBhbmQgY2hlY2sgaWYNCnJlc291cmNlIGxpbWl0cyBhcmUgZW5mb3JjZWQg
Y29ycmVjdGx5IG90aGVyd2lzZS4NCiANCj4gKw0KPiArCXJldHVybiAmbXItPmlibXI7DQo+ICsN
Cj4gK2Vycl9vdXRfbXI6DQo+ICsJZXJkbWFfZnJlZV9pZHgoJmRldi0+cmVzX2NiW0VSRE1BX1JF
U19UWVBFX1NUQUdfSURYXSwgbXItPmlibXIubGtleQ0KPiA+PiA4KTsNCj4gKw0KPiArZXJyX291
dF9wdXRfbXR0Og0KPiArCXB1dF9tdHRfZW50cmllcyhkZXYsICZtci0+bWVtKTsNCj4gKw0KPiAr
ZXJyX291dF9mcmVlOg0KPiArCWtmcmVlKG1yKTsNCj4gKw0KPiArCXJldHVybiBFUlJfUFRSKHJl
dCk7DQo+ICt9DQo+ICsNCj4gK2ludCBlcmRtYV9kZXJlZ19tcihzdHJ1Y3QgaWJfbXIgKmlibXIs
IHN0cnVjdCBpYl91ZGF0YSAqdWRhdGEpDQo+ICt7DQo+ICsJc3RydWN0IGVyZG1hX21yICptcjsN
Cj4gKwlzdHJ1Y3QgZXJkbWFfZGV2ICpkZXYgPSB0b19lZGV2KGlibXItPmRldmljZSk7DQo+ICsJ
c3RydWN0IGVyZG1hX2NtZHFfZGVyZWdfbXJfcmVxIHJlcTsNCj4gKwlpbnQgcmV0Ow0KPiArDQo+
ICsJbXIgPSB0b19lbXIoaWJtcik7DQo+ICsNCj4gKwlFUkRNQV9DTURRX0JVSUxEX1JFUV9IRFIo
JnJlcSwgQ01EUV9TVUJNT0RfUkRNQSwNCj4gQ01EUV9PUENPREVfREVSRUdfTVIpOw0KPiArDQo+
ICsJcmVxLmNmZzAgPSBGSUVMRF9QUkVQKEVSRE1BX0NNRF9NUl9NUFRfSURYX01BU0ssIGlibXIt
PmxrZXkgPj4gOCkgfA0KPiArCQkgICBGSUVMRF9QUkVQKEVSRE1BX0NNRF9NUl9LRVlfTUFTSywg
aWJtci0+bGtleSAmIDB4RkYpOw0KPiArDQo+ICsJcmV0ID0gZXJkbWFfcG9zdF9jbWRfd2FpdChk
ZXYtPmNtZHEsICh1NjQgKikmcmVxLCBzaXplb2YocmVxKSwgTlVMTCwNCj4gTlVMTCk7DQo+ICsJ
aWYgKHJldCkgew0KPiArCQlkZXZfZXJyKGRldi0+ZG1hZGV2LCAiRVJST1I6IGVyciBjb2RlID0g
JWQsIGNtZCBvZiBkZXJlZyBtcg0KPiBmYWlsZWQuXG4iLCByZXQpOw0KPiArCQlyZXR1cm4gcmV0
Ow0KPiArCX0NCj4gKw0KPiArCWVyZG1hX2ZyZWVfaWR4KCZkZXYtPnJlc19jYltFUkRNQV9SRVNf
VFlQRV9TVEFHX0lEWF0sIGlibXItPmxrZXkgPj4NCj4gOCk7DQo+ICsJYXRvbWljX2RlYygmZGV2
LT5udW1fbXIpOw0KPiArDQo+ICsJcHV0X210dF9lbnRyaWVzKGRldiwgJm1yLT5tZW0pOw0KPiAr
DQo+ICsJa2ZyZWUobXIpOw0KPiArCXJldHVybiAwOw0KPiArfQ0KPiArDQo+ICtpbnQgZXJkbWFf
ZGVzdHJveV9jcShzdHJ1Y3QgaWJfY3EgKmliY3EsIHN0cnVjdCBpYl91ZGF0YSAqdWRhdGEpDQo+
ICt7DQo+ICsJc3RydWN0IGVyZG1hX2NxICpjcSA9IHRvX2VjcShpYmNxKTsNCj4gKwlzdHJ1Y3Qg
ZXJkbWFfZGV2ICpkZXYgPSB0b19lZGV2KGliY3EtPmRldmljZSk7DQo+ICsJc3RydWN0IGVyZG1h
X3Vjb250ZXh0ICpjdHggPQ0KPiArCQlyZG1hX3VkYXRhX3RvX2Rydl9jb250ZXh0KHVkYXRhLCBz
dHJ1Y3QgZXJkbWFfdWNvbnRleHQsDQo+IGlidWNvbnRleHQpOw0KPiArCWludCBlcnI7DQo+ICsJ
c3RydWN0IGVyZG1hX2NtZHFfZGVzdHJveV9jcV9yZXEgcmVxOw0KPiArDQo+ICsJRVJETUFfQ01E
UV9CVUlMRF9SRVFfSERSKCZyZXEsIENNRFFfU1VCTU9EX1JETUEsDQo+IENNRFFfT1BDT0RFX0RF
U1RST1lfQ1EpOw0KPiArCXJlcS5jcW4gPSBjcS0+Y3FuOw0KPiArDQo+ICsJZXJyID0gZXJkbWFf
cG9zdF9jbWRfd2FpdChkZXYtPmNtZHEsICh1NjQgKikmcmVxLCBzaXplb2YocmVxKSwgTlVMTCwN
Cj4gTlVMTCk7DQo+ICsJaWYgKGVycikgew0KPiArCQlkZXZfZXJyKGRldi0+ZG1hZGV2LCAiRVJS
T1I6IGVyciBjb2RlID0gJWQsIGNtZCBvZiBkZXN0cm95IGNxDQo+IGZhaWxlZC5cbiIsIGVycik7
DQo+ICsJCXJldHVybiBlcnI7DQo+ICsJfQ0KPiArDQo+ICsJaWYgKGNxLT5pc19rZXJuZWxfY3Ep
IHsNCj4gKwkJZG1hX2ZyZWVfY29oZXJlbnQoZGV2LT5kbWFkZXYsIChjcS0+ZGVwdGggPDwgQ1FF
X1NISUZUKSArDQo+IEVSRE1BX0VYVFJBX0JVRkZFUl9TSVpFLA0KPiArCQkJCSAgY3EtPmtlcm5f
Y3EucWJ1ZiwgY3EtPmtlcm5fY3EucWJ1Zl9kbWFfYWRkcik7DQo+ICsJfSBlbHNlIHsNCj4gKwkJ
ZXJkbWFfdW5tYXBfdXNlcl9kYnJlY29yZHMoY3R4LCAmY3EtPnVzZXJfY3EudXNlcl9kYnJfcGFn
ZSk7DQo+ICsJCXB1dF9tdHRfZW50cmllcyhkZXYsICZjcS0+dXNlcl9jcS5xYnVmX210dCk7DQo+
ICsJfQ0KPiArDQo+ICsJeGFfZXJhc2UoJmRldi0+Y3FfeGEsIGNxLT5jcW4pOw0KPiArCWF0b21p
Y19kZWMoJmRldi0+bnVtX2NxKTsNCj4gKw0KPiArCXJldHVybiAwOw0KPiArfQ0KPiArDQo+ICtp
bnQgZXJkbWFfZGVzdHJveV9xcChzdHJ1Y3QgaWJfcXAgKmlicXAsIHN0cnVjdCBpYl91ZGF0YSAq
dWRhdGEpDQo+ICt7DQo+ICsJc3RydWN0IGVyZG1hX3FwICpxcCA9IHRvX2VxcChpYnFwKTsNCj4g
KwlzdHJ1Y3QgZXJkbWFfZGV2ICpkZXYgPSB0b19lZGV2KGlicXAtPmRldmljZSk7DQo+ICsJc3Ry
dWN0IGVyZG1hX3Vjb250ZXh0ICpjdHggPQ0KPiArCQlyZG1hX3VkYXRhX3RvX2Rydl9jb250ZXh0
KHVkYXRhLCBzdHJ1Y3QgZXJkbWFfdWNvbnRleHQsDQo+IGlidWNvbnRleHQpOw0KPiArCXN0cnVj
dCBlcmRtYV9xcF9hdHRycyBxcF9hdHRyczsNCj4gKwlpbnQgZXJyOw0KPiArCXN0cnVjdCBlcmRt
YV9jbWRxX2Rlc3Ryb3lfcXBfcmVxIHJlcTsNCj4gKw0KPiArCWRvd25fd3JpdGUoJnFwLT5zdGF0
ZV9sb2NrKTsNCj4gKwlxcF9hdHRycy5zdGF0ZSA9IEVSRE1BX1FQX1NUQVRFX0VSUk9SOw0KPiAr
CWVyZG1hX21vZGlmeV9xcF9pbnRlcm5hbChxcCwgJnFwX2F0dHJzLCBFUkRNQV9RUF9BVFRSX1NU
QVRFKTsNCj4gKwl1cF93cml0ZSgmcXAtPnN0YXRlX2xvY2spOw0KPiArDQo+ICsJRVJETUFfQ01E
UV9CVUlMRF9SRVFfSERSKCZyZXEsIENNRFFfU1VCTU9EX1JETUEsDQo+IENNRFFfT1BDT0RFX0RF
U1RST1lfUVApOw0KPiArCXJlcS5xcG4gPSBRUF9JRChxcCk7DQo+ICsNCj4gKwllcmRtYV9xcF9w
dXQocXApOw0KPiArCXdhaXRfZm9yX2NvbXBsZXRpb24oJnFwLT5zYWZlX2ZyZWUpOw0KPiArDQo+
ICsJZXJyID0gZXJkbWFfcG9zdF9jbWRfd2FpdChkZXYtPmNtZHEsICh1NjQgKikmcmVxLCBzaXpl
b2YocmVxKSwgTlVMTCwNCj4gTlVMTCk7DQo+ICsJaWYgKGVycikgew0KPiArCQlkZXZfZXJyKGRl
di0+ZG1hZGV2LCAiRVJST1I6IGVyciBjb2RlID0gJWQsIGNtZCBvZiBkZXN0cm95IHFwDQo+IGZh
aWxlZC5cbiIsIGVycik7DQo+ICsJCXVwX3dyaXRlKCZxcC0+c3RhdGVfbG9jayk7DQo+ICsJCXJl
dHVybiBlcnI7DQo+ICsJfQ0KPiArDQo+ICsJaWYgKHFwLT5pc19rZXJuZWxfcXApIHsNCj4gKwkJ
dmZyZWUocXAtPmtlcm5fcXAuc3dyX3RibCk7DQo+ICsJCXZmcmVlKHFwLT5rZXJuX3FwLnJ3cl90
YmwpOw0KPiArCQlkbWFfZnJlZV9jb2hlcmVudChkZXYtPmRtYWRldiwNCj4gKwkJCQkgIChxcC0+
YXR0cnMucnFfc2l6ZSA8PCBSUUVfU0hJRlQpICsNCj4gRVJETUFfRVhUUkFfQlVGRkVSX1NJWkUs
DQo+ICsJCQkJICBxcC0+a2Vybl9xcC5ycV9idWYsIHFwLQ0KPiA+a2Vybl9xcC5ycV9idWZfZG1h
X2FkZHIpOw0KPiArCQlkbWFfZnJlZV9jb2hlcmVudChkZXYtPmRtYWRldiwNCj4gKwkJCQkgIChx
cC0+YXR0cnMuc3Ffc2l6ZSA8PCBTUUVCQl9TSElGVCkgKw0KPiBFUkRNQV9FWFRSQV9CVUZGRVJf
U0laRSwNCj4gKwkJCQkgIHFwLT5rZXJuX3FwLnNxX2J1ZiwgcXAtDQo+ID5rZXJuX3FwLnNxX2J1
Zl9kbWFfYWRkcik7DQo+ICsJfSBlbHNlIHsNCj4gKwkJcHV0X210dF9lbnRyaWVzKGRldiwgJnFw
LT51c2VyX3FwLnNxX210dCk7DQo+ICsJCXB1dF9tdHRfZW50cmllcyhkZXYsICZxcC0+dXNlcl9x
cC5ycV9tdHQpOw0KPiArCQllcmRtYV91bm1hcF91c2VyX2RicmVjb3JkcyhjdHgsICZxcC0+dXNl
cl9xcC51c2VyX2Ricl9wYWdlKTsNCj4gKwl9DQo+ICsNCj4gKwlpZiAocXAtPmNlcCkNCj4gKwkJ
ZXJkbWFfY2VwX3B1dChxcC0+Y2VwKTsNCj4gKwl4YV9lcmFzZSgmZGV2LT5xcF94YSwgUVBfSUQo
cXApKTsNCj4gKwlhdG9taWNfZGVjKCZkZXYtPm51bV9xcCk7DQo+ICsNCj4gKwlyZXR1cm4gMDsN
Cj4gK30NCj4gKw0KPiArdm9pZCBlcmRtYV9xcF9nZXRfcmVmKHN0cnVjdCBpYl9xcCAqaWJxcCkN
Cj4gK3sNCj4gKwllcmRtYV9xcF9nZXQodG9fZXFwKGlicXApKTsNCj4gK30NCj4gKw0KPiArdm9p
ZCBlcmRtYV9xcF9wdXRfcmVmKHN0cnVjdCBpYl9xcCAqaWJxcCkNCj4gK3sNCj4gKwllcmRtYV9x
cF9wdXQodG9fZXFwKGlicXApKTsNCj4gK30NCj4gKw0KPiAraW50IGVyZG1hX21tYXAoc3RydWN0
IGliX3Vjb250ZXh0ICpjdHgsIHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hKQ0KPiArew0KPiAr
CXN0cnVjdCByZG1hX3VzZXJfbW1hcF9lbnRyeSAqcmRtYV9lbnRyeTsNCj4gKwlzdHJ1Y3QgZXJk
bWFfdXNlcl9tbWFwX2VudHJ5ICplbnRyeTsNCj4gKwlpbnQgZXJyID0gLUVJTlZBTDsNCj4gKw0K
PiArCWlmICh2bWEtPnZtX3N0YXJ0ICYgKFBBR0VfU0laRSAtIDEpKSB7DQo+ICsJCXByX3dhcm4o
IldBUk46IG1hcCBub3QgcGFnZSBhbGlnbmVkXG4iKTsNCj4gKwkJZ290byBvdXQ7DQo+ICsJfQ0K
PiArDQo+ICsJcmRtYV9lbnRyeSA9IHJkbWFfdXNlcl9tbWFwX2VudHJ5X2dldChjdHgsIHZtYSk7
DQo+ICsJaWYgKCFyZG1hX2VudHJ5KSB7DQo+ICsJCXByX3dhcm4oIldBUk46IG1tYXAgbG9va3Vw
IGZhaWxlZDogJWx4XG4iLCB2bWEtPnZtX3Bnb2ZmKTsNCj4gKwkJZ290byBvdXQ7DQo+ICsJfQ0K
PiArDQo+ICsJZW50cnkgPSB0b19lbW1hcChyZG1hX2VudHJ5KTsNCj4gKw0KPiArCXN3aXRjaCAo
ZW50cnktPm1tYXBfZmxhZykgew0KPiArCWNhc2UgRVJETUFfTU1BUF9JT19OQzoNCj4gKwkJLyog
bWFwIGRvb3JiZWxsLiAqLw0KPiArCQl2bWEtPnZtX3BhZ2VfcHJvdCA9IHBncHJvdF9ub25jYWNo
ZWQodm1hLT52bV9wYWdlX3Byb3QpOw0KPiArCQllcnIgPSBpb19yZW1hcF9wZm5fcmFuZ2Uodm1h
LCB2bWEtPnZtX3N0YXJ0LCBQRk5fRE9XTihlbnRyeS0NCj4gPmFkZHJlc3MpLA0KPiArCQkJUEFH
RV9TSVpFLCB2bWEtPnZtX3BhZ2VfcHJvdCk7DQo+ICsJCWJyZWFrOw0KPiArCWRlZmF1bHQ6DQo+
ICsJCXByX2VycigibW1hcCBmYWlsZWQsIG1tYXBfZmxhZyA9ICVkXG4iLCBlbnRyeS0+bW1hcF9m
bGFnKTsNCj4gKwkJZXJyID0gLUVJTlZBTDsNCj4gKwkJYnJlYWs7DQo+ICsJfQ0KPiArDQo+ICsJ
cmRtYV91c2VyX21tYXBfZW50cnlfcHV0KHJkbWFfZW50cnkpOw0KPiArb3V0Og0KPiArCXJldHVy
biBlcnI7DQo+ICt9DQo+ICsNCj4gKyNkZWZpbmUgRVJETUFfU0RCX1BBR0UgICAgIDANCj4gKyNk
ZWZpbmUgRVJETUFfU0RCX0VOVFJZICAgIDENCj4gKyNkZWZpbmUgRVJETUFfU0RCX1NIQVJFRCAg
IDINCj4gKw0KPiArc3RhdGljIHZvaWQgYWxsb2NfZGJfcmVzb3VyY2VzKHN0cnVjdCBlcmRtYV9k
ZXYgKmRldiwgc3RydWN0DQo+IGVyZG1hX3Vjb250ZXh0ICpjdHgpDQo+ICt7DQo+ICsJdTMyIGJp
dG1hcF9pZHg7DQo+ICsNCj4gKwlpZiAoZGV2LT5kaXNhYmxlX2R3cWUpDQo+ICsJCWdvdG8gYWxs
b2Nfbm9ybWFsX2RiOw0KPiArDQo+ICsJLyogVHJ5IHRvIGFsbG9jIGluZGVwZW5kZW50IFNEQiBw
YWdlLiAqLw0KPiArCXNwaW5fbG9jaygmZGV2LT5kYl9iaXRtYXBfbG9jayk7DQo+ICsJYml0bWFw
X2lkeCA9IGZpbmRfZmlyc3RfemVyb19iaXQoZGV2LT5zZGJfcGFnZSwgZGV2LT5kd3FlX3BhZ2Vz
KTsNCj4gKwlpZiAoYml0bWFwX2lkeCAhPSBkZXYtPmR3cWVfcGFnZXMpIHsNCj4gKwkJc2V0X2Jp
dChiaXRtYXBfaWR4LCBkZXYtPnNkYl9wYWdlKTsNCj4gKwkJc3Bpbl91bmxvY2soJmRldi0+ZGJf
Yml0bWFwX2xvY2spOw0KPiArDQo+ICsJCWN0eC0+c2RiX3R5cGUgPSBFUkRNQV9TREJfUEFHRTsN
Cj4gKwkJY3R4LT5zZGJfaWR4ID0gYml0bWFwX2lkeDsNCj4gKwkJY3R4LT5zZGJfcGFnZV9pZHgg
PSBiaXRtYXBfaWR4Ow0KPiArCQljdHgtPnNkYiA9IGRldi0+ZGJfc3BhY2VfYWRkciArIChiaXRt
YXBfaWR4IDw8IFBBR0VfU0hJRlQpOw0KPiArCQljdHgtPnNkYl9wYWdlX29mZiA9IDA7DQo+ICsN
Cj4gKwkJcmV0dXJuOw0KPiArCX0NCj4gKw0KPiArCWJpdG1hcF9pZHggPSBmaW5kX2ZpcnN0X3pl
cm9fYml0KGRldi0+c2RiX2VudHJ5LCBkZXYtPmR3cWVfZW50cmllcyk7DQo+ICsJaWYgKGJpdG1h
cF9pZHggIT0gZGV2LT5kd3FlX2VudHJpZXMpIHsNCj4gKwkJc2V0X2JpdChiaXRtYXBfaWR4LCBk
ZXYtPnNkYl9lbnRyeSk7DQo+ICsJCXNwaW5fdW5sb2NrKCZkZXYtPmRiX2JpdG1hcF9sb2NrKTsN
Cj4gKw0KPiArCQljdHgtPnNkYl90eXBlID0gRVJETUFfU0RCX0VOVFJZOw0KPiArCQljdHgtPnNk
Yl9pZHggPSBiaXRtYXBfaWR4Ow0KPiArCQljdHgtPnNkYl9wYWdlX2lkeCA9IEVSRE1BX0RXUUVf
VFlQRTBfQ05UICsNCj4gKwkJCWJpdG1hcF9pZHggLyBFUkRNQV9EV1FFX1RZUEUxX0NOVF9QRVJf
UEFHRTsNCj4gKwkJY3R4LT5zZGJfcGFnZV9vZmYgPSBiaXRtYXBfaWR4ICUNCj4gRVJETUFfRFdR
RV9UWVBFMV9DTlRfUEVSX1BBR0U7DQo+ICsNCj4gKwkJY3R4LT5zZGIgPSBkZXYtPmRiX3NwYWNl
X2FkZHIgKyAoY3R4LT5zZGJfcGFnZV9pZHggPDwNCj4gUEFHRV9TSElGVCk7DQo+ICsNCj4gKwkJ
cmV0dXJuOw0KPiArCX0NCj4gKw0KPiArCXNwaW5fdW5sb2NrKCZkZXYtPmRiX2JpdG1hcF9sb2Nr
KTsNCj4gKw0KPiArYWxsb2Nfbm9ybWFsX2RiOg0KPiArCWN0eC0+c2RiX3R5cGUgPSBFUkRNQV9T
REJfU0hBUkVEOw0KPiArCWN0eC0+c2RiX2lkeCA9IDA7DQo+ICsJY3R4LT5zZGJfcGFnZV9pZHgg
PSBFUkRNQV9TREJfU0hBUkVEX1BBR0VfSU5ERVg7DQo+ICsJY3R4LT5zZGJfcGFnZV9vZmYgPSAw
Ow0KPiArDQo+ICsJY3R4LT5zZGIgPSBkZXYtPmRiX3NwYWNlX2FkZHIgKyAoY3R4LT5zZGJfcGFn
ZV9pZHggPDwgUEFHRV9TSElGVCk7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyB2b2lkIGVyZG1hX3Vj
dHhfdXNlcl9tbWFwX2VudHJpZXNfcmVtb3ZlKHN0cnVjdCBlcmRtYV91Y29udGV4dA0KPiAqdWN0
eCkNCj4gK3sNCj4gKwlyZG1hX3VzZXJfbW1hcF9lbnRyeV9yZW1vdmUodWN0eC0+c3FfZGJfbW1h
cF9lbnRyeSk7DQo+ICsJcmRtYV91c2VyX21tYXBfZW50cnlfcmVtb3ZlKHVjdHgtPnJxX2RiX21t
YXBfZW50cnkpOw0KPiArCXJkbWFfdXNlcl9tbWFwX2VudHJ5X3JlbW92ZSh1Y3R4LT5jcV9kYl9t
bWFwX2VudHJ5KTsNCj4gK30NCj4gKw0KPiAraW50IGVyZG1hX2FsbG9jX3Vjb250ZXh0KHN0cnVj
dCBpYl91Y29udGV4dCAqaWJjdHgsIHN0cnVjdCBpYl91ZGF0YQ0KPiAqdWRhdGEpDQo+ICt7DQo+
ICsJc3RydWN0IGVyZG1hX3Vjb250ZXh0ICpjdHggPSB0b19lY3R4KGliY3R4KTsNCj4gKwlzdHJ1
Y3QgZXJkbWFfZGV2ICpkZXYgPSB0b19lZGV2KGliY3R4LT5kZXZpY2UpOw0KPiArCWludCByZXQ7
DQo+ICsJc3RydWN0IGVyZG1hX3VyZXNwX2FsbG9jX2N0eCB1cmVzcCA9IHt9Ow0KPiArDQo+ICsJ
aWYgKGF0b21pY19pbmNfcmV0dXJuKCZkZXYtPm51bV9jdHgpID4gRVJETUFfTUFYX0NPTlRFWFQp
IHsNCj4gKwkJcmV0ID0gLUVOT01FTTsNCj4gKwkJZ290byBlcnJfb3V0Ow0KPiArCX0NCj4gKw0K
PiArCUlOSVRfTElTVF9IRUFEKCZjdHgtPmRicmVjb3Jkc19wYWdlX2xpc3QpOw0KPiArCW11dGV4
X2luaXQoJmN0eC0+ZGJyZWNvcmRzX3BhZ2VfbXV0ZXgpOw0KPiArCWN0eC0+ZGV2ID0gZGV2Ow0K
PiArDQo+ICsJYWxsb2NfZGJfcmVzb3VyY2VzKGRldiwgY3R4KTsNCj4gKw0KPiArCWN0eC0+cmRi
ID0gZGV2LT5kYl9zcGFjZV9hZGRyICsgRVJETUFfQkFSX1JRREJfU1BBQ0VfT0ZGU0VUOw0KPiAr
CWN0eC0+Y2RiID0gZGV2LT5kYl9zcGFjZV9hZGRyICsgRVJETUFfQkFSX0NRREJfU1BBQ0VfT0ZG
U0VUOw0KPiArDQo+ICsJaWYgKHVkYXRhLT5vdXRsZW4gPCBzaXplb2YodXJlc3ApKSB7DQo+ICsJ
CXJldCA9IC1FSU5WQUw7DQo+ICsJCWdvdG8gZXJyX291dDsNCj4gKwl9DQo+ICsNCj4gKwljdHgt
PnNxX2RiX21tYXBfZW50cnkgPSBlcmRtYV91c2VyX21tYXBfZW50cnlfaW5zZXJ0KGN0eCwgKHZv
aWQNCj4gKiljdHgtPnNkYiwgUEFHRV9TSVpFLA0KPiArCQkJCQkJCSAgICAgRVJETUFfTU1BUF9J
T19OQywNCj4gJnVyZXNwLnNkYik7DQo+ICsJaWYgKCFjdHgtPnNxX2RiX21tYXBfZW50cnkpIHsN
Cj4gKwkJcmV0ID0gLUVOT01FTTsNCj4gKwkJZ290byBlcnJfb3V0Ow0KPiArCX0NCj4gKw0KPiAr
CWN0eC0+cnFfZGJfbW1hcF9lbnRyeSA9IGVyZG1hX3VzZXJfbW1hcF9lbnRyeV9pbnNlcnQoY3R4
LCAodm9pZA0KPiAqKWN0eC0+cmRiLCBQQUdFX1NJWkUsDQo+ICsJCQkJCQkJICAgICBFUkRNQV9N
TUFQX0lPX05DLA0KPiAmdXJlc3AucmRiKTsNCj4gKwlpZiAoIWN0eC0+c3FfZGJfbW1hcF9lbnRy
eSkgew0KPiArCQlyZXQgPSAtRUlOVkFMOw0KPiArCQlnb3RvIGVycl9vdXQ7DQo+ICsJfQ0KPiAr
DQo+ICsJY3R4LT5jcV9kYl9tbWFwX2VudHJ5ID0gZXJkbWFfdXNlcl9tbWFwX2VudHJ5X2luc2Vy
dChjdHgsICh2b2lkDQo+ICopY3R4LT5jZGIsIFBBR0VfU0laRSwNCj4gKwkJCQkJCQkgICAgIEVS
RE1BX01NQVBfSU9fTkMsDQo+ICZ1cmVzcC5jZGIpOw0KPiArCWlmICghY3R4LT5jcV9kYl9tbWFw
X2VudHJ5KSB7DQo+ICsJCXJldCA9IC1FSU5WQUw7DQo+ICsJCWdvdG8gZXJyX291dDsNCj4gKwl9
DQo+ICsNCj4gKwl1cmVzcC5kZXZfaWQgPSBkZXYtPmF0dHJzLnZlbmRvcl9wYXJ0X2lkOw0KPiAr
CXVyZXNwLnNkYl90eXBlID0gY3R4LT5zZGJfdHlwZTsNCj4gKwl1cmVzcC5zZGJfb2Zmc2V0ID0g
Y3R4LT5zZGJfcGFnZV9vZmY7DQo+ICsNCj4gKwlyZXQgPSBpYl9jb3B5X3RvX3VkYXRhKHVkYXRh
LCAmdXJlc3AsIHNpemVvZih1cmVzcCkpOw0KPiArCWlmIChyZXQpDQo+ICsJCWdvdG8gZXJyX291
dDsNCj4gKw0KPiArCXJldHVybiAwOw0KPiArDQo+ICtlcnJfb3V0Og0KPiArCWVyZG1hX3VjdHhf
dXNlcl9tbWFwX2VudHJpZXNfcmVtb3ZlKGN0eCk7DQo+ICsJYXRvbWljX2RlYygmZGV2LT5udW1f
Y3R4KTsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+ICt2b2lkIGVyZG1hX2RlYWxsb2Nf
dWNvbnRleHQoc3RydWN0IGliX3Vjb250ZXh0ICppYmN0eCkNCj4gK3sNCj4gKwlzdHJ1Y3QgZXJk
bWFfdWNvbnRleHQgKmN0eCA9IHRvX2VjdHgoaWJjdHgpOw0KPiArCXN0cnVjdCBlcmRtYV9kZXYg
KmRldiA9IGN0eC0+ZGV2Ow0KPiArDQo+ICsJc3Bpbl9sb2NrKCZkZXYtPmRiX2JpdG1hcF9sb2Nr
KTsNCj4gKwlpZiAoY3R4LT5zZGJfdHlwZSA9PSBFUkRNQV9TREJfUEFHRSkNCj4gKwkJY2xlYXJf
Yml0KGN0eC0+c2RiX2lkeCwgZGV2LT5zZGJfcGFnZSk7DQo+ICsJZWxzZSBpZiAoY3R4LT5zZGJf
dHlwZSA9PSBFUkRNQV9TREJfRU5UUlkpDQo+ICsJCWNsZWFyX2JpdChjdHgtPnNkYl9pZHgsIGRl
di0+c2RiX2VudHJ5KTsNCj4gKw0KPiArCWVyZG1hX3VjdHhfdXNlcl9tbWFwX2VudHJpZXNfcmVt
b3ZlKGN0eCk7DQo+ICsNCj4gKwlzcGluX3VubG9jaygmZGV2LT5kYl9iaXRtYXBfbG9jayk7DQo+
ICsNCj4gKwlhdG9taWNfZGVjKCZjdHgtPmRldi0+bnVtX2N0eCk7DQo+ICt9DQo+ICsNCj4gK3N0
YXRpYyBpbnQgaWJfcXBfc3RhdGVfdG9fZXJkbWFfcXBfc3RhdGVbSUJfUVBTX0VSUisxXSA9IHsN
Cj4gKwlbSUJfUVBTX1JFU0VUXSA9IEVSRE1BX1FQX1NUQVRFX0lETEUsDQo+ICsJW0lCX1FQU19J
TklUXSA9IEVSRE1BX1FQX1NUQVRFX0lETEUsDQo+ICsJW0lCX1FQU19SVFJdID0gRVJETUFfUVBf
U1RBVEVfUlRSLA0KPiArCVtJQl9RUFNfUlRTXSA9IEVSRE1BX1FQX1NUQVRFX1JUUywNCj4gKwlb
SUJfUVBTX1NRRF0gPSBFUkRNQV9RUF9TVEFURV9DTE9TSU5HLA0KPiArCVtJQl9RUFNfU1FFXSA9
IEVSRE1BX1FQX1NUQVRFX1RFUk1JTkFURSwNCj4gKwlbSUJfUVBTX0VSUl0gPSBFUkRNQV9RUF9T
VEFURV9FUlJPUg0KPiArfTsNCj4gKw0KPiAraW50IGVyZG1hX21vZGlmeV9xcChzdHJ1Y3QgaWJf
cXAgKmlicXAsIHN0cnVjdCBpYl9xcF9hdHRyICphdHRyLA0KPiArCQkgICAgaW50IGF0dHJfbWFz
aywgc3RydWN0IGliX3VkYXRhICp1ZGF0YSkNCj4gK3sNCj4gKwlzdHJ1Y3QgZXJkbWFfcXBfYXR0
cnMgbmV3X2F0dHJzOw0KPiArCWVudW0gZXJkbWFfcXBfYXR0cl9tYXNrIGVyZG1hX2F0dHJfbWFz
ayA9IDA7DQo+ICsJc3RydWN0IGVyZG1hX3FwICpxcCA9IHRvX2VxcChpYnFwKTsNCj4gKwlpbnQg
cmV0ID0gMDsNCj4gKw0KPiArCWlmIChhdHRyX21hc2sgJiB+SUJfUVBfQVRUUl9TVEFOREFSRF9C
SVRTKQ0KPiArCQlyZXR1cm4gLUVPUE5PVFNVUFA7DQo+ICsNCj4gKwltZW1zZXQoJm5ld19hdHRy
cywgMCwgc2l6ZW9mKG5ld19hdHRycykpOw0KPiArDQo+ICsJaWYgKGF0dHJfbWFzayAmIElCX1FQ
X1NUQVRFKSB7DQo+ICsJCW5ld19hdHRycy5zdGF0ZSA9IGliX3FwX3N0YXRlX3RvX2VyZG1hX3Fw
X3N0YXRlW2F0dHItDQo+ID5xcF9zdGF0ZV07DQo+ICsNCj4gKwkJZXJkbWFfYXR0cl9tYXNrIHw9
IEVSRE1BX1FQX0FUVFJfU1RBVEU7DQo+ICsJfQ0KPiArDQo+ICsJZG93bl93cml0ZSgmcXAtPnN0
YXRlX2xvY2spOw0KPiArDQo+ICsJcmV0ID0gZXJkbWFfbW9kaWZ5X3FwX2ludGVybmFsKHFwLCAm
bmV3X2F0dHJzLCBlcmRtYV9hdHRyX21hc2spOw0KPiArDQo+ICsJdXBfd3JpdGUoJnFwLT5zdGF0
ZV9sb2NrKTsNCj4gKw0KPiArCXJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4gK2ludCBlcmRtYV9x
dWVyeV9xcChzdHJ1Y3QgaWJfcXAgKmlicXAsIHN0cnVjdCBpYl9xcF9hdHRyICpxcF9hdHRyLA0K
PiArCQkgICBpbnQgcXBfYXR0cl9tYXNrLCBzdHJ1Y3QgaWJfcXBfaW5pdF9hdHRyICpxcF9pbml0
X2F0dHIpDQo+ICt7DQo+ICsJc3RydWN0IGVyZG1hX3FwICpxcDsNCj4gKwlzdHJ1Y3QgZXJkbWFf
ZGV2ICpkZXY7DQo+ICsNCj4gKwlpZiAoaWJxcCAmJiBxcF9hdHRyICYmIHFwX2luaXRfYXR0cikg
ew0KPiArCQlxcCA9IHRvX2VxcChpYnFwKTsNCj4gKwkJZGV2ID0gdG9fZWRldihpYnFwLT5kZXZp
Y2UpOw0KPiArCX0gZWxzZQ0KPiArCQlyZXR1cm4gLUVJTlZBTDsNCj4gKw0KPiArCXFwX2F0dHIt
PmNhcC5tYXhfaW5saW5lX2RhdGEgPSBFUkRNQV9NQVhfSU5MSU5FOw0KPiArCXFwX2luaXRfYXR0
ci0+Y2FwLm1heF9pbmxpbmVfZGF0YSA9IEVSRE1BX01BWF9JTkxJTkU7DQo+ICsNCj4gKwlxcF9h
dHRyLT5jYXAubWF4X3NlbmRfd3IgPSBxcC0+YXR0cnMuc3Ffc2l6ZTsNCj4gKwlxcF9hdHRyLT5j
YXAubWF4X3JlY3Zfd3IgPSBxcC0+YXR0cnMucnFfc2l6ZTsNCj4gKwlxcF9hdHRyLT5jYXAubWF4
X3NlbmRfc2dlID0gcXAtPmF0dHJzLm1heF9zZW5kX3NnZTsNCj4gKwlxcF9hdHRyLT5jYXAubWF4
X3JlY3Zfc2dlID0gcXAtPmF0dHJzLm1heF9yZWN2X3NnZTsNCj4gKw0KPiArCXFwX2F0dHItPnBh
dGhfbXR1ID0gaWJfbXR1X2ludF90b19lbnVtKGRldi0+bmV0ZGV2LT5tdHUpOw0KPiArCXFwX2F0
dHItPm1heF9yZF9hdG9taWMgPSBxcC0+YXR0cnMuaXJxX3NpemU7DQo+ICsJcXBfYXR0ci0+bWF4
X2Rlc3RfcmRfYXRvbWljID0gcXAtPmF0dHJzLm9ycV9zaXplOw0KPiArDQo+ICsJcXBfYXR0ci0+
cXBfYWNjZXNzX2ZsYWdzID0NCj4gKwkJSUJfQUNDRVNTX0xPQ0FMX1dSSVRFIHwgSUJfQUNDRVNT
X1JFTU9URV9XUklURSB8DQo+IElCX0FDQ0VTU19SRU1PVEVfUkVBRDsNCj4gKw0KPiArCXFwX2lu
aXRfYXR0ci0+Y2FwID0gcXBfYXR0ci0+Y2FwOw0KPiArDQo+ICsJcmV0dXJuIDA7DQo+ICt9DQo+
ICsNCj4gK2ludCBlcmRtYV9jcmVhdGVfY3Eoc3RydWN0IGliX2NxICppYmNxLCBjb25zdCBzdHJ1
Y3QgaWJfY3FfaW5pdF9hdHRyDQo+ICphdHRyLCBzdHJ1Y3QgaWJfdWRhdGEgKnVkYXRhKQ0KPiAr
ew0KPiArCXN0cnVjdCBlcmRtYV9jcSAqY3EgPSB0b19lY3EoaWJjcSk7DQo+ICsJc3RydWN0IGVy
ZG1hX2RldiAqZGV2ID0gdG9fZWRldihpYmNxLT5kZXZpY2UpOw0KPiArCXVuc2lnbmVkIGludCBk
ZXB0aCA9IGF0dHItPmNxZTsNCj4gKwlpbnQgcmV0Ow0KPiArCXN0cnVjdCBlcmRtYV91Y29udGV4
dCAqY3R4ID0NCj4gKwkJcmRtYV91ZGF0YV90b19kcnZfY29udGV4dCh1ZGF0YSwgc3RydWN0IGVy
ZG1hX3Vjb250ZXh0LA0KPiBpYnVjb250ZXh0KTsNCj4gKw0KPiArCWlmIChkZXB0aCA+IGRldi0+
YXR0cnMubWF4X2NxZSkgew0KPiArCQlkZXZfd2FybihkZXYtPmRtYWRldiwgIldBUk46IGV4Y2Vl
ZCBjcWUoJWQpID4NCj4gY2FwYmlsaXR5KCVkKVxuIiwgZGVwdGgsDQo+ICsJCQkgZGV2LT5hdHRy
cy5tYXhfY3FlKTsNCg0KVGhhdCBpcyBub3Qgd29ydGggYSB3YXJuaW5nLiBUaGUgYXBwbGljYXRp
b24ganVzdCBleGNlZWRlZCBzb21lDQpSZXNvdXJjZSBsaW1pdC4gUmVtb3ZlIGl0Lg0KDQo+ICsJ
CXJldHVybiAtRUlOVkFMOw0KPiArCX0NCj4gKw0KPiArCWRlcHRoID0gcm91bmR1cF9wb3dfb2Zf
dHdvKGRlcHRoKTsNCj4gKwljcS0+aWJjcS5jcWUgPSBkZXB0aDsNCj4gKwljcS0+ZGVwdGggPSBk
ZXB0aDsNCj4gKwljcS0+YXNzb2NfZXFuID0gYXR0ci0+Y29tcF92ZWN0b3IgKyAxOw0KPiArDQo+
ICsJcmV0ID0geGFfYWxsb2NfY3ljbGljKCZkZXYtPmNxX3hhLCAmY3EtPmNxbiwgY3EsIFhBX0xJ
TUlUKDEsIGRldi0NCj4gPmF0dHJzLm1heF9jcSAtIDEpLA0KPiArCQkJICAgICAgJmRldi0+bmV4
dF9hbGxvY19jcW4sIEdGUF9LRVJORUwpOw0KPiArCWlmIChyZXQgPCAwKQ0KPiArCQlyZXR1cm4g
cmV0Ow0KPiArDQo+ICsJaWYgKHVkYXRhKSB7DQo+ICsJCXN0cnVjdCBlcmRtYV91cmVxX2NyZWF0
ZV9jcSB1cmVxOw0KPiArCQlzdHJ1Y3QgZXJkbWFfdXJlc3BfY3JlYXRlX2NxIHVyZXNwOw0KPiAr
DQo+ICsJCXJldCA9IGliX2NvcHlfZnJvbV91ZGF0YSgmdXJlcSwgdWRhdGEsIG1pbih1ZGF0YS0+
aW5sZW4sDQo+IHNpemVvZih1cmVxKSkpOw0KPiArCQlpZiAocmV0KQ0KPiArCQkJZ290byBlcnJf
b3V0X3hhOw0KPiArCQljcS0+aXNfa2VybmVsX2NxID0gMDsNCj4gKw0KPiArCQlyZXQgPSBnZXRf
bXR0X2VudHJpZXMoZGV2LCAmY3EtPnVzZXJfY3EucWJ1Zl9tdHQsDQo+IHVyZXEucWJ1Zl92YSwg
dXJlcS5xYnVmX2xlbiwgMCwNCj4gKwkJCQkgICAgICB1cmVxLnFidWZfdmEsIFNaXzY0TSAtIFNa
XzRLLCAxKTsNCj4gKwkJaWYgKHJldCkNCj4gKwkJCWdvdG8gZXJyX291dF94YTsNCj4gKw0KPiAr
CQlyZXQgPSBlcmRtYV9tYXBfdXNlcl9kYnJlY29yZHMoY3R4LCB1cmVxLmRiX3JlY29yZF92YSwg
JmNxLQ0KPiA+dXNlcl9jcS51c2VyX2Ricl9wYWdlLA0KPiArCQkJCQkgICAgICAgJmNxLT51c2Vy
X2NxLmRiX2luZm9fZG1hX2FkZHIpOw0KPiArCQlpZiAocmV0KSB7DQo+ICsJCQlwdXRfbXR0X2Vu
dHJpZXMoZGV2LCAmY3EtPnVzZXJfY3EucWJ1Zl9tdHQpOw0KPiArCQkJZ290byBlcnJfb3V0X3hh
Ow0KPiArCQl9DQo+ICsNCj4gKwkJdXJlc3AuY3FfaWQgPSBjcS0+Y3FuOw0KPiArCQl1cmVzcC5u
dW1fY3FlID0gZGVwdGg7DQo+ICsNCj4gKwkJcmV0ID0gaWJfY29weV90b191ZGF0YSh1ZGF0YSwg
JnVyZXNwLCBtaW4oc2l6ZW9mKHVyZXNwKSwNCj4gdWRhdGEtPm91dGxlbikpOw0KPiArCQlpZiAo
cmV0KSB7DQo+ICsJCQllcmRtYV91bm1hcF91c2VyX2RicmVjb3JkcyhjdHgsICZjcS0NCj4gPnVz
ZXJfY3EudXNlcl9kYnJfcGFnZSk7DQo+ICsJCQlwdXRfbXR0X2VudHJpZXMoZGV2LCAmY3EtPnVz
ZXJfY3EucWJ1Zl9tdHQpOw0KPiArCQkJZ290byBlcnJfb3V0X3hhOw0KPiArCQl9DQo+ICsJfSBl
bHNlIHsNCj4gKwkJY3EtPmlzX2tlcm5lbF9jcSA9IDE7DQoNCg0KQ2FuIGJlIHJlbW92ZWQuDQoN
Cj4gKwkJY3EtPmtlcm5fY3Eub3duZXIgPSAxOw0KPiArDQo+ICsJCWNxLT5rZXJuX2NxLnFidWYg
PQ0KPiArCQkJZG1hX2FsbG9jX2NvaGVyZW50KGRldi0+ZG1hZGV2LA0KPiArCQkJCQkgICAoZGVw
dGggPDwgQ1FFX1NISUZUKSArDQo+IEVSRE1BX0VYVFJBX0JVRkZFUl9TSVpFLA0KPiArCQkJCQkg
ICAmY3EtPmtlcm5fY3EucWJ1Zl9kbWFfYWRkciwgR0ZQX0tFUk5FTCk7DQo+ICsJCWlmICghY3Et
Pmtlcm5fY3EucWJ1Zikgew0KPiArCQkJcmV0ID0gLUVOT01FTTsNCj4gKwkJCWdvdG8gZXJyX291
dF94YTsNCj4gKwkJfQ0KPiArDQo+ICsJCWNxLT5rZXJuX2NxLmRiX2luZm8gPSBjcS0+a2Vybl9j
cS5xYnVmICsgKGRlcHRoIDw8IENRRV9TSElGVCk7DQo+ICsJCXNwaW5fbG9ja19pbml0KCZjcS0+
a2Vybl9jcS5sb2NrKTsNCj4gKwkJLyogdXNlIGRlZmF1bHQgY3FkYi4gKi8NCj4gKwkJY3EtPmtl
cm5fY3EuZGIgPSBkZXYtPmRiX3NwYWNlICsgRVJETUFfQkFSX0NRREJfU1BBQ0VfT0ZGU0VUOw0K
PiArCX0NCj4gKw0KPiArCXJldCA9IGNyZWF0ZV9jcV9jbWQoZGV2LCBjcSk7DQo+ICsJaWYgKHJl
dCkNCj4gKwkJZ290byBlcnJfZnJlZV9yZXM7DQo+ICsNCj4gKwlhdG9taWNfaW5jKCZkZXYtPm51
bV9jcSk7DQo+ICsJcmV0dXJuIDA7DQo+ICsNCj4gK2Vycl9mcmVlX3JlczoNCj4gKwlpZiAodWRh
dGEpIHsNCj4gKwkJZXJkbWFfdW5tYXBfdXNlcl9kYnJlY29yZHMoY3R4LCAmY3EtPnVzZXJfY3Eu
dXNlcl9kYnJfcGFnZSk7DQo+ICsJCXB1dF9tdHRfZW50cmllcyhkZXYsICZjcS0+dXNlcl9jcS5x
YnVmX210dCk7DQo+ICsJfSBlbHNlIHsNCj4gKwkJZG1hX2ZyZWVfY29oZXJlbnQoZGV2LT5kbWFk
ZXYsIChkZXB0aCA8PCBDUUVfU0hJRlQpICsNCj4gRVJETUFfRVhUUkFfQlVGRkVSX1NJWkUsDQo+
ICsJCQkJICBjcS0+a2Vybl9jcS5xYnVmLCBjcS0+a2Vybl9jcS5xYnVmX2RtYV9hZGRyKTsNCj4g
Kwl9DQo+ICsNCj4gK2Vycl9vdXRfeGE6DQo+ICsJeGFfZXJhc2UoJmRldi0+Y3FfeGEsIGNxLT5j
cW4pOw0KPiArDQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiArc3RydWN0IG5ldF9kZXZp
Y2UgKmVyZG1hX2dldF9uZXRkZXYoc3RydWN0IGliX2RldmljZSAqZGV2aWNlLCB1MzINCj4gcG9y
dF9udW0pDQo+ICt7DQo+ICsJc3RydWN0IGVyZG1hX2RldiAqZGV2ID0gdG9fZWRldihkZXZpY2Up
Ow0KPiArDQo+ICsJaWYgKGRldi0+bmV0ZGV2KQ0KPiArCQlkZXZfaG9sZChkZXYtPm5ldGRldik7
DQo+ICsNCj4gKwlyZXR1cm4gZGV2LT5uZXRkZXY7DQo+ICt9DQo+ICsNCj4gK3ZvaWQgZXJkbWFf
ZGlzYXNzb2NpYXRlX3Vjb250ZXh0KHN0cnVjdCBpYl91Y29udGV4dCAqaWJjb250ZXh0KQ0KPiAr
ew0KPiArfQ0KPiArDQo+ICt2b2lkIGVyZG1hX3BvcnRfZXZlbnQoc3RydWN0IGVyZG1hX2RldiAq
ZGV2LCBlbnVtIGliX2V2ZW50X3R5cGUgcmVhc29uKQ0KPiArew0KPiArCXN0cnVjdCBpYl9ldmVu
dCBldmVudDsNCj4gKw0KPiArCWV2ZW50LmRldmljZSA9ICZkZXYtPmliZGV2Ow0KPiArCWV2ZW50
LmVsZW1lbnQucG9ydF9udW0gPSAxOw0KPiArCWV2ZW50LmV2ZW50ID0gcmVhc29uOw0KPiArDQo+
ICsJaWJfZGlzcGF0Y2hfZXZlbnQoJmV2ZW50KTsNCj4gK30NCj4gLS0NCj4gMi4yNy4wDQoNCg==
